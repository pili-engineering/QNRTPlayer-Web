!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).QNRTPlayer={})}(this,(function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},t.apply(this,arguments)};function n(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((i=i.apply(e,t||[])).next())}))}function i(e,t){var n,i,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function r(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(e){var t={exports:{}};return e(t,t.exports),t.exports}var s=o((function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,i,a,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new r(i,a||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,o=new Array(a);r<a;r++)o[r]=i[r].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},s.prototype.emit=function(e,t,i,r,a,o){var s=n?n+e:e;if(!this._events[s])return!1;var c,d,l=this._events[s],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,i),!0;case 4:return l.fn.call(l.context,t,i,r),!0;case 5:return l.fn.call(l.context,t,i,r,a),!0;case 6:return l.fn.call(l.context,t,i,r,a,o),!0}for(d=1,c=new Array(u-1);d<u;d++)c[d-1]=arguments[d];l.fn.apply(l.context,c)}else{var h,p=l.length;for(d=0;d<p;d++)switch(l[d].once&&this.removeListener(e,l[d].fn,void 0,!0),u){case 1:l[d].fn.call(l[d].context);break;case 2:l[d].fn.call(l[d].context,t);break;case 3:l[d].fn.call(l[d].context,t,i);break;case 4:l[d].fn.call(l[d].context,t,i,r);break;default:if(!c)for(h=1,c=new Array(u-1);h<u;h++)c[h-1]=arguments[h];l[d].fn.apply(l[d].context,c)}}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,i,r){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||r&&!s.once||i&&s.context!==i||o(this,a);else{for(var c=0,d=[],l=s.length;c<l;c++)(s[c].fn!==t||r&&!s[c].once||i&&s[c].context!==i)&&d.push(s[c]);d.length?this._events[a]=1===d.length?d[0]:d:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}));const c={className:"qn-rtplayer-media",width:"100%",height:"100%",objectFit:"contain",volumn:.6,controls:!1,playsinline:!0,audioOnly:!1,muted:!1,jitterBuffer:null,uid:""},d={lastAudioPacketReceivedTimestamp:0,lastVideoPacketReceivedTimestamp:0,timestamp:0,ip:"",protocol:"",rtt:0,audioFps:0,audioBitrate:0,audioDecoderName:"",audioTotalSamplesReceived:0,audioAvgJitterBufferDelay:0,audioAvgJitterBufferTargetDelay:0,audioAvgPacketProcessingDelay:0,audioPacketDiscarded:0,audioPacketReceived:0,audioPacketLost:0,audioPacketLostRate:0,audioBytesReceived:0,audioAvgInterframeDelay:0,audioLastPacketReceivedTimestamp:0,audioEstimatedPlayoutTimestamp:0,videoFps:0,videoBitrate:0,videoDecoderName:"",videoFrameWidth:0,videoFrameHeight:0,videoAvgJitterBufferDelay:0,videoAvgJitterBufferTargetDelay:0,videoAvgPacketProcessingDelay:0,videoDroppedFrames:0,videoPacketReceived:0,videoPacketLost:0,videoPacketLostRate:0,videoNackCount:0,videoFirCount:0,videoPliCount:0,videoFrameDecoded:0,videoFrameReceived:0,videoDecodeCostMs:0,videoKeyFramesDecoded:0,videoBytesReceived:0,videoTotalFreezesDuration:0,videoFecPacketReceived:0,videoAvgInterframeDelay:0,videoLastPacketReceivedTimestamp:0,videoEstimatedPlayoutTimestamp:0};e.PlayerState=void 0,function(e){e[e.STATE_IDLE=0]="STATE_IDLE",e[e.STATE_INIT=1]="STATE_INIT",e[e.STATE_READY=2]="STATE_READY",e[e.STATE_PLAYING=3]="STATE_PLAYING",e[e.STATE_STOP=4]="STATE_STOP",e[e.STATE_ERROR=5]="STATE_ERROR"}(e.PlayerState||(e.PlayerState={}));class l{constructor(e,t){this.dbName=e,this.storeConfigs=t,this.db=void 0}getDB(){return n(this,void 0,void 0,(function*(){return null!=this.db?this.db:new Promise((e=>{const t=indexedDB.open(this.dbName);t.addEventListener("upgradeneeded",(()=>{for(const e of this.storeConfigs){const n=t.result.createObjectStore(e.name);for(const t of e.indexes)n.createIndex(t.name,t.keyPath)}})),e(h(t))}))}))}add(e){console.log(e,"fucker")}get(e,t){return n(this,void 0,void 0,(function*(){return h((yield this.getDB()).transaction(e,"readonly").objectStore(e).get(t))}))}getAll(e){return n(this,void 0,void 0,(function*(){return h((yield this.getDB()).transaction(e,"readonly").objectStore(e).getAll())}))}count(e){return n(this,void 0,void 0,(function*(){return h((yield this.getDB()).transaction(e,"readonly").objectStore(e).count())}))}set(e,t,i){return n(this,void 0,void 0,(function*(){const n=(yield this.getDB()).transaction(e,"readwrite");return n.objectStore(e).put(i,t),p(n)}))}remove(e,t){return n(this,void 0,void 0,(function*(){const n=(yield this.getDB()).transaction(e,"readwrite");return n.objectStore(e).delete(t),p(n)}))}removeRange(e,t,i){return n(this,void 0,void 0,(function*(){let r=0;const a=(yield this.getDB()).transaction(e,"readwrite").objectStore(e).openCursor(void 0,"next");return new Promise(((e,o)=>{a.addEventListener("error",(()=>o(new u(a.error)))),a.addEventListener("success",(()=>n(this,void 0,void 0,(function*(){const n=a.result;null==n||r>=i?e():(r>=t&&r<i&&(yield h(n.delete())),++r,n.continue())}))))}))}))}clear(){return n(this,void 0,void 0,(function*(){const e=yield this.getDB();yield Promise.all(this.storeConfigs.map((({name:t})=>{const n=e.transaction(t,"readwrite");return n.objectStore(t).clear(),p(n)})))}))}dispose(){this.db&&this.db.close()}}class u extends Error{constructor(e){super(e+""),this.cause=e,this.name="IndexedDBError"}}function h(e){return new Promise(((t,n)=>{e.addEventListener("success",(()=>t(e.result))),e.addEventListener("error",(()=>n(new u(e.error))))}))}function p(e){return new Promise(((t,n)=>{e.addEventListener("complete",(()=>t())),e.addEventListener("error",(()=>n(new u(e.error)))),e.addEventListener("abort",(()=>n(new u(e.error))))}))}const f="/rtc/v1/play",m="miku_log",v=8e3,g="1.2.1";var y="4.6.1";function w(e,t){return new Promise((function(n){return setTimeout(n,e,t)}))}function b(e){return!!e&&"function"==typeof e.then}function _(e,t){try{var n=e();b(n)?n.then((function(e){return t(!0,e)}),(function(e){return t(!1,e)})):t(!0,n)}catch(e){t(!1,e)}}function S(e,t,r){return void 0===r&&(r=16),n(this,void 0,void 0,(function(){var n,a,o,s;return i(this,(function(i){switch(i.label){case 0:n=Array(e.length),a=Date.now(),o=0,i.label=1;case 1:return o<e.length?(n[o]=t(e[o],o),(s=Date.now())>=a+r?(a=s,[4,new Promise((function(e){var t=new MessageChannel;t.port1.onmessage=function(){return e()},t.port2.postMessage(null)}))]):[3,3]):[3,4];case 2:i.sent(),i.label=3;case 3:return++o,[3,1];case 4:return[2,n]}}))}))}function T(e){return e.then(void 0,(function(){})),e}function k(e){return parseInt(e)}function C(e){return parseFloat(e)}function E(e,t){return"number"==typeof e&&isNaN(e)?t:e}function R(e){return e.reduce((function(e,t){return e+(t?1:0)}),0)}function P(e,t){if(void 0===t&&(t=1),Math.abs(t)>=1)return Math.round(e/t)*t;var n=1/t;return Math.round(e*n)/n}function x(e,t){var n=e[0]>>>16,i=65535&e[0],r=e[1]>>>16,a=65535&e[1],o=t[0]>>>16,s=65535&t[0],c=t[1]>>>16,d=0,l=0,u=0,h=0;u+=(h+=a+(65535&t[1]))>>>16,h&=65535,l+=(u+=r+c)>>>16,u&=65535,d+=(l+=i+s)>>>16,l&=65535,d+=n+o,d&=65535,e[0]=d<<16|l,e[1]=u<<16|h}function A(e,t){var n=e[0]>>>16,i=65535&e[0],r=e[1]>>>16,a=65535&e[1],o=t[0]>>>16,s=65535&t[0],c=t[1]>>>16,d=65535&t[1],l=0,u=0,h=0,p=0;h+=(p+=a*d)>>>16,p&=65535,u+=(h+=r*d)>>>16,h&=65535,u+=(h+=a*c)>>>16,h&=65535,l+=(u+=i*d)>>>16,u&=65535,l+=(u+=r*c)>>>16,u&=65535,l+=(u+=a*s)>>>16,u&=65535,l+=n*d+i*c+r*s+a*o,l&=65535,e[0]=l<<16|u,e[1]=h<<16|p}function I(e,t){var n=e[0];32===(t%=64)?(e[0]=e[1],e[1]=n):t<32?(e[0]=n<<t|e[1]>>>32-t,e[1]=e[1]<<t|n>>>32-t):(t-=32,e[0]=e[1]<<t|n>>>32-t,e[1]=n<<t|e[1]>>>32-t)}function D(e,t){0!==(t%=64)&&(t<32?(e[0]=e[1]>>>32-t,e[1]=e[1]<<t):(e[0]=e[1]<<t-32,e[1]=0))}function L(e,t){e[0]^=t[0],e[1]^=t[1]}var O=[4283543511,3981806797],M=[3301882366,444984403];function B(e){var t=[0,e[0]>>>1];L(e,t),A(e,O),t[1]=e[0]>>>1,L(e,t),A(e,M),t[1]=e[0]>>>1,L(e,t)}var N=[2277735313,289559509],F=[1291169091,658871167],j=[0,5],z=[0,1390208809],G=[0,944331445];function V(e,t){var n=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++){var i=e.charCodeAt(n);if(i>127)return(new TextEncoder).encode(e);t[n]=i}return t}(e);t=t||0;var i,r=[0,n.length],a=r[1]%16,o=r[1]-a,s=[0,t],c=[0,t],d=[0,0],l=[0,0];for(i=0;i<o;i+=16)d[0]=n[i+4]|n[i+5]<<8|n[i+6]<<16|n[i+7]<<24,d[1]=n[i]|n[i+1]<<8|n[i+2]<<16|n[i+3]<<24,l[0]=n[i+12]|n[i+13]<<8|n[i+14]<<16|n[i+15]<<24,l[1]=n[i+8]|n[i+9]<<8|n[i+10]<<16|n[i+11]<<24,A(d,N),I(d,31),A(d,F),L(s,d),I(s,27),x(s,c),A(s,j),x(s,z),A(l,F),I(l,33),A(l,N),L(c,l),I(c,31),x(c,s),A(c,j),x(c,G);d[0]=0,d[1]=0,l[0]=0,l[1]=0;var u=[0,0];switch(a){case 15:u[1]=n[i+14],D(u,48),L(l,u);case 14:u[1]=n[i+13],D(u,40),L(l,u);case 13:u[1]=n[i+12],D(u,32),L(l,u);case 12:u[1]=n[i+11],D(u,24),L(l,u);case 11:u[1]=n[i+10],D(u,16),L(l,u);case 10:u[1]=n[i+9],D(u,8),L(l,u);case 9:u[1]=n[i+8],L(l,u),A(l,F),I(l,33),A(l,N),L(c,l);case 8:u[1]=n[i+7],D(u,56),L(d,u);case 7:u[1]=n[i+6],D(u,48),L(d,u);case 6:u[1]=n[i+5],D(u,40),L(d,u);case 5:u[1]=n[i+4],D(u,32),L(d,u);case 4:u[1]=n[i+3],D(u,24),L(d,u);case 3:u[1]=n[i+2],D(u,16),L(d,u);case 2:u[1]=n[i+1],D(u,8),L(d,u);case 1:u[1]=n[i],L(d,u),A(d,N),I(d,31),A(d,F),L(s,d)}return L(s,r),L(c,r),x(s,c),x(c,s),B(s),B(c),x(s,c),x(c,s),("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)}function U(e,t,r,a){var o=Object.keys(e).filter((function(e){return!function(e,t){for(var n=0,i=e.length;n<i;++n)if(e[n]===t)return!0;return!1}(r,e)})),s=T(S(o,(function(n){return function(e,t){var n=T(new Promise((function(n){var i=Date.now();_(e.bind(null,t),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Date.now()-i;if(!e[0])return n((function(){return{error:e[1],duration:r}}));var a=e[1];if(function(e){return"function"!=typeof e}(a))return n((function(){return{value:a,duration:r}}));n((function(){return new Promise((function(e){var t=Date.now();_(a,(function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=r+Date.now()-t;if(!n[0])return e({error:n[1],duration:a});e({value:n[1],duration:a})}))}))}))}))})));return function(){return n.then((function(e){return e()}))}}(e[n],t)}),a));return function(){return n(this,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:return[4,s];case 1:return[4,S(i.sent(),(function(e){return T(e())}),a)];case 2:return e=i.sent(),[4,Promise.all(e)];case 3:for(t=i.sent(),n={},r=0;r<o.length;++r)n[o[r]]=t[r];return[2,n]}}))}))}}function W(){var e=window,t=navigator;return R(["MSCSSMatrix"in e,"msSetImmediate"in e,"msIndexedDB"in e,"msMaxTouchPoints"in t,"msPointerEnabled"in t])>=4}function Z(){var e=window,t=navigator;return R(["webkitPersistentStorage"in t,"webkitTemporaryStorage"in t,0===(t.vendor||"").indexOf("Google"),"webkitResolveLocalFileSystemURL"in e,"BatteryManager"in e,"webkitMediaStream"in e,"webkitSpeechGrammar"in e])>=5}function H(){var e=window;return R(["ApplePayError"in e,"CSSPrimitiveValue"in e,"Counter"in e,0===navigator.vendor.indexOf("Apple"),"RGBColor"in e,"WebKitMediaKeys"in e])>=4}function X(){var e=window,t=e.HTMLElement,n=e.Document;return R(["safari"in e,!("ongestureend"in e),!("TouchEvent"in e),!("orientation"in e),t&&!("autocapitalize"in t.prototype),n&&"pointerLockElement"in n.prototype])>=4}function J(){var e,t=window;return e=t.print,/^function\s.*?\{\s*\[native code]\s*}$/.test(String(e))&&"[object WebPageNamespace]"===String(t.browser)}function Y(){var e,t,n=window;return R(["buildID"in navigator,"MozAppearance"in(null!==(t=null===(e=document.documentElement)||void 0===e?void 0:e.style)&&void 0!==t?t:{}),"onmozfullscreenchange"in n,"mozInnerScreenX"in n,"CSSMozDocumentRule"in n,"CanvasCaptureMediaStream"in n])>=4}function $(){var e=window,t=navigator,n=e.CSS,i=e.HTMLButtonElement;return R([!("getStorageUpdates"in t),i&&"popover"in i.prototype,"CSSCounterStyleRule"in e,n.supports("font-size-adjust: ex-height 0.5"),n.supports("text-transform: full-width")])>=4}function K(){var e=document;return(e.exitFullscreen||e.msExitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen).call(e)}function q(){var e=Z(),t=Y(),n=window,i=navigator,r="connection";return e?R([!("SharedWorker"in n),i[r]&&"ontypechange"in i[r],!("sinkId"in new Audio)])>=2:!!t&&R(["onorientationchange"in n,"orientation"in n,/android/i.test(i.appVersion)])>=2}function Q(e){var t=new Error(e);return t.name=e,t}function ee(e,t,r){var a,o,s;return void 0===r&&(r=50),n(this,void 0,void 0,(function(){var n,c;return i(this,(function(i){switch(i.label){case 0:n=document,i.label=1;case 1:return n.body?[3,3]:[4,w(r)];case 2:return i.sent(),[3,1];case 3:c=n.createElement("iframe"),i.label=4;case 4:return i.trys.push([4,,10,11]),[4,new Promise((function(e,i){var r=!1,a=function(){r=!0,e()};c.onload=a,c.onerror=function(e){r=!0,i(e)};var o=c.style;o.setProperty("display","block","important"),o.position="absolute",o.top="0",o.left="0",o.visibility="hidden",t&&"srcdoc"in c?c.srcdoc=t:c.src="about:blank",n.body.appendChild(c);var s=function(){var e,t;r||("complete"===(null===(t=null===(e=c.contentWindow)||void 0===e?void 0:e.document)||void 0===t?void 0:t.readyState)?a():setTimeout(s,10))};s()}))];case 5:i.sent(),i.label=6;case 6:return(null===(o=null===(a=c.contentWindow)||void 0===a?void 0:a.document)||void 0===o?void 0:o.body)?[3,8]:[4,w(r)];case 7:return i.sent(),[3,6];case 8:return[4,e(c,c.contentWindow)];case 9:return[2,i.sent()];case 10:return null===(s=c.parentNode)||void 0===s||s.removeChild(c),[7];case 11:return[2]}}))}))}function te(e){for(var t=function(e){for(var t,n,i="Unexpected syntax '".concat(e,"'"),r=/^\s*([a-z-]*)(.*)$/i.exec(e),a=r[1]||void 0,o={},s=/([.:#][\w-]+|\[.+?\])/gi,c=function(e,t){o[e]=o[e]||[],o[e].push(t)};;){var d=s.exec(r[2]);if(!d)break;var l=d[0];switch(l[0]){case".":c("class",l.slice(1));break;case"#":c("id",l.slice(1));break;case"[":var u=/^\[([\w-]+)([~|^$*]?=("(.*?)"|([\w-]+)))?(\s+[is])?\]$/.exec(l);if(!u)throw new Error(i);c(u[1],null!==(n=null!==(t=u[4])&&void 0!==t?t:u[5])&&void 0!==n?n:"");break;default:throw new Error(i)}}return[a,o]}(e),n=t[0],i=t[1],r=document.createElement(null!=n?n:"div"),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a],c=i[s].join(" ");"style"===s?ne(r.style,c):r.setAttribute(s,c)}return r}function ne(e,t){for(var n=0,i=t.split(";");n<i.length;n++){var r=i[n],a=/^\s*([\w-]+)\s*:\s*(.+?)(\s*!([\w-]+))?\s*$/.exec(r);if(a){var o=a[1],s=a[2],c=a[4];e.setProperty(o,s,c||"")}}}var ie=["monospace","sans-serif","serif"],re=["sans-serif-thin","ARNO PRO","Agency FB","Arabic Typesetting","Arial Unicode MS","AvantGarde Bk BT","BankGothic Md BT","Batang","Bitstream Vera Sans Mono","Calibri","Century","Century Gothic","Clarendon","EUROSTILE","Franklin Gothic","Futura Bk BT","Futura Md BT","GOTHAM","Gill Sans","HELV","Haettenschweiler","Helvetica Neue","Humanst521 BT","Leelawadee","Letter Gothic","Levenim MT","Lucida Bright","Lucida Sans","Menlo","MS Mincho","MS Outlook","MS Reference Specialty","MS UI Gothic","MT Extra","MYRIAD PRO","Marlett","Meiryo UI","Microsoft Uighur","Minion Pro","Monotype Corsiva","PMingLiU","Pristina","SCRIPTINA","Segoe UI Light","Serifa","SimHei","Small Fonts","Staccato222 BT","TRAJAN PRO","Univers CE 55 Medium","Vrinda","ZWAdobeF"];function ae(e){return e.toDataURL()}var oe,se;function ce(){var e=this;return function(){if(void 0===se){var e=function(){var t=de();le(t)?se=setTimeout(e,2500):(oe=t,se=void 0)};e()}}(),function(){return n(e,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return le(e=de())?oe?[2,r([],oe,!0)]:(n=document).fullscreenElement||n.msFullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement?[4,K()]:[3,2]:[3,2];case 1:t.sent(),e=de(),t.label=2;case 2:return le(e)||(oe=e),[2,e]}var n}))}))}}function de(){var e=screen;return[E(C(e.availTop),null),E(C(e.width)-C(e.availWidth)-E(C(e.availLeft),0),null),E(C(e.height)-C(e.availHeight)-E(C(e.availTop),0),null),E(C(e.availLeft),null)]}function le(e){for(var t=0;t<4;++t)if(e[t])return!1;return!0}function ue(e){var t;return n(this,void 0,void 0,(function(){var n,r,a,o,s,c,d;return i(this,(function(i){switch(i.label){case 0:for(n=document,r=n.createElement("div"),a=new Array(e.length),o={},he(r),d=0;d<e.length;++d)"DIALOG"===(s=te(e[d])).tagName&&s.show(),he(c=n.createElement("div")),c.appendChild(s),r.appendChild(c),a[d]=s;i.label=1;case 1:return n.body?[3,3]:[4,w(50)];case 2:return i.sent(),[3,1];case 3:n.body.appendChild(r);try{for(d=0;d<e.length;++d)a[d].offsetParent||(o[e[d]]=!0)}finally{null===(t=r.parentNode)||void 0===t||t.removeChild(r)}return[2,o]}}))}))}function he(e){e.style.setProperty("visibility","hidden","important"),e.style.setProperty("display","block","important")}function pe(e){return matchMedia("(inverted-colors: ".concat(e,")")).matches}function fe(e){return matchMedia("(forced-colors: ".concat(e,")")).matches}function me(e){return matchMedia("(prefers-contrast: ".concat(e,")")).matches}function ve(e){return matchMedia("(prefers-reduced-motion: ".concat(e,")")).matches}function ge(e){return matchMedia("(prefers-reduced-transparency: ".concat(e,")")).matches}function ye(e){return matchMedia("(dynamic-range: ".concat(e,")")).matches}var we=Math,be=function(){return 0};var _e={default:[],apple:[{font:"-apple-system-body"}],serif:[{fontFamily:"serif"}],sans:[{fontFamily:"sans-serif"}],mono:[{fontFamily:"monospace"}],min:[{fontSize:"1px"}],system:[{fontFamily:"system-ui"}]};var Se=function(){for(var e=window;;){var t=e.parent;if(!t||t===e)return!1;try{if(t.location.origin!==e.location.origin)return!0}catch(e){if(e instanceof Error&&"SecurityError"===e.name)return!0;throw e}e=t}};var Te=new Set([10752,2849,2884,2885,2886,2928,2929,2930,2931,2932,2960,2961,2962,2963,2964,2965,2966,2967,2968,2978,3024,3042,3088,3089,3106,3107,32773,32777,32777,32823,32824,32936,32937,32938,32939,32968,32969,32970,32971,3317,33170,3333,3379,3386,33901,33902,34016,34024,34076,3408,3410,3411,3412,3413,3414,3415,34467,34816,34817,34818,34819,34877,34921,34930,35660,35661,35724,35738,35739,36003,36004,36005,36347,36348,36349,37440,37441,37443,7936,7937,7938]),ke=new Set([34047,35723,36063,34852,34853,34854,34229,36392,36795,38449]),Ce=["FRAGMENT_SHADER","VERTEX_SHADER"],Ee=["LOW_FLOAT","MEDIUM_FLOAT","HIGH_FLOAT","LOW_INT","MEDIUM_INT","HIGH_INT"],Re="WEBGL_debug_renderer_info";function Pe(e){if(e.webgl)return e.webgl.context;var t,n=document.createElement("canvas");n.addEventListener("webglCreateContextError",(function(){return t=void 0}));for(var i=0,r=["webgl","experimental-webgl"];i<r.length;i++){var a=r[i];try{t=n.getContext(a)}catch(e){}if(t)break}return e.webgl={context:t},t}function xe(e,t,n){var i=e.getShaderPrecisionFormat(e[t],e[n]);return i?[i.rangeMin,i.rangeMax,i.precision]:[]}function Ae(e){return Object.keys(e.__proto__).filter(Ie)}function Ie(e){return"string"==typeof e&&!e.match(/[^A-Z0-9_x]/)}function De(){return Y()}function Le(e){return"function"==typeof e.getParameter}var Oe={fonts:function(){var e=this;return ee((function(t,r){var a=r.document;return n(e,void 0,void 0,(function(){var e,t,n,r,o,s,c,d,l,u,h;return i(this,(function(i){for((e=a.body).style.fontSize="48px",(t=a.createElement("div")).style.setProperty("visibility","hidden","important"),n={},r={},o=function(e){var n=a.createElement("span"),i=n.style;return i.position="absolute",i.top="0",i.left="0",i.fontFamily=e,n.textContent="mmMwWLliI0O&1",t.appendChild(n),n},s=function(e,t){return o("'".concat(e,"',").concat(t))},c=function(){for(var e={},t=function(t){e[t]=ie.map((function(e){return s(t,e)}))},n=0,i=re;n<i.length;n++){t(i[n])}return e},d=function(e){return ie.some((function(t,i){return e[i].offsetWidth!==n[t]||e[i].offsetHeight!==r[t]}))},l=function(){return ie.map(o)}(),u=c(),e.appendChild(t),h=0;h<ie.length;h++)n[ie[h]]=l[h].offsetWidth,r[ie[h]]=l[h].offsetHeight;return[2,re.filter((function(e){return d(u[e])}))]}))}))}))},domBlockers:function(e){var t=(void 0===e?{}:e).debug;return n(this,void 0,void 0,(function(){var e,n,r,a,o;return i(this,(function(i){switch(i.label){case 0:return H()||q()?(s=atob,e={abpIndo:["#Iklan-Melayang","#Kolom-Iklan-728","#SidebarIklan-wrapper",'[title="ALIENBOLA" i]',s("I0JveC1CYW5uZXItYWRz")],abpvn:[".quangcao","#mobileCatfish",s("LmNsb3NlLWFkcw=="),'[id^="bn_bottom_fixed_"]',"#pmadv"],adBlockFinland:[".mainostila",s("LnNwb25zb3JpdA=="),".ylamainos",s("YVtocmVmKj0iL2NsaWNrdGhyZ2guYXNwPyJd"),s("YVtocmVmXj0iaHR0cHM6Ly9hcHAucmVhZHBlYWsuY29tL2FkcyJd")],adBlockPersian:["#navbar_notice_50",".kadr",'TABLE[width="140px"]',"#divAgahi",s("YVtocmVmXj0iaHR0cDovL2cxLnYuZndtcm0ubmV0L2FkLyJd")],adBlockWarningRemoval:["#adblock-honeypot",".adblocker-root",".wp_adblock_detect",s("LmhlYWRlci1ibG9ja2VkLWFk"),s("I2FkX2Jsb2NrZXI=")],adGuardAnnoyances:[".hs-sosyal","#cookieconsentdiv",'div[class^="app_gdpr"]',".as-oil",'[data-cypress="soft-push-notification-modal"]'],adGuardBase:[".BetterJsPopOverlay",s("I2FkXzMwMFgyNTA="),s("I2Jhbm5lcmZsb2F0MjI="),s("I2NhbXBhaWduLWJhbm5lcg=="),s("I0FkLUNvbnRlbnQ=")],adGuardChinese:[s("LlppX2FkX2FfSA=="),s("YVtocmVmKj0iLmh0aGJldDM0LmNvbSJd"),"#widget-quan",s("YVtocmVmKj0iLzg0OTkyMDIwLnh5eiJd"),s("YVtocmVmKj0iLjE5NTZobC5jb20vIl0=")],adGuardFrench:["#pavePub",s("LmFkLWRlc2t0b3AtcmVjdGFuZ2xl"),".mobile_adhesion",".widgetadv",s("LmFkc19iYW4=")],adGuardGerman:['aside[data-portal-id="leaderboard"]'],adGuardJapanese:["#kauli_yad_1",s("YVtocmVmXj0iaHR0cDovL2FkMi50cmFmZmljZ2F0ZS5uZXQvIl0="),s("Ll9wb3BJbl9pbmZpbml0ZV9hZA=="),s("LmFkZ29vZ2xl"),s("Ll9faXNib29zdFJldHVybkFk")],adGuardMobile:[s("YW1wLWF1dG8tYWRz"),s("LmFtcF9hZA=="),'amp-embed[type="24smi"]',"#mgid_iframe1",s("I2FkX2ludmlld19hcmVh")],adGuardRussian:[s("YVtocmVmXj0iaHR0cHM6Ly9hZC5sZXRtZWFkcy5jb20vIl0="),s("LnJlY2xhbWE="),'div[id^="smi2adblock"]',s("ZGl2W2lkXj0iQWRGb3hfYmFubmVyXyJd"),"#psyduckpockeball"],adGuardSocial:[s("YVtocmVmXj0iLy93d3cuc3R1bWJsZXVwb24uY29tL3N1Ym1pdD91cmw9Il0="),s("YVtocmVmXj0iLy90ZWxlZ3JhbS5tZS9zaGFyZS91cmw/Il0="),".etsy-tweet","#inlineShare",".popup-social"],adGuardSpanishPortuguese:["#barraPublicidade","#Publicidade","#publiEspecial","#queTooltip",".cnt-publi"],adGuardTrackingProtection:["#qoo-counter",s("YVtocmVmXj0iaHR0cDovL2NsaWNrLmhvdGxvZy5ydS8iXQ=="),s("YVtocmVmXj0iaHR0cDovL2hpdGNvdW50ZXIucnUvdG9wL3N0YXQucGhwIl0="),s("YVtocmVmXj0iaHR0cDovL3RvcC5tYWlsLnJ1L2p1bXAiXQ=="),"#top100counter"],adGuardTurkish:["#backkapat",s("I3Jla2xhbWk="),s("YVtocmVmXj0iaHR0cDovL2Fkc2Vydi5vbnRlay5jb20udHIvIl0="),s("YVtocmVmXj0iaHR0cDovL2l6bGVuemkuY29tL2NhbXBhaWduLyJd"),s("YVtocmVmXj0iaHR0cDovL3d3dy5pbnN0YWxsYWRzLm5ldC8iXQ==")],bulgarian:[s("dGQjZnJlZW5ldF90YWJsZV9hZHM="),"#ea_intext_div",".lapni-pop-over","#xenium_hot_offers"],easyList:[".yb-floorad",s("LndpZGdldF9wb19hZHNfd2lkZ2V0"),s("LnRyYWZmaWNqdW5reS1hZA=="),".textad_headline",s("LnNwb25zb3JlZC10ZXh0LWxpbmtz")],easyListChina:[s("LmFwcGd1aWRlLXdyYXBbb25jbGljayo9ImJjZWJvcy5jb20iXQ=="),s("LmZyb250cGFnZUFkdk0="),"#taotaole","#aafoot.top_box",".cfa_popup"],easyListCookie:[".ezmob-footer",".cc-CookieWarning","[data-cookie-number]",s("LmF3LWNvb2tpZS1iYW5uZXI="),".sygnal24-gdpr-modal-wrap"],easyListCzechSlovak:["#onlajny-stickers",s("I3Jla2xhbW5pLWJveA=="),s("LnJla2xhbWEtbWVnYWJvYXJk"),".sklik",s("W2lkXj0ic2tsaWtSZWtsYW1hIl0=")],easyListDutch:[s("I2FkdmVydGVudGll"),s("I3ZpcEFkbWFya3RCYW5uZXJCbG9jaw=="),".adstekst",s("YVtocmVmXj0iaHR0cHM6Ly94bHR1YmUubmwvY2xpY2svIl0="),"#semilo-lrectangle"],easyListGermany:["#SSpotIMPopSlider",s("LnNwb25zb3JsaW5rZ3J1ZW4="),s("I3dlcmJ1bmdza3k="),s("I3Jla2xhbWUtcmVjaHRzLW1pdHRl"),s("YVtocmVmXj0iaHR0cHM6Ly9iZDc0Mi5jb20vIl0=")],easyListItaly:[s("LmJveF9hZHZfYW5udW5jaQ=="),".sb-box-pubbliredazionale",s("YVtocmVmXj0iaHR0cDovL2FmZmlsaWF6aW9uaWFkcy5zbmFpLml0LyJd"),s("YVtocmVmXj0iaHR0cHM6Ly9hZHNlcnZlci5odG1sLml0LyJd"),s("YVtocmVmXj0iaHR0cHM6Ly9hZmZpbGlhemlvbmlhZHMuc25haS5pdC8iXQ==")],easyListLithuania:[s("LnJla2xhbW9zX3RhcnBhcw=="),s("LnJla2xhbW9zX251b3JvZG9z"),s("aW1nW2FsdD0iUmVrbGFtaW5pcyBza3lkZWxpcyJd"),s("aW1nW2FsdD0iRGVkaWt1b3RpLmx0IHNlcnZlcmlhaSJd"),s("aW1nW2FsdD0iSG9zdGluZ2FzIFNlcnZlcmlhaS5sdCJd")],estonian:[s("QVtocmVmKj0iaHR0cDovL3BheTRyZXN1bHRzMjQuZXUiXQ==")],fanboyAnnoyances:["#ac-lre-player",".navigate-to-top","#subscribe_popup",".newsletter_holder","#back-top"],fanboyAntiFacebook:[".util-bar-module-firefly-visible"],fanboyEnhancedTrackers:[".open.pushModal","#issuem-leaky-paywall-articles-zero-remaining-nag","#sovrn_container",'div[class$="-hide"][zoompage-fontsize][style="display: block;"]',".BlockNag__Card"],fanboySocial:["#FollowUs","#meteored_share","#social_follow",".article-sharer",".community__social-desc"],frellwitSwedish:[s("YVtocmVmKj0iY2FzaW5vcHJvLnNlIl1bdGFyZ2V0PSJfYmxhbmsiXQ=="),s("YVtocmVmKj0iZG9rdG9yLXNlLm9uZWxpbmsubWUiXQ=="),"article.category-samarbete",s("ZGl2LmhvbGlkQWRz"),"ul.adsmodern"],greekAdBlock:[s("QVtocmVmKj0iYWRtYW4ub3RlbmV0LmdyL2NsaWNrPyJd"),s("QVtocmVmKj0iaHR0cDovL2F4aWFiYW5uZXJzLmV4b2R1cy5nci8iXQ=="),s("QVtocmVmKj0iaHR0cDovL2ludGVyYWN0aXZlLmZvcnRobmV0LmdyL2NsaWNrPyJd"),"DIV.agores300","TABLE.advright"],hungarian:["#cemp_doboz",".optimonk-iframe-container",s("LmFkX19tYWlu"),s("W2NsYXNzKj0iR29vZ2xlQWRzIl0="),"#hirdetesek_box"],iDontCareAboutCookies:['.alert-info[data-block-track*="CookieNotice"]',".ModuleTemplateCookieIndicator",".o--cookies--container","#cookies-policy-sticky","#stickyCookieBar"],icelandicAbp:[s("QVtocmVmXj0iL2ZyYW1ld29yay9yZXNvdXJjZXMvZm9ybXMvYWRzLmFzcHgiXQ==")],latvian:[s("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiAxMjBweDsgaGVpZ2h0OiA0MHB4OyBvdmVyZmxvdzogaGlkZGVuOyBwb3NpdGlvbjogcmVsYXRpdmU7Il0="),s("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiA4OHB4OyBoZWlnaHQ6IDMxcHg7IG92ZXJmbG93OiBoaWRkZW47IHBvc2l0aW9uOiByZWxhdGl2ZTsiXQ==")],listKr:[s("YVtocmVmKj0iLy9hZC5wbGFuYnBsdXMuY28ua3IvIl0="),s("I2xpdmVyZUFkV3JhcHBlcg=="),s("YVtocmVmKj0iLy9hZHYuaW1hZHJlcC5jby5rci8iXQ=="),s("aW5zLmZhc3R2aWV3LWFk"),".revenue_unit_item.dable"],listeAr:[s("LmdlbWluaUxCMUFk"),".right-and-left-sponsers",s("YVtocmVmKj0iLmFmbGFtLmluZm8iXQ=="),s("YVtocmVmKj0iYm9vcmFxLm9yZyJd"),s("YVtocmVmKj0iZHViaXp6bGUuY29tL2FyLz91dG1fc291cmNlPSJd")],listeFr:[s("YVtocmVmXj0iaHR0cDovL3Byb21vLnZhZG9yLmNvbS8iXQ=="),s("I2FkY29udGFpbmVyX3JlY2hlcmNoZQ=="),s("YVtocmVmKj0id2Vib3JhbWEuZnIvZmNnaS1iaW4vIl0="),".site-pub-interstitiel",'div[id^="crt-"][data-criteo-id]'],officialPolish:["#ceneo-placeholder-ceneo-12",s("W2hyZWZePSJodHRwczovL2FmZi5zZW5kaHViLnBsLyJd"),s("YVtocmVmXj0iaHR0cDovL2Fkdm1hbmFnZXIudGVjaGZ1bi5wbC9yZWRpcmVjdC8iXQ=="),s("YVtocmVmXj0iaHR0cDovL3d3dy50cml6ZXIucGwvP3V0bV9zb3VyY2UiXQ=="),s("ZGl2I3NrYXBpZWNfYWQ=")],ro:[s("YVtocmVmXj0iLy9hZmZ0cmsuYWx0ZXgucm8vQ291bnRlci9DbGljayJd"),s("YVtocmVmXj0iaHR0cHM6Ly9ibGFja2ZyaWRheXNhbGVzLnJvL3Ryay9zaG9wLyJd"),s("YVtocmVmXj0iaHR0cHM6Ly9ldmVudC4ycGVyZm9ybWFudC5jb20vZXZlbnRzL2NsaWNrIl0="),s("YVtocmVmXj0iaHR0cHM6Ly9sLnByb2ZpdHNoYXJlLnJvLyJd"),'a[href^="/url/"]'],ruAd:[s("YVtocmVmKj0iLy9mZWJyYXJlLnJ1LyJd"),s("YVtocmVmKj0iLy91dGltZy5ydS8iXQ=="),s("YVtocmVmKj0iOi8vY2hpa2lkaWtpLnJ1Il0="),"#pgeldiz",".yandex-rtb-block"],thaiAds:["a[href*=macau-uta-popup]",s("I2Fkcy1nb29nbGUtbWlkZGxlX3JlY3RhbmdsZS1ncm91cA=="),s("LmFkczMwMHM="),".bumq",".img-kosana"],webAnnoyancesUltralist:["#mod-social-share-2","#social-tools",s("LmN0cGwtZnVsbGJhbm5lcg=="),".zergnet-recommend",".yt.btn-link.btn-md.btn"]},n=Object.keys(e),[4,ue((o=[]).concat.apply(o,n.map((function(t){return e[t]}))))]):[2,void 0];case 1:return r=i.sent(),t&&function(e,t){for(var n="DOM blockers debug:\n```",i=0,r=Object.keys(e);i<r.length;i++){var a=r[i];n+="\n".concat(a,":");for(var o=0,s=e[a];o<s.length;o++){var c=s[o];n+="\n  ".concat(t[c]?"🚫":"➡️"," ").concat(c)}}console.log("".concat(n,"\n```"))}(e,r),(a=n.filter((function(t){var n=e[t];return R(n.map((function(e){return r[e]})))>.6*n.length}))).sort(),[2,a]}var s}))}))},fontPreferences:function(){return function(e,t){void 0===t&&(t=4e3);return ee((function(n,i){var a=i.document,o=a.body,s=o.style;s.width="".concat(t,"px"),s.webkitTextSizeAdjust=s.textSizeAdjust="none",Z()?o.style.zoom="".concat(1/i.devicePixelRatio):H()&&(o.style.zoom="reset");var c=a.createElement("div");return c.textContent=r([],Array(t/20|0),!0).map((function(){return"word"})).join(" "),o.appendChild(c),e(a,o)}),'<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1">')}((function(e,t){for(var n={},i={},r=0,a=Object.keys(_e);r<a.length;r++){var o=a[r],s=_e[o],c=s[0],d=void 0===c?{}:c,l=s[1],u=void 0===l?"mmMwWLliI0fiflO&1":l,h=e.createElement("span");h.textContent=u,h.style.whiteSpace="nowrap";for(var p=0,f=Object.keys(d);p<f.length;p++){var m=f[p],v=d[m];void 0!==v&&(h.style[m]=v)}n[o]=h,t.append(e.createElement("br"),h)}for(var g=0,y=Object.keys(_e);g<y.length;g++){i[o=y[g]]=n[o].getBoundingClientRect().width}return i}))},audio:function(){return H()&&$()&&J()||Z()&&(e=navigator,t=window,n=Audio.prototype,i=t.visualViewport,R(["srLatency"in n,"srChannelCount"in n,"devicePosture"in e,i&&"segments"in i,"getTextInformation"in Image.prototype])>=3)&&function(){var e=window,t=e.URLPattern;return R(["union"in Set.prototype,"Iterator"in e,t&&"hasRegExpGroups"in t.prototype,"RGB8"in WebGLRenderingContext.prototype])>=3}()?-4:function(){var e=window,t=e.OfflineAudioContext||e.webkitOfflineAudioContext;if(!t)return-2;if(H()&&!X()&&!function(){var e=window;return R(["DOMRectList"in e,"RTCPeerConnectionIceEvent"in e,"SVGGeometryElement"in e,"ontransitioncancel"in e])>=3}())return-1;var n=4500,i=new t(1,5e3,44100),r=i.createOscillator();r.type="triangle",r.frequency.value=1e4;var a=i.createDynamicsCompressor();a.threshold.value=-50,a.knee.value=40,a.ratio.value=12,a.attack.value=0,a.release.value=.25,r.connect(a),a.connect(i.destination),r.start(0);var o=function(e){var t=3,n=500,i=500,r=5e3,a=function(){},o=new Promise((function(o,s){var c=!1,d=0,l=0;e.oncomplete=function(e){return o(e.renderedBuffer)};var u=function(){setTimeout((function(){return s(Q("timeout"))}),Math.min(i,l+r-Date.now()))},h=function(){try{var i=e.startRendering();switch(b(i)&&T(i),e.state){case"running":l=Date.now(),c&&u();break;case"suspended":document.hidden||d++,c&&d>=t?s(Q("suspended")):setTimeout(h,n)}}catch(e){s(e)}};h(),a=function(){c||(c=!0,l>0&&u())}}));return[o,a]}(i),s=o[0],c=o[1],d=T(s.then((function(e){return function(e){for(var t=0,n=0;n<e.length;++n)t+=Math.abs(e[n]);return t}(e.getChannelData(0).subarray(n))}),(function(e){if("timeout"===e.name||"suspended"===e.name)return-3;throw e})));return function(){return c(),d}}();var e,t,n,i},screenFrame:function(){var e=this;if(H()&&$()&&J())return function(){return Promise.resolve(void 0)};var t=ce();return function(){return n(e,void 0,void 0,(function(){var e,n;return i(this,(function(i){switch(i.label){case 0:return[4,t()];case 1:return e=i.sent(),[2,[(n=function(e){return null===e?null:P(e,10)})(e[0]),n(e[1]),n(e[2]),n(e[3])]]}}))}))}},canvas:function(){return function(e){var t,n,i,r=!1,a=function(){var e=document.createElement("canvas");return e.width=1,e.height=1,[e,e.getContext("2d")]}(),o=a[0],s=a[1];!function(e,t){return!(!t||!e.toDataURL)}(o,s)?n=i="unsupported":(r=function(e){return e.rect(0,0,10,10),e.rect(2,2,6,6),!e.isPointInPath(5,5,"evenodd")}(s),e?n=i="skipped":(t=function(e,t){!function(e,t){e.width=240,e.height=60,t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(100,1,62,20),t.fillStyle="#069",t.font='11pt "Times New Roman"';var n="Cwm fjordbank gly ".concat(String.fromCharCode(55357,56835));t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.2)",t.font="18pt Arial",t.fillText(n,4,45)}(e,t);var n=ae(e),i=ae(e);if(n!==i)return["unstable","unstable"];!function(e,t){e.width=122,e.height=110,t.globalCompositeOperation="multiply";for(var n=0,i=[["#f2f",40,40],["#2ff",80,40],["#ff2",60,80]];n<i.length;n++){var r=i[n],a=r[0],o=r[1],s=r[2];t.fillStyle=a,t.beginPath(),t.arc(o,s,40,0,2*Math.PI,!0),t.closePath(),t.fill()}t.fillStyle="#f9c",t.arc(60,60,60,0,2*Math.PI,!0),t.arc(60,60,20,0,2*Math.PI,!0),t.fill("evenodd")}(e,t);var r=ae(e);return[r,n]}(o,s),n=t[0],i=t[1]));return{winding:r,geometry:n,text:i}}(H()&&$()&&J())},osCpu:function(){return navigator.oscpu},languages:function(){var e,t=navigator,n=[],i=t.language||t.userLanguage||t.browserLanguage||t.systemLanguage;if(void 0!==i&&n.push([i]),Array.isArray(t.languages))Z()&&R([!("MediaSettingsRange"in(e=window)),"RTCEncodedAudioFrame"in e,""+e.Intl=="[object Intl]",""+e.Reflect=="[object Reflect]"])>=3||n.push(t.languages);else if("string"==typeof t.languages){var r=t.languages;r&&n.push(r.split(","))}return n},colorDepth:function(){return window.screen.colorDepth},deviceMemory:function(){return E(C(navigator.deviceMemory),void 0)},screenResolution:function(){var e,t,n;if(!(H()&&$()&&J()))return e=screen,(n=[(t=function(e){return E(k(e),null)})(e.width),t(e.height)]).sort().reverse(),n},hardwareConcurrency:function(){return E(k(navigator.hardwareConcurrency),void 0)},timezone:function(){var e,t=null===(e=window.Intl)||void 0===e?void 0:e.DateTimeFormat;if(t){var n=(new t).resolvedOptions().timeZone;if(n)return n}var i,r=(i=(new Date).getFullYear(),-Math.max(C(new Date(i,0,1).getTimezoneOffset()),C(new Date(i,6,1).getTimezoneOffset())));return"UTC".concat(r>=0?"+":"").concat(r)},sessionStorage:function(){try{return!!window.sessionStorage}catch(e){return!0}},localStorage:function(){try{return!!window.localStorage}catch(e){return!0}},indexedDB:function(){var e,t;if(!(W()||(e=window,t=navigator,R(["msWriteProfilerMark"in e,"MSStream"in e,"msLaunchUri"in t,"msSaveBlob"in t])>=3&&!W())))try{return!!window.indexedDB}catch(e){return!0}},openDatabase:function(){return!!window.openDatabase},cpuClass:function(){return navigator.cpuClass},platform:function(){var e=navigator.platform;return"MacIntel"===e&&H()&&!X()?function(){if("iPad"===navigator.platform)return!0;var e=screen,t=e.width/e.height;return R(["MediaSource"in window,!!Element.prototype.webkitRequestFullscreen,t>.65&&t<1.53])>=2}()?"iPad":"iPhone":e},plugins:function(){var e=navigator.plugins;if(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(i){for(var r=[],a=0;a<i.length;++a){var o=i[a];r.push({type:o.type,suffixes:o.suffixes})}t.push({name:i.name,description:i.description,mimeTypes:r})}}return t}},touchSupport:function(){var e,t=navigator,n=0;void 0!==t.maxTouchPoints?n=k(t.maxTouchPoints):void 0!==t.msMaxTouchPoints&&(n=t.msMaxTouchPoints);try{document.createEvent("TouchEvent"),e=!0}catch(t){e=!1}return{maxTouchPoints:n,touchEvent:e,touchStart:"ontouchstart"in window}},vendor:function(){return navigator.vendor||""},vendorFlavors:function(){for(var e=[],t=0,n=["chrome","safari","__crWeb","__gCrWeb","yandex","__yb","__ybro","__firefox__","__edgeTrackingPreventionStatistics","webkit","oprt","samsungAr","ucweb","UCShellJava","puffinDevice"];t<n.length;t++){var i=n[t],r=window[i];r&&"object"==typeof r&&e.push(i)}return e.sort()},cookiesEnabled:function(){var e=document;try{e.cookie="cookietest=1; SameSite=Strict;";var t=-1!==e.cookie.indexOf("cookietest=");return e.cookie="cookietest=1; SameSite=Strict; expires=Thu, 01-Jan-1970 00:00:01 GMT",t}catch(e){return!1}},colorGamut:function(){for(var e=0,t=["rec2020","p3","srgb"];e<t.length;e++){var n=t[e];if(matchMedia("(color-gamut: ".concat(n,")")).matches)return n}},invertedColors:function(){return!!pe("inverted")||!pe("none")&&void 0},forcedColors:function(){return!!fe("active")||!fe("none")&&void 0},monochrome:function(){if(matchMedia("(min-monochrome: 0)").matches){for(var e=0;e<=100;++e)if(matchMedia("(max-monochrome: ".concat(e,")")).matches)return e;throw new Error("Too high value")}},contrast:function(){return me("no-preference")?0:me("high")||me("more")?1:me("low")||me("less")?-1:me("forced")?10:void 0},reducedMotion:function(){return!!ve("reduce")||!ve("no-preference")&&void 0},reducedTransparency:function(){return!!ge("reduce")||!ge("no-preference")&&void 0},hdr:function(){return!!ye("high")||!ye("standard")&&void 0},math:function(){var e,t=we.acos||be,n=we.acosh||be,i=we.asin||be,r=we.asinh||be,a=we.atanh||be,o=we.atan||be,s=we.sin||be,c=we.sinh||be,d=we.cos||be,l=we.cosh||be,u=we.tan||be,h=we.tanh||be,p=we.exp||be,f=we.expm1||be,m=we.log1p||be;return{acos:t(.12312423423423424),acosh:n(1e308),acoshPf:(e=1e154,we.log(e+we.sqrt(e*e-1))),asin:i(.12312423423423424),asinh:r(1),asinhPf:function(e){return we.log(e+we.sqrt(e*e+1))}(1),atanh:a(.5),atanhPf:function(e){return we.log((1+e)/(1-e))/2}(.5),atan:o(.5),sin:s(-1e300),sinh:c(1),sinhPf:function(e){return we.exp(e)-1/we.exp(e)/2}(1),cos:d(10.000000000123),cosh:l(1),coshPf:function(e){return(we.exp(e)+1/we.exp(e))/2}(1),tan:u(-1e300),tanh:h(1),tanhPf:function(e){return(we.exp(2*e)-1)/(we.exp(2*e)+1)}(1),exp:p(1),expm1:f(1),expm1Pf:function(e){return we.exp(e)-1}(1),log1p:m(10),log1pPf:function(e){return we.log(1+e)}(10),powPI:function(e){return we.pow(we.PI,e)}(-100)}},pdfViewerEnabled:function(){return navigator.pdfViewerEnabled},architecture:function(){var e=new Float32Array(1),t=new Uint8Array(e.buffer);return e[0]=1/0,e[0]=e[0]-e[0],t[3]},applePay:function(){var e=window.ApplePaySession;if("function"!=typeof(null==e?void 0:e.canMakePayments))return-1;if(Se())return-3;try{return e.canMakePayments()?1:0}catch(e){return function(e){if(e instanceof Error&&"InvalidAccessError"===e.name&&/\bfrom\b.*\binsecure\b/i.test(e.message))return-2;throw e}(e)}},privateClickMeasurement:function(){var e,t=document.createElement("a"),n=null!==(e=t.attributionSourceId)&&void 0!==e?e:t.attributionsourceid;return void 0===n?void 0:String(n)},audioBaseLatency:function(){var e;return q()||H()?window.AudioContext&&null!==(e=(new AudioContext).baseLatency)&&void 0!==e?e:-1:-2},dateTimeLocale:function(){if(!window.Intl)return-1;var e=window.Intl.DateTimeFormat;if(!e)return-2;var t=e().resolvedOptions().locale;return t||""===t?t:-3},webGlBasics:function(e){var t,n,i,r,a,o,s=Pe(e.cache);if(!s)return-1;if(!Le(s))return-2;var c=De()?null:s.getExtension(Re);return{version:(null===(t=s.getParameter(s.VERSION))||void 0===t?void 0:t.toString())||"",vendor:(null===(n=s.getParameter(s.VENDOR))||void 0===n?void 0:n.toString())||"",vendorUnmasked:c?null===(i=s.getParameter(c.UNMASKED_VENDOR_WEBGL))||void 0===i?void 0:i.toString():"",renderer:(null===(r=s.getParameter(s.RENDERER))||void 0===r?void 0:r.toString())||"",rendererUnmasked:c?null===(a=s.getParameter(c.UNMASKED_RENDERER_WEBGL))||void 0===a?void 0:a.toString():"",shadingLanguageVersion:(null===(o=s.getParameter(s.SHADING_LANGUAGE_VERSION))||void 0===o?void 0:o.toString())||""}},webGlExtensions:function(e){var t=Pe(e.cache);if(!t)return-1;if(!Le(t))return-2;var n=t.getSupportedExtensions(),i=t.getContextAttributes(),r=[],a=[],o=[],s=[],c=[];if(i)for(var d=0,l=Object.keys(i);d<l.length;d++){var u=l[d];a.push("".concat(u,"=").concat(i[u]))}for(var h=0,p=Ae(t);h<p.length;h++){var f=t[_=p[h]];o.push("".concat(_,"=").concat(f).concat(Te.has(f)?"=".concat(t.getParameter(f)):""))}if(n)for(var m=0,v=n;m<v.length;m++){var g=v[m];if(!(g===Re&&De()||"WEBGL_polygon_mode"===g&&(Z()||H()))){var y=t.getExtension(g);if(y)for(var w=0,b=Ae(y);w<b.length;w++){var _;f=y[_=b[w]];s.push("".concat(_,"=").concat(f).concat(ke.has(f)?"=".concat(t.getParameter(f)):""))}else r.push(g)}}for(var S=0,T=Ce;S<T.length;S++)for(var k=T[S],C=0,E=Ee;C<E.length;C++){var R=E[C],P=xe(t,k,R);c.push("".concat(k,".").concat(R,"=").concat(P.join(",")))}return s.sort(),o.sort(),{contextAttributes:a,parameters:o,shaderPrecisions:c,extensions:n,extensionParameters:s,unsupportedExtensions:r}}};function Me(e){var t=function(e){if(q())return.4;if(H())return!X()||$()&&J()?.3:.5;var t="value"in e.platform?e.platform.value:"";if(/^Win/.test(t))return.6;if(/^Mac/.test(t))return.5;return.7}(e),n=function(e){return P(.99+.01*e,1e-4)}(t);return{score:t,comment:"$ if upgrade to Pro: https://fpjs.dev/pro".replace(/\$/g,"".concat(n))}}function Be(e){return JSON.stringify(e,(function(e,n){return n instanceof Error?t({name:(i=n).name,message:i.message,stack:null===(r=i.stack)||void 0===r?void 0:r.split("\n")},i):n;var i,r}),2)}function Ne(e){return V(function(e){for(var t="",n=0,i=Object.keys(e).sort();n<i.length;n++){var r=i[n],a=e[r],o="error"in a?"error":JSON.stringify(a.value);t+="".concat(t?"|":"").concat(r.replace(/([:|\\])/g,"\\$1"),":").concat(o)}return t}(e))}function Fe(e){return void 0===e&&(e=50),function(e,t){void 0===t&&(t=1/0);var n=window.requestIdleCallback;return n?new Promise((function(e){return n.call(window,(function(){return e()}),{timeout:t})})):w(Math.min(e,t))}(e,2*e)}function je(e,t){var r=Date.now();return{get:function(a){return n(this,void 0,void 0,(function(){var n,o,s;return i(this,(function(i){switch(i.label){case 0:return n=Date.now(),[4,e()];case 1:return o=i.sent(),s=function(e){var t,n=Me(e);return{get visitorId(){return void 0===t&&(t=Ne(this.components)),t},set visitorId(e){t=e},confidence:n,components:e,version:y}}(o),(t||(null==a?void 0:a.debug))&&console.log("Copy the text below to get the debug data:\n\n```\nversion: ".concat(s.version,"\nuserAgent: ").concat(navigator.userAgent,"\ntimeBetweenLoadAndGet: ").concat(n-r,"\nvisitorId: ").concat(s.visitorId,"\ncomponents: ").concat(Be(o),"\n```")),[2,s]}}))}))}}}var ze={load:function(e){var t;return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var n,r,a;return i(this,(function(i){switch(i.label){case 0:return(null===(t=e.monitoring)||void 0===t||t)&&function(){if(!(window.__fpjs_d_m||Math.random()>=.001))try{var e=new XMLHttpRequest;e.open("get","https://m1.openfpcdn.io/fingerprintjs/v".concat(y,"/npm-monitoring"),!0),e.send()}catch(e){console.error(e)}}(),n=e.delayFallback,r=e.debug,[4,Fe(n)];case 1:return i.sent(),a=function(e){return U(Oe,e,[])}({cache:{},debug:r}),[2,je(a,r)]}}))}))},hashComponents:Ne,componentsToDebugString:Be};class Ge{constructor(){this.base64Chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}encode(e){let t="";for(let n=0;n<e.length;n+=3){let i=e.charCodeAt(n),r=n+1<e.length?e.charCodeAt(n+1):0,a=n+2<e.length?e.charCodeAt(n+2):0,o=i>>2,s=(3&i)<<4|r>>4,c=(15&r)<<2|a>>6,d=63&a;t+=this.base64Chars[o]+this.base64Chars[s]+(n+1<e.length?this.base64Chars[c]:"=")+(n+2<e.length?this.base64Chars[d]:"=")}return t}decode(e){let t="",n=0;for(;n<e.length;){let i=this.base64Chars.indexOf(e.charAt(n++)),r=this.base64Chars.indexOf(e.charAt(n++)),a=this.base64Chars.indexOf(e.charAt(n++)),o=this.base64Chars.indexOf(e.charAt(n++)),s=i<<2|r>>4,c=(15&r)<<4|a>>2,d=(3&a)<<6|o;t+=String.fromCharCode(s),64!=a&&(t+=String.fromCharCode(c)),64!=o&&(t+=String.fromCharCode(d))}return t}}const Ve=function(e){return e.replace(/\//g,"_").replace(/\+/g,"-")},Ue=(e,t)=>n(void 0,void 0,void 0,(function*(){const n=new TextEncoder,i=n.encode(t),r=n.encode(e),a=yield window.crypto.subtle.importKey("raw",i,{name:"HMAC",hash:"SHA-1"},!1,["sign"]);return function(e){let t="";const n=new Uint8Array(e),i=n.byteLength;for(let e=0;e<i;e++)t+=String.fromCharCode(n[e]);return window.btoa(t)}(yield window.crypto.subtle.sign("HMAC",a,r))}));class We{constructor(e,t=3600){this.scope=e,this.expires=t}token(){return n(this,void 0,void 0,(function*(){let e=this.getFlags(),t=function(e){let t=(new Ge).encode(e);return Ve(t)}(JSON.stringify(e)),n=yield Ue(t,"i69H2bnVyY0cP2t2kywaUKy2v9sxXgaT");return"3x03N060VKZYT8fKvbRP7Do1m1ifop07:"+Ve(n)+":"+t}))}getFlags(){let e={};return e.scope=this.scope,e.deadline=this.expires+Math.floor(Date.now()/1e3),e}}const Ze=e=>n(void 0,void 0,void 0,(function*(){const t=`${e.name}.${e.format}`,i=yield function(e){return n(this,void 0,void 0,(function*(){let t=new We("rtplayer-sdk-log:"+e);return yield t.token()}))}(t),r=new FormData;r.append("action",e.action),r.append("key",t),r.append("token",i),r.append("file",e.file);return yield fetch("https://upload.qiniup.com",{method:"POST",body:r})})),He={disable:0,error:1,fatal:1,warning:2,log:3,debug:4},Xe={name:m,indexes:[]};function Je(){const e=new Date;function t(e){const t=e.toString();return t.length<2?"0"+t:t}return`[${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}.${e.getMilliseconds()}]`}const Ye=new class{constructor(e){this.url="",this.mikuFingerprint="",this.canUploadLog=!1,this.level=e,this.db=new l("qn_rtplayer-web/dc/v1",[Xe])}setLevel(e){this.level=e}initUpload(e){return n(this,void 0,void 0,(function*(){this.url=e;let t=localStorage.getItem("mikuFingerprint");t||(t=yield this.getMikuFingerprint(),localStorage.setItem("mikuFingerprint",t)),this.mikuFingerprint=t;const n=new URL(e);return n.searchParams.set("mClientId",t),this.canUploadLog&&this.checkErrorNUpload(),this.checkErrorNUpload(),n.toString()}))}insertDBLog(e,t,i){return n(this,void 0,void 0,(function*(){if(!this.canUploadLog)return;(yield this.db.count(m))>=200&&(yield this.db.removeRange(m,0,1)),yield this.db.set(m,Date.now().toString(),`${t} [${e}] url: ${this.url} ${i}`),"fatal"===e&&this.uploadDBLog(!0)}))}uploadDBLog(e=!1){return n(this,void 0,void 0,(function*(){if(this.canUploadLog)try{const t=(yield this.db.getAll(m)).map((e=>e+"\n")),n=[];let i=0;const r=10485760;for(let e=t.length-1;e>=0&&i+t[e].length<=r;e--)i+=t[e].length,n.unshift(t[e]);const a=new Blob(n,{type:"text/plain;charset=utf-8"}),o=new File([a],"log.text",{type:"text/plain"}),s=`QNLog_Miku_${Je()}_${this.mikuFingerprint}`;console.debug(`miku upload log path: ${s}.txt`);200===(yield Ze({action:"https://up-z0.qiniup.com",name:s,format:"txt",file:o})).status?yield this.db.clear():e&&this.uploadDBLog(!1)}catch(t){console.log("upload log error",t),e&&this.uploadDBLog(!1)}}))}checkErrorNUpload(){return n(this,void 0,void 0,(function*(){let e=yield this.db.getAll(m);const t=/fatal/;for(let n=e.length-1;n>=e.length-10&&n>=0;n--){const i=e[n].toString();if(t.test(i)){yield this.uploadDBLog(!1);break}}yield this.db.clear()}))}getMikuFingerprint(){return n(this,void 0,void 0,(function*(){const e=yield ze.load();return(yield e.get()).visitorId}))}isDisabled(e){return He[this.level]<He[e]}log(e,t){if(this.isDisabled("log"))return;const n=Je(),i=`${n} %cLOG-QNRTPLAYER`;console.log(i,"color: #66ccff; font-weight: bold;",e),this.insertDBLog("log",n,e),ct(n,"log",e,t)}debug(e,t){if(this.isDisabled("debug"))return;const n=Je(),i=`${n} %cDEBUG-QNRTPLAYER`;console.debug(i,"color: #A28148; font-weight: bold;",e),ct(n,"debug",e,t)}warning(e,t){if(this.isDisabled("warning"))return;const n=Je(),i=`${n} %cWARNING-QNRTPLAYER`;console.warn(i,"color: #E44F44; font-weight: bold;",e),this.insertDBLog("warning",n,e),ct(n,"warning",e,t)}error(e,t){if(this.isDisabled("error"))return;const n=Je(),i=`${n} %cERROR-QNRTPLAYER`;console.error(i,"color: #EF4149; font-weight: bold;",e),this.insertDBLog("error",n,e),ct(n,"error",e,t)}fatal(e,t){if(this.isDisabled("error"))return;const n=Je(),i=`${n} %cERROR-QNRTPLAYER`;console.error(i,"color: #EF4149; font-weight: bold;",e),this.insertDBLog("fatal",n,e),ct(n,"error",e,t)}}("log");function $e(e){return("0"+e.toString(16)).substr(-2)}function Ke(e=5){const t=new Uint8Array((e||40)/2);return window.crypto.getRandomValues(t),Array.from(t,$e).join("")}function qe(e,t,n=!1){try{return n?JSON.stringify(e,null,2):JSON.stringify(e)}catch(e){return Ye.warning(`json stringify error: ${qe(e,t)}`,t),"stringify error"}}function Qe(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}class et extends Error{constructor(){super(...arguments),this.name="TimeoutError"}}function tt(e,t){return new Promise(((n,i)=>{setTimeout((()=>i(new et(t+" timeout"))),e)}))}function nt(){}function it(e){var t;const n=[],i=/\b(?:\d{1,3}\.){3}\d{1,3}\b/g,r=e.split("\n").filter((e=>e.startsWith("a=candidate")));for(let e of r){const r=e.match(i)||[];n.push(null!==(t=r[0])&&void 0!==t?t:"")}return n}function rt(e){return"number"!=typeof e||isNaN(e)?-1:e}new s;const at={},ot=()=>{var e;const t=Ke(30);return(null===(e=Object.keys(at||{}))||void 0===e?void 0:e.some((e=>e===t)))?ot():t},st=(e,t,n)=>{at[n].emit(e,t)},ct=(e,t,n,i)=>{const r={time:e,level:t,msg:n,id:Ke(8)};st("log",r,i)},dt=(e,t)=>{st("error",e,t)};class lt extends Error{constructor(){super(...arguments),this.name="QNRTPlayerError"}}const ut=(e,t)=>{dt({code:20001,errorType:"networkError",msg:e},t),Ye.fatal(e,t)},ht=(e,t)=>{dt({code:20003,errorType:"playStreamNotExist",msg:e},t),Ye.fatal(e,t)},pt=(e,t)=>{dt({code:20004,errorType:"playRequestFailed",msg:e},t),Ye.fatal(e,t)},ft=(e,t)=>{dt({code:20005,errorType:"descriptionError",msg:e},t),Ye.fatal(e,t)},mt=(e,t)=>{dt({code:20006,errorType:"connectFailed",msg:e},t),Ye.fatal(e,t)},vt=(e,t)=>{dt({code:30001,errorType:"rtcNotSupport",msg:e},t),Ye.warning(e,t)};let gt=!0,yt=!0;function wt(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function bt(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);const a=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,a),r.apply(this,[e,a])};const a=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(n))return a.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function _t(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(gt=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function St(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(yt=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Tt(){if("object"==typeof window){if(gt)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function kt(e,t){yt&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Ct(e){return"[object Object]"===Object.prototype.toString.call(e)}function Et(e){return Ct(e)?Object.keys(e).reduce((function(t,n){const i=Ct(e[n]),r=i?Et(e[n]):e[n],a=i&&!Object.keys(r).length;return void 0===r||a?t:Object.assign(t,{[n]:r})}),{}):e}function Rt(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?Rt(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{Rt(e,e.get(t),n)}))})))}function Pt(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const a=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&Rt(e,n,r)}))})),r}const xt=Tt;function At(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[r("min",n)]=i.ideal,t.optional.push(e),e={},e[r("max",n)]=i.ideal,t.optional.push(e)):(e[r("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});const o=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||o)){let t;if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?t=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let o=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!o&&n.length&&t.includes("back")&&(o=n[n.length-1]),o&&(e.video.deviceId=a.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=i(e.video),xt("chrome: "+JSON.stringify(e)),r(e)}))}e.video=i(e.video)}return xt("chrome: "+JSON.stringify(e)),r(e)},a=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{i&&i(a(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return r(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(a(e))))))}}}function It(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Dt(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const r=new Event("track");r.track=n.track,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else bt(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function Lt(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Ot(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,i]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const r=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},a=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){n(a(r(e)))};return t.apply(this,[i,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(a(r(t)))},n])})).then(n,i)}}function Mt(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>Pt(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),bt(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>Pt(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Bt(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),r.apply(this,arguments)}}function Nt(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Bt(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function a(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r=this._streams[n.id];if(r)r.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=a(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>a(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Ft(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function jt(e,t){bt(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var zt=Object.freeze({__proto__:null,shimMediaStream:It,shimOnTrack:Dt,shimGetSendersWithDtmf:Lt,shimGetStats:Ot,shimSenderReceiverGetStats:Mt,shimAddTrackRemoveTrackWithNative:Bt,shimAddTrackRemoveTrack:Nt,shimPeerConnection:Ft,fixNegotiationNeeded:jt,shimGetUserMedia:At,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const i=n.video&&n.video.width,r=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},i&&(n.video.mandatory.maxWidth=i),r&&(n.video.mandatory.maxHeight=r),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});var Gt=o((function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),r=0;r<i.length;r++)n[(t=i[r].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],r=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substr(12),password:r.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" "),r=3;r<i.length;r++){var a=i[r],o=t.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(o){var s=t.parseRtpMap(o),c=t.matchPrefix(e,"a=fmtp:"+a+" ");switch(s.parameters=c.length?t.parseFmtp(c[0]):{},s.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),n.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(s.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));var r=0;return n.codecs.forEach((function(e){e.maxptime>r&&(r=e.maxptime)})),r>0&&(i+="a=maxptime:"+r+"\r\n"),i+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){var n,i=[],r=t.parseRtpParameters(e),a=-1!==r.fecMechanisms.indexOf("RED"),o=-1!==r.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,d=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(n=d[0][1]),r.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),i.push(t),a&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},i.push(t))}})),0===i.length&&c&&i.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,i.forEach((function(e){e.maxBitrate=l}))),i},t.parseRtcpParameters=function(e){var n={},i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);var r=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=r.length>0,n.compound=0===r.length;var a=t.matchPrefix(e,"a=rtcp-mux");return n.mux=a.length>0,n},t.parseMsid=function(e){var n,i=t.matchPrefix(e,"a=msid:");if(1===i.length)return{stream:(n=i[0].substr(7).split(" "))[0],track:n[1]};var r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return r.length>0?{stream:(n=r[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,i=t.parseMLine(e),r=t.matchPrefix(e,"a=max-message-size:");r.length>0&&(n=parseInt(r[0].substr(19),10)),isNaN(n)&&(n=65536);var a=t.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:i.fmt,maxMessageSize:n};if(t.matchPrefix(e,"a=sctpmap:").length>0){var o=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(o[0],10),protocol:o[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,i){var r=void 0!==n?n:2;return"v=0\r\no="+(i||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+r+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,i,r){var a=t.writeRtpDescription(e.kind,n);if(a+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",e.direction?a+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var o="msid:"+r.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+o,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),a},t.getDirection=function(e,n){for(var i=t.splitLines(e),r=0;r<i.length;r++)switch(i[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[r].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),i=0;i<n.length;i++)if(n[i].length<2||"="!==n[i].charAt(1))return!1;return!0},e.exports=t}));function Vt(e,t,n,i,r){var a=Gt.writeRtpDescription(e.kind,t);if(a+=Gt.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=Gt.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":r||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var s="msid:"+(i?i.id:"-")+" "+o+"\r\n";a+="a="+s,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+Gt.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+Gt.localCName+"\r\n"),a}function Ut(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},r=function(e,t,n,r){var a=i(e.parameters.apt,n),o=i(t.parameters.apt,r);return a&&o&&a.name.toLowerCase()===o.name.toLowerCase()};return e.codecs.forEach((function(i){for(var a=0;a<t.codecs.length;a++){var o=t.codecs[a];if(i.name.toLowerCase()===o.name.toLowerCase()&&i.clockRate===o.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&o.parameters.apt&&!r(i,o,e.codecs,t.codecs))continue;(o=JSON.parse(JSON.stringify(o))).numChannels=Math.min(i.numChannels,o.numChannels),n.codecs.push(o),o.rtcpFeedback=o.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var r=t.headerExtensions[i];if(e.uri===r.uri){n.headerExtensions.push(r);break}}})),n}function Wt(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function Zt(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function Ht(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}var Xt=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function i(t,n,i,r){var a=new Event("track");a.track=n,a.receiver=i,a.transceiver={receiver:i},a.streams=r,e.setTimeout((function(){t._dispatchEvent("track",a)}))}var r=function(n){var i=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=r[e].bind(r)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw Ht("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var r="string"==typeof i;return r&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=r?i[0]:i,!!i.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=Gt.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(r.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(r.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),r.prototype.onicecandidate=null,r.prototype.onaddstream=null,r.prototype.ontrack=null,r.prototype.onremovestream=null,r.prototype.onsignalingstatechange=null,r.prototype.oniceconnectionstatechange=null,r.prototype.onconnectionstatechange=null,r.prototype.onicegatheringstatechange=null,r.prototype.onnegotiationneeded=null,r.prototype.ondatachannel=null,r.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},r.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},r.prototype.getConfiguration=function(){return this._config},r.prototype.getLocalStreams=function(){return this.localStreams},r.prototype.getRemoteStreams=function(){return this.remoteStreams},r.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var r=this._createIceAndDtlsTransports();i.iceTransport=r.iceTransport,i.dtlsTransport=r.dtlsTransport}return t||this.transceivers.push(i),i},r.prototype.addTrack=function(t,n){if(this._isClosed)throw Ht("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw Ht("InvalidAccessError","Track already exists.");for(var r=0;r<this.transceivers.length;r++)this.transceivers[r].track||this.transceivers[r].kind!==t.kind||(i=this.transceivers[r]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},r.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),i.getTracks().forEach((function(e){n.addTrack(e,i)}))}},r.prototype.removeTrack=function(t){if(this._isClosed)throw Ht("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw Ht("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},r.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},r.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},r.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},r.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var r=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(r,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;r.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},r.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),r},r.prototype._gather=function(t,n){var i=this,r=this.transceivers[n].iceGatherer;if(!r.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,r.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),r.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var o=e.candidate,s=!o||0===Object.keys(o).length;if(s)"new"!==r.state&&"gathering"!==r.state||(r.state="completed");else{"new"===r.state&&(r.state="gathering"),o.component=1,o.ufrag=r.getLocalParameters().usernameFragment;var c=Gt.writeCandidate(o);a.candidate=Object.assign(a.candidate,Gt.parseCandidate(c)),a.candidate.candidate=c,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var d=Gt.getMediaSections(i._localDescription.sdp);d[a.candidate.sdpMLineIndex]+=s?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=Gt.getDescription(i._localDescription.sdp)+d.join("");var l=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),s||i._dispatchEvent("icecandidate",a),l&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){r.onlocalcandidate(e)}))}),0)}},r.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},r.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},r.prototype._transceive=function(e,n,i){var r=Ut(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(r.encodings=e.sendEncodingParameters,r.rtcp={cname:Gt.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(r.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(r)),i&&e.rtpReceiver&&r.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?r.encodings=e.recvEncodingParameters:r.encodings=[{}],r.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(r.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(r.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(r))},r.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(Ht("TypeError",'Unsupported type "'+e.type+'"'));if(!Wt("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(Ht("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=Gt.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=Gt.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=Gt.splitSections(i._remoteDescription.sdp),n=t.shift();var r=Gt.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=i.transceivers[t],o=a.iceGatherer,s=a.iceTransport,c=a.dtlsTransport,d=a.localCapabilities,l=a.remoteCapabilities;if(!(Gt.isRejected(e)&&0===Gt.matchPrefix(e,"a=bundle-only").length)&&!a.rejected){var u=Gt.getIceParameters(e,n),h=Gt.getDtlsParameters(e,n);r&&(h.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===s.state&&s.start(o,u,r?"controlling":"controlled"),"new"===c.state&&c.start(h));var p=Ut(d,l);i._transceive(a,p.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},r.prototype.setRemoteDescription=function(r){var a=this;if(-1===["offer","answer"].indexOf(r.type))return Promise.reject(Ht("TypeError",'Unsupported type "'+r.type+'"'));if(!Wt("setRemoteDescription",r.type,a.signalingState)||a._isClosed)return Promise.reject(Ht("InvalidStateError","Can not set remote "+r.type+" in state "+a.signalingState));var o={};a.remoteStreams.forEach((function(e){o[e.id]=e}));var s=[],c=Gt.splitSections(r.sdp),d=c.shift(),l=Gt.matchPrefix(d,"a=ice-lite").length>0,u=Gt.matchPrefix(d,"a=group:BUNDLE ").length>0;a.usingBundle=u;var h=Gt.matchPrefix(d,"a=ice-options:")[0];return a.canTrickleIceCandidates=!!h&&h.substr(14).split(" ").indexOf("trickle")>=0,c.forEach((function(i,c){var h=Gt.splitLines(i),p=Gt.getKind(i),f=Gt.isRejected(i)&&0===Gt.matchPrefix(i,"a=bundle-only").length,m=h[0].substr(2).split(" ")[2],v=Gt.getDirection(i,d),g=Gt.parseMsid(i),y=Gt.getMid(i)||Gt.generateIdentifier();if(f||"application"===p&&("DTLS/SCTP"===m||"UDP/DTLS/SCTP"===m))a.transceivers[c]={mid:y,kind:p,protocol:m,rejected:!0};else{var w,b,_,S,T,k,C,E,R;!f&&a.transceivers[c]&&a.transceivers[c].rejected&&(a.transceivers[c]=a._createTransceiver(p,!0));var P,x,A=Gt.parseRtpParameters(i);f||(P=Gt.getIceParameters(i,d),(x=Gt.getDtlsParameters(i,d)).role="client"),C=Gt.parseRtpEncodingParameters(i);var I=Gt.parseRtcpParameters(i),D=Gt.matchPrefix(i,"a=end-of-candidates",d).length>0,L=Gt.matchPrefix(i,"a=candidate:").map((function(e){return Gt.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===r.type||"answer"===r.type)&&!f&&u&&c>0&&a.transceivers[c]&&(a._disposeIceAndDtlsTransports(c),a.transceivers[c].iceGatherer=a.transceivers[0].iceGatherer,a.transceivers[c].iceTransport=a.transceivers[0].iceTransport,a.transceivers[c].dtlsTransport=a.transceivers[0].dtlsTransport,a.transceivers[c].rtpSender&&a.transceivers[c].rtpSender.setTransport(a.transceivers[0].dtlsTransport),a.transceivers[c].rtpReceiver&&a.transceivers[c].rtpReceiver.setTransport(a.transceivers[0].dtlsTransport)),"offer"!==r.type||f){if("answer"===r.type&&!f){b=(w=a.transceivers[c]).iceGatherer,_=w.iceTransport,S=w.dtlsTransport,T=w.rtpReceiver,k=w.sendEncodingParameters,E=w.localCapabilities,a.transceivers[c].recvEncodingParameters=C,a.transceivers[c].remoteCapabilities=A,a.transceivers[c].rtcpParameters=I,L.length&&"new"===_.state&&(!l&&!D||u&&0!==c?L.forEach((function(e){Zt(w.iceTransport,e)})):_.setRemoteCandidates(L)),u&&0!==c||("new"===_.state&&_.start(b,P,"controlling"),"new"===S.state&&S.start(x)),!Ut(w.localCapabilities,w.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,a._transceive(w,"sendrecv"===v||"recvonly"===v,"sendrecv"===v||"sendonly"===v),!T||"sendrecv"!==v&&"sendonly"!==v?delete w.rtpReceiver:(R=T.track,g?(o[g.stream]||(o[g.stream]=new e.MediaStream),n(R,o[g.stream]),s.push([R,T,o[g.stream]])):(o.default||(o.default=new e.MediaStream),n(R,o.default),s.push([R,T,o.default])))}}else{(w=a.transceivers[c]||a._createTransceiver(p)).mid=y,w.iceGatherer||(w.iceGatherer=a._createIceGatherer(c,u)),L.length&&"new"===w.iceTransport.state&&(!D||u&&0!==c?L.forEach((function(e){Zt(w.iceTransport,e)})):w.iceTransport.setRemoteCandidates(L)),E=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(E.codecs=E.codecs.filter((function(e){return"rtx"!==e.name}))),k=w.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var O,M=!1;if("sendrecv"===v||"sendonly"===v){if(M=!w.rtpReceiver,T=w.rtpReceiver||new e.RTCRtpReceiver(w.dtlsTransport,p),M)R=T.track,g&&"-"===g.stream||(g?(o[g.stream]||(o[g.stream]=new e.MediaStream,Object.defineProperty(o[g.stream],"id",{get:function(){return g.stream}})),Object.defineProperty(R,"id",{get:function(){return g.track}}),O=o[g.stream]):(o.default||(o.default=new e.MediaStream),O=o.default)),O&&(n(R,O),w.associatedRemoteMediaStreams.push(O)),s.push([R,T,O])}else w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===w.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),w.associatedRemoteMediaStreams=[]);w.localCapabilities=E,w.remoteCapabilities=A,w.rtpReceiver=T,w.rtcpParameters=I,w.sendEncodingParameters=k,w.recvEncodingParameters=C,a._transceive(a.transceivers[c],!1,M)}}})),void 0===a._dtlsRole&&(a._dtlsRole="offer"===r.type?"active":"passive"),a._remoteDescription={type:r.type,sdp:r.sdp},"offer"===r.type?a._updateSignalingState("have-remote-offer"):a._updateSignalingState("stable"),Object.keys(o).forEach((function(t){var n=o[t];if(n.getTracks().length){if(-1===a.remoteStreams.indexOf(n)){a.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){a._dispatchEvent("addstream",r)}))}s.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&i(a,t,r,[n])}))}})),s.forEach((function(e){e[2]||i(a,e[0],e[1],[])})),e.setTimeout((function(){a&&a.transceivers&&a.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},r.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},r.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},r.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},r.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},r.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},r.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(Ht("InvalidStateError","Can not call createOffer after close"));var i=n.transceivers.filter((function(e){return"audio"===e.kind})).length,r=n.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(i=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(r=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--i<0&&(e.wantReceive=!1):"video"===e.kind&&--r<0&&(e.wantReceive=!1)}));i>0||r>0;)i>0&&(n._createTransceiver("audio"),i--),r>0&&(n._createTransceiver("video"),r--);var o=Gt.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,r){var a=i.track,o=i.kind,s=i.mid||Gt.generateIdentifier();i.mid=s,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(r,n.usingBundle));var c=e.RTCRtpSender.getCapabilities(o);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var d=i.sendEncodingParameters||[{ssrc:1001*(2*r+1)}];a&&t>=15019&&"video"===o&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,o)),i.localCapabilities=c,i.sendEncodingParameters=d})),"max-compat"!==n._config.bundlePolicy&&(o+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),o+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){o+=Vt(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),o+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,o+="a="+Gt.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(o+="a=end-of-candidates\r\n"))}));var s=new e.RTCSessionDescription({type:"offer",sdp:o});return Promise.resolve(s)},r.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(Ht("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(Ht("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var i=Gt.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(i+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),i+="a=ice-options:trickle\r\n";var r=Gt.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,a){if(!(a+1>r)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?i+="m=application 0 DTLS/SCTP 5000\r\n":i+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?i+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(i+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(i+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var o;if(e.stream)"audio"===e.kind?o=e.stream.getAudioTracks()[0]:"video"===e.kind&&(o=e.stream.getVideoTracks()[0]),o&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var s=Ut(e.localCapabilities,e.remoteCapabilities);!s.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,i+=Vt(e,s,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(i+="a=rtcp-rsize\r\n")}}));var a=new e.RTCSessionDescription({type:"answer",sdp:i});return Promise.resolve(a)},r.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,r){if(!n._remoteDescription)return r(Ht("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var o=0;o<n.transceivers.length;o++)if(n.transceivers[o].mid===e.sdpMid){a=o;break}var s=n.transceivers[a];if(!s)return r(Ht("OperationError","Can not add ICE candidate"));if(s.rejected)return i();var c=Object.keys(e.candidate).length>0?Gt.parseCandidate(e.candidate):{};if("tcp"===c.protocol&&(0===c.port||9===c.port))return i();if(c.component&&1!==c.component)return i();if((0===a||a>0&&s.iceTransport!==n.transceivers[0].iceTransport)&&!Zt(s.iceTransport,c))return r(Ht("OperationError","Can not add ICE candidate"));var d=e.candidate.trim();0===d.indexOf("a=")&&(d=d.substr(2)),(t=Gt.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(c.type?d:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=Gt.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var l=0;l<n.transceivers.length&&(n.transceivers[l].rejected||(n.transceivers[l].iceTransport.addRemoteCandidate({}),(t=Gt.getMediaSections(n._remoteDescription.sdp))[l]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=Gt.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));l++);i()}))},r.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw Ht("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var i;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[n]).type]||i.type,t.set(n,e[n])})),t}))}}}));var a=["createOffer","createAnswer"];return a.forEach((function(e){var t=r.prototype[e];r.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(a=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=r.prototype[e];r.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=r.prototype[e];r.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),r};function Jt(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e))))}}function Yt(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function $t(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=Xt(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e){let t=!1;return(e=JSON.parse(JSON.stringify(e))).filter((e=>{if(e&&(e.urls||e.url)){let n=e.urls||e.url;e.url&&!e.urls&&kt("RTCIceServer.url","RTCIceServer.urls");const i="string"==typeof n;return i&&(n=[n]),n=n.filter((e=>{if(0===e.indexOf("stun:"))return!1;const n=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return n&&!t?(t=!0,!0):n&&!t})),delete e.url,e.urls=i?n[0]:n,!!n.length}}))}(e.iceServers,t.version),Tt("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function Kt(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var qt=Object.freeze({__proto__:null,shimPeerConnection:$t,shimReplaceTrack:Kt,shimGetUserMedia:Jt,shimGetDisplayMedia:Yt});function Qt(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){kt("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function en(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function tn(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,a]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!r)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(r,a)}}function nn(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function rn(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),bt(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function an(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){kt("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function on(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function sn(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function cn(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function dn(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function ln(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var un=Object.freeze({__proto__:null,shimOnTrack:en,shimPeerConnection:tn,shimSenderGetStats:nn,shimReceiverGetStats:rn,shimRemoveStream:an,shimRTCDataChannel:on,shimAddTransceiver:sn,shimGetParameters:cn,shimCreateOffer:dn,shimCreateAnswer:ln,shimGetUserMedia:Qt,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}});function hn(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function pn(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function fn(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,a=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};let s=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=s,s=function(e,t,n){const i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=s,s=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=s}function mn(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(vn(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function vn(e){return e&&void 0!==e.video?Object.assign({},e,{video:Et(e.video)}):e}function gn(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(kt("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function yn(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function wn(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function bn(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var _n=Object.freeze({__proto__:null,shimLocalStreamsAPI:hn,shimRemoteStreamsAPI:pn,shimCallbacksAPI:fn,shimGetUserMedia:mn,shimConstraints:vn,shimRTCIceServerUrls:gn,shimTrackEventTransceiver:yn,shimCreateOfferLegacy:wn,shimAudioContext:bn});function Sn(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),i=Gt.parseCandidate(e.candidate),r=Object.assign(n,i);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,bt(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Tn(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=Gt.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Gt.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const r=Gt.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let r;r=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>r}),this._sctp=a}return n.apply(this,arguments)}}function kn(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},bt(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function Cn(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function En(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Rn(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}var Pn=Object.freeze({__proto__:null,shimRTCIceCandidate:Sn,shimMaxMessageSize:Tn,shimSendThrowTypeError:kn,shimConnectionState:Cn,removeExtmapAllowMixed:En,shimAddIceCandidateNullOrEmpty:Rn});const xn=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const n=Tt,i=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=wt(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=wt(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=wt(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=wt(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),r={browserDetails:i,commonShim:Pn,extractVersion:wt,disableLog:_t,disableWarnings:St};switch(i.browser){case"chrome":if(!zt||!Ft||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=zt,Rn(e,i),At(e,i),It(e),Ft(e,i),Dt(e),Nt(e,i),Lt(e),Ot(e),Mt(e),jt(e,i),Sn(e),Cn(e),Tn(e,i),kn(e),En(e,i);break;case"firefox":if(!un||!tn||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=un,Rn(e,i),Qt(e,i),tn(e,i),en(e),an(e),nn(e),rn(e),on(e),sn(e),cn(e),dn(e),ln(e),Sn(e),Cn(e),Tn(e,i),kn(e);break;case"edge":if(!qt||!$t||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),r;n("adapter.js shimming edge."),r.browserShim=qt,Jt(e),Yt(e),$t(e,i),Kt(e),Tn(e,i),kn(e);break;case"safari":if(!_n||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=_n,Rn(e,i),gn(e),wn(e),fn(e),hn(e),pn(e),yn(e),mn(e),bn(e),Sn(e),Tn(e,i),kn(e),En(e,i);break;default:n("Unsupported browser!")}return r}({window:"undefined"==typeof window?void 0:window}),An={browser:xn.browserDetails.browser,version:xn.browserDetails.version,supportsUnifiedPlan:xn.browserDetails.supportsUnifiedPlan};function In(e){return n(this,void 0,void 0,(function*(){const t=yield e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});return!!t.sdp&&-1!==t.sdp.toLowerCase().indexOf("h264")}))}function Dn(){return n(this,void 0,void 0,(function*(){console.debug(JSON.stringify(An));const e=!!window.RTCPeerConnection;if(!e)return{peerConnection:!1,H264:!1,getStats:!1,jitterBufferTarget:!1};const t=new RTCPeerConnection,n=yield In(t),i=!!t.getStats;const r=function(e){const t=e.addTransceiver("video",{direction:"recvonly"}),n=void 0!==t.receiver.jitterBufferTarget;return t.stop(),n}(t);t.close();const a=new RTCPeerConnection,o=yield In(a);return a.close(),{peerConnection:e,H264:n||o,getStats:i,jitterBufferTarget:r}}))}var Ln=o((function(e,t){!function(n,i){var r="function",a="undefined",o="object",s="string",c="major",d="model",l="name",u="type",h="vendor",p="version",f="architecture",m="console",v="mobile",g="tablet",y="smarttv",w="wearable",b="embedded",_="Amazon",S="Apple",T="ASUS",k="BlackBerry",C="Browser",E="Chrome",R="Firefox",P="Google",x="Huawei",A="LG",I="Microsoft",D="Motorola",L="Opera",O="Samsung",M="Sharp",B="Sony",N="Xiaomi",F="Zebra",j="Facebook",z="Chromium OS",G="Mac OS",V=" Browser",U=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},W=function(e,t){return typeof e===s&&-1!==Z(t).indexOf(Z(e))},Z=function(e){return e.toLowerCase()},H=function(e,t){if(typeof e===s)return e=e.replace(/^\s\s*/,""),typeof t===a?e:e.substring(0,500)},X=function(e,t){for(var n,a,s,c,d,l,u=0;u<t.length&&!d;){var h=t[u],p=t[u+1];for(n=a=0;n<h.length&&!d&&h[n];)if(d=h[n++].exec(e))for(s=0;s<p.length;s++)l=d[++a],typeof(c=p[s])===o&&c.length>0?2===c.length?typeof c[1]==r?this[c[0]]=c[1].call(this,l):this[c[0]]=c[1]:3===c.length?typeof c[1]!==r||c[1].exec&&c[1].test?this[c[0]]=l?l.replace(c[1],c[2]):i:this[c[0]]=l?c[1].call(this,l,c[2]):i:4===c.length&&(this[c[0]]=l?c[3].call(this,l.replace(c[1],c[2])):i):this[c]=l||i;u+=2}},J=function(e,t){for(var n in t)if(typeof t[n]===o&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(W(t[n][r],e))return"?"===n?i:n}else if(W(t[n],e))return"?"===n?i:n;return t.hasOwnProperty("*")?t["*"]:e},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},$={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[l,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[l,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[l,p],[/opios[\/ ]+([\w\.]+)/i],[p,[l,L+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[p,[l,L+" GX"]],[/\bopr\/([\w\.]+)/i],[p,[l,L]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[p,[l,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[p,[l,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[l,p],[/quark(?:pc)?\/([-\w\.]+)/i],[p,[l,"Quark"]],[/\bddg\/([\w\.]+)/i],[p,[l,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[l,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[p,[l,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[l,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[l,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[p,[l,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[p,[l,"Smart Lenovo "+C]],[/(avast|avg)\/([\w\.]+)/i],[[l,/(.+)/,"$1 Secure "+C],p],[/\bfocus\/([\w\.]+)/i],[p,[l,R+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[l,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[l,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[l,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[l,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[l,"MIUI"+V]],[/fxios\/([\w\.-]+)/i],[p,[l,R]],[/\bqihoobrowser\/?([\w\.]*)/i],[p,[l,"360"]],[/\b(qq)\/([\w\.]+)/i],[[l,/(.+)/,"$1Browser"],p],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[l,/(.+)/,"$1"+V],p],[/samsungbrowser\/([\w\.]+)/i],[p,[l,O+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[p,[l,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[l,"Sogou Mobile"],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[l,p],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[l],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[p,l],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[l,j],p],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[l,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[l,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[p,[l,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[l,E+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[l,E+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[l,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[l,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[l,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,l],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[l,[p,J,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[l,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[l,"Netscape"],p],[/(wolvic|librewolf)\/([\w\.]+)/i],[l,p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[l,R+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[l,[p,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[l,[p,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,Z]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[f,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[f,"armhf"]],[/windows (ce|mobile); ppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[f,/ower/,"",Z]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[f,Z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[h,O],[u,g]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[d,[h,O],[u,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[h,S],[u,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[h,S],[u,g]],[/(macintosh);/i],[d,[h,S]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[h,M],[u,v]],[/(?:honor)([-\w ]+)[;\)]/i],[d,[h,"Honor"],[u,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[h,x],[u,g]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[h,x],[u,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[d,/_/g," "],[h,N],[u,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[h,N],[u,g]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[h,"OPPO"],[u,v]],[/\b(opd2\d{3}a?) bui/i],[d,[h,"OPPO"],[u,g]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[h,"Vivo"],[u,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[h,"Realme"],[u,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[h,D],[u,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[h,D],[u,g]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[h,A],[u,g]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[h,A],[u,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[h,"Lenovo"],[u,g]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[h,"Nokia"],[u,v]],[/(pixel c)\b/i],[d,[h,P],[u,g]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[h,P],[u,v]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[h,B],[u,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[h,B],[u,g]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[h,"OnePlus"],[u,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[h,_],[u,g]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[h,_],[u,v]],[/(playbook);[-\w\),; ]+(rim)/i],[d,h,[u,g]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[h,k],[u,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[h,T],[u,g]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[h,T],[u,v]],[/(nexus 9)/i],[d,[h,"HTC"],[u,g]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[h,[d,/_/g," "],[u,v]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[d,[h,"TCL"],[u,g]],[/(itel) ((\w+))/i],[[h,Z],d,[u,J,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[h,"Acer"],[u,g]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[h,"Meizu"],[u,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[h,"Ulefone"],[u,v]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[d,[h,"Energizer"],[u,v]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[d,[h,"Cat"],[u,v]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[d,[h,"Smartfren"],[u,v]],[/droid.+; (a(?:015|06[35]|142p?))/i],[d,[h,"Nothing"],[u,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,d,[u,v]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,d,[u,g]],[/(surface duo)/i],[d,[h,I],[u,g]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[h,"Fairphone"],[u,v]],[/(u304aa)/i],[d,[h,"AT&T"],[u,v]],[/\bsie-(\w*)/i],[d,[h,"Siemens"],[u,v]],[/\b(rct\w+) b/i],[d,[h,"RCA"],[u,g]],[/\b(venue[\d ]{2,7}) b/i],[d,[h,"Dell"],[u,g]],[/\b(q(?:mv|ta)\w+) b/i],[d,[h,"Verizon"],[u,g]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[h,"Barnes & Noble"],[u,g]],[/\b(tm\d{3}\w+) b/i],[d,[h,"NuVision"],[u,g]],[/\b(k88) b/i],[d,[h,"ZTE"],[u,g]],[/\b(nx\d{3}j) b/i],[d,[h,"ZTE"],[u,v]],[/\b(gen\d{3}) b.+49h/i],[d,[h,"Swiss"],[u,v]],[/\b(zur\d{3}) b/i],[d,[h,"Swiss"],[u,g]],[/\b((zeki)?tb.*\b) b/i],[d,[h,"Zeki"],[u,g]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],d,[u,g]],[/\b(ns-?\w{0,9}) b/i],[d,[h,"Insignia"],[u,g]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[h,"NextBook"],[u,g]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],d,[u,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],d,[u,v]],[/\b(ph-1) /i],[d,[h,"Essential"],[u,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[h,"Envizen"],[u,g]],[/\b(trio[-\w\. ]+) b/i],[d,[h,"MachSpeed"],[u,g]],[/\btu_(1491) b/i],[d,[h,"Rotor"],[u,g]],[/(shield[\w ]+) b/i],[d,[h,"Nvidia"],[u,g]],[/(sprint) (\w+)/i],[h,d,[u,v]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[h,I],[u,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[h,F],[u,g]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[h,F],[u,v]],[/smart-tv.+(samsung)/i],[h,[u,y]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[h,O],[u,y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,A],[u,y]],[/(apple) ?tv/i],[h,[d,S+" TV"],[u,y]],[/crkey/i],[[d,E+"cast"],[h,P],[u,y]],[/droid.+aft(\w+)( bui|\))/i],[d,[h,_],[u,y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[h,M],[u,y]],[/(bravia[\w ]+)( bui|\))/i],[d,[h,B],[u,y]],[/(mitv-\w{5}) bui/i],[d,[h,N],[u,y]],[/Hbbtv.*(technisat) (.*);/i],[h,d,[u,y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[h,H],[d,H],[u,y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[u,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,d,[u,m]],[/droid.+; (shield) bui/i],[d,[h,"Nvidia"],[u,m]],[/(playstation [345portablevi]+)/i],[d,[h,B],[u,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[h,I],[u,m]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[d,[h,O],[u,w]],[/((pebble))app/i],[h,d,[u,w]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[h,S],[u,w]],[/droid.+; (glass) \d/i],[d,[h,P],[u,w]],[/droid.+; (wt63?0{2,3})\)/i],[d,[h,F],[u,w]],[/droid.+; (glass) \d/i],[d,[h,P],[u,w]],[/(pico) (4|neo3(?: link|pro)?)/i],[h,d,[u,w]],[/; (quest( \d| pro)?)/i],[d,[h,j],[u,w]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[u,b]],[/(aeobc)\b/i],[d,[h,_],[u,b]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[u,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[u,g]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[u,g]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[u,v]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[l,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[l,p],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[l,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[l,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,l]],os:[[/microsoft (windows) (vista|xp)/i],[l,p],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[l,[p,J,Y]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,J,Y],[l,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[l,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,G],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,l],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[l,p],[/\(bb(10);/i],[p,[l,k]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[l,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[l,R+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[l,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[p,[l,"watchOS"]],[/crkey\/([\d\.]+)/i],[p,[l,E+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[l,z],p],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[l,p],[/(sunos) ?([\w\.\d]*)/i],[[l,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[l,p]]},K=function(e,t){if(typeof e===o&&(t=e,e=i),!(this instanceof K))return new K(e,t).getResult();var m=typeof n!==a&&n.navigator?n.navigator:i,y=e||(m&&m.userAgent?m.userAgent:""),w=m&&m.userAgentData?m.userAgentData:i,b=t?function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2==0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n}($,t):$,_=m&&m.userAgent==y;return this.getBrowser=function(){var e={};return e[l]=i,e[p]=i,X.call(e,y,b.browser),e[c]=function(e){return typeof e===s?e.replace(/[^\d\.]/g,"").split(".")[0]:i}(e[p]),_&&m&&m.brave&&typeof m.brave.isBrave==r&&(e[l]="Brave"),e},this.getCPU=function(){var e={};return e[f]=i,X.call(e,y,b.cpu),e},this.getDevice=function(){var e={};return e[h]=i,e[d]=i,e[u]=i,X.call(e,y,b.device),_&&!e[u]&&w&&w.mobile&&(e[u]=v),_&&"Macintosh"==e[d]&&m&&typeof m.standalone!==a&&m.maxTouchPoints&&m.maxTouchPoints>2&&(e[d]="iPad",e[u]=g),e},this.getEngine=function(){var e={};return e[l]=i,e[p]=i,X.call(e,y,b.engine),e},this.getOS=function(){var e={};return e[l]=i,e[p]=i,X.call(e,y,b.os),_&&!e[l]&&w&&w.platform&&"Unknown"!=w.platform&&(e[l]=w.platform.replace(/chrome os/i,z).replace(/macos/i,G)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return y},this.setUA=function(e){return y=typeof e===s&&e.length>500?H(e,500):e,this},this.setUA(y),this};K.VERSION="1.0.40",K.BROWSER=U([l,p,c]),K.CPU=U([f]),K.DEVICE=U([d,h,u,m,v,y,g,w,b]),K.ENGINE=K.OS=U([l,p]),e.exports&&(t=e.exports=K),t.UAParser=K;var q=typeof n!==a&&(n.jQuery||n.Zepto);if(q&&!q.ua){var Q=new K;q.ua=Q.getResult(),q.ua.get=function(){return Q.getUA()},q.ua.set=function(e){Q.setUA(e);var t=Q.getResult();for(var n in t)q.ua[n]=t[n]}}}("object"==typeof window?window:a)}));const On=(new Ln.UAParser).getResult(),Mn={osName:On.os.name||"",osVersion:On.os.version||"",browserName:On.browser.name||"",browserVersion:On.browser.version||""},Bn="WeChat"===On.browser.name;const Nn=(e,t,n,i)=>{const r=t-e,a=i-n;if(r<=0||a<=0)return 0;const o=r/a;return o>1?100:100*o};class Fn{constructor(e,t){this.pc=e,this.emitterId=t,this.intervalTimer=null}startReportStats(){this.intervalTimer=setInterval((()=>{let e,t;this.pc.getStats().then((t=>{e=t})).then((()=>new Promise((e=>{setTimeout(e,2e3)})))).then((()=>this.pc.getStats())).then((n=>{t=n;const i=this.calcStatReport(e,t);var r,a;r=i,a=this.emitterId,st("stats",r,a),Ye.log(`stats: ${qe(i,this.emitterId)}`,this.emitterId)})).catch((e=>{Ye.warning(`pc.getStats error: ${e.toString()}`,this.emitterId)}))}),2e3)}stopReportStats(){this.intervalTimer&&clearInterval(this.intervalTimer)}getRtt(e){if(e)return e.roundTripTime?1e3*e.roundTripTime:e.googRtt?e.googRtt:e.mozRtt?e.mozRtt:void 0}calcStatReport(e,t){const n=d;return t.forEach((i=>{if(!0!==i.isRemote&&("candidate-pair"===i.type&&"succeeded"===i.state&&(t.forEach((e=>{"remote-candidate"===e.type&&e.id===i.remoteCandidateId&&(n.ip=e.ip,n.protocol=e.protocol)})),n.rtt=1e3*i.currentRoundTripTime),"codec"===i.type&&(/^audio\//.test(i.mimeType)?n.audioDecoderName=i.mimeType:/^video\//.test(i.mimeType)&&(n.videoDecoderName=i.mimeType)),"inbound-rtp"===i.type)){if("audio"===i.kind||"audio"===i.mediaType||i.id.toLocaleLowerCase().includes("audio")){const r=e.get(i.id);if(!r)return;const a=i.timestamp-r.timestamp,o=(i.jitterBufferEmittedCount-r.jitterBufferEmittedCount)/a,s=(i.jitterBufferDelay-r.jitterBufferDelay)/a,c=(i.jitterBufferTargetDelay-r.jitterBufferTargetDelay)/a,d=i.totalProcessingDelay?(i.totalProcessingDelay-r.totalProcessingDelay)/a:-1,l=Nn(r.packetsLost,i.packetsLost,r.packetsReceived+r.packetsLost,i.packetsReceived+i.packetsLost);n.audioAvgJitterBufferDelay=o?1e3*s/o:-1,n.audioAvgJitterBufferTargetDelay=o?1e3*c/o:-1,n.audioAvgPacketProcessingDelay=-1!==d&&o?1e3*d/o:-1,n.audioPacketReceived=i.packetsReceived-r.packetsReceived,n.audioPacketLostRate=l,n.audioTotalSamplesReceived=i.totalSamplesReceived,n.audioPacketDiscarded=i.packetsDiscarded-r.packetsDiscarded,n.audioPacketLost=i.packetsLost-r.packetsLost,n.audioBytesReceived=i.bytesReceived-r.bytesReceived,n.audioEstimatedPlayoutTimestamp=i.estimatedPlayoutTimestamp,n.audioLastPacketReceivedTimestamp=i.lastPacketReceivedTimestamp,t.forEach((e=>{if("codec"===e.type&&/^audio\//.test(e.mimeType)){const t=e.clockRate;if(e.sdpFmtpLine){const r=e.sdpFmtpLine.match(/minptime=(\d+)/),a=r?parseInt(r[1]):null;if(n.audioDecoderName=e.mimeType,a)n.audioAvgInterframeDelay=1e3*i.totalSamplesDuration/(i.totalSamplesReceived/(t*a*.001)),n.audioFps=1e3/n.audioAvgInterframeDelay;else if(e.mimeType&&/opus/.test(e.mimeType)){const e=10;n.audioAvgInterframeDelay=1e3*i.totalSamplesDuration/(i.totalSamplesReceived/(t*e*.001)),n.audioFps=1e3/n.audioAvgInterframeDelay}else n.audioAvgInterframeDelay=-1,n.audioFps=-1}else n.audioAvgInterframeDelay=-1,n.audioFps=-1}})),n.audioBitrate=1e6*Qe(8*(i.bytesReceived-r.bytesReceived)/1e3/a,2),n.lastAudioPacketReceivedTimestamp=i.lastPacketReceivedTimestamp,n.timestamp=i.timestamp}if("video"===i.kind||"video"===i.mediaType||i.id.toLocaleLowerCase().includes("video")){const t=e.get(i.id);if(!t)return;const r=i.timestamp-t.timestamp,a=(i.jitterBufferEmittedCount-t.jitterBufferEmittedCount)/r,o=(i.jitterBufferDelay-t.jitterBufferDelay)/r,s=(i.jitterBufferTargetDelay-t.jitterBufferTargetDelay)/r,c=(i.totalProcessingDelay-t.totalProcessingDelay)/r,d=Nn(t.packetsLost,i.packetsLost,t.packetsReceived+t.packetsLost,i.packetsReceived+i.packetsLost);if(n.videoAvgJitterBufferDelay=a?1e3*o/a:-1,n.videoAvgJitterBufferTargetDelay=a?1e3*s/a:-1,n.videoAvgPacketProcessingDelay=a?1e3*c/a:-1,n.videoDroppedFrames=i.framesDropped-t.framesDropped,n.videoPacketReceived=i.packetsReceived-t.packetsReceived,n.videoPacketLost=i.packetsLost-t.packetsLost,n.videoPacketLostRate=d,n.videoNackCount=i.nackCount-t.nackCount,n.videoFirCount=i.firCount-t.firCount,n.videoPliCount=i.pliCount-t.pliCount,n.videoFrameDecoded=i.framesDecoded-t.framesDecoded,n.videoFrameReceived=i.framesReceived-t.framesReceived,n.videoDecodeCostMs=1e3*(i.totalDecodeTime-t.totalDecodeTime)/n.videoFrameDecoded,n.videoKeyFramesDecoded=i.keyFramesDecoded-t.keyFramesDecoded,n.videoBytesReceived=i.bytesReceived-t.bytesReceived,n.videoTotalFreezesDuration=i.totalFreezesDuration-t.totalFreezesDuration,n.videoFecPacketReceived=i.fecPacketsReceived-t.fecPacketsReceived,n.videoAvgInterframeDelay=1e3*i.totalInterFrameDelay/i.framesDecoded,n.videoEstimatedPlayoutTimestamp=i.estimatedPlayoutTimestamp,n.videoLastPacketReceivedTimestamp=i.lastPacketReceivedTimestamp,n.videoBitrate=1e6*Qe(8*(i.bytesReceived-t.bytesReceived)/1e3/r,2),n.lastVideoPacketReceivedTimestamp=i.lastPacketReceivedTimestamp,n.timestamp=i.timestamp,i.frameWidth?(n.videoFrameWidth=i.frameWidth,n.videoFrameHeight=i.frameHeight):this.pc.getReceivers().forEach((e=>{"video"===e.track.kind&&(n.videoFrameWidth=e.track.getSettings().width||0,n.videoFrameHeight=e.track.getSettings().height||0)})),i.framesPerSecond)n.videoFps=i.framesPerSecond;else if(i.framesDecoded&&t.framesDecoded){const e=i.framesDecoded-t.framesDecoded,r=(i.timestamp-t.timestamp)/1e3;n.videoFps=Math.floor(e/r)}}}})),n}}class jn{static isValid(e){try{return new URL(e),!0}catch(e){return!1}}constructor(e,t,n){this.url=e,this.emitterId=t,this.jitterBuffer=n,this.disposers=[],this.timer=null,this.pc=this.initPc()}listen(e,t){this.pc.addEventListener(e,t),this.addDisposer((()=>this.pc.removeEventListener(e,t)))}addDisposer(e){this.disposers.push(e)}dispose(){var e,t;this.disposers.forEach((e=>e())),this.disposers=[],null===(e=this.videoTrack)||void 0===e||e.stop(),null===(t=this.audioTrack)||void 0===t||t.stop(),this.timer&&clearTimeout(this.timer),this.pc.close()}connect(e){return n(this,void 0,void 0,(function*(){this.logEvents();const t=new MediaStream;this.listen("track",(n=>{if("video"===n.track.kind&&!e||"audio"===n.track.kind){switch(n.track.kind){case"video":this.videoTrack=n.track;break;case"audio":this.audioTrack=n.track}t.addTrack(n.track),Ye.log(`media stream added ${n.track.kind} track, id: ${n.track.id}`,this.emitterId)}})),yield Promise.all([this.waitPcConnected(),this.negotiate()]);const n=this.pc.getReceivers();for(let e of n)void 0!==e.jitterBufferTarget&&(e.jitterBufferTarget=this.jitterBuffer);const i=new Fn(this.pc,this.emitterId);return i.startReportStats(),this.addDisposer((()=>i.stopReportStats())),t}))}logEvents(){this.listen("negotiationneeded",(()=>{Ye.debug("pc.onnegotiationneeded",this.emitterId)})),this.listen("icecandidate",(e=>{Ye.debug("pc.onicecandidate: "+qe(e.candidate,this.emitterId),this.emitterId)})),this.listen("iceconnectionstatechange",(()=>{Ye.debug("pc.oniceconnectionstatechange: "+this.pc.iceConnectionState,this.emitterId)})),this.listen("icegatheringstatechange",(()=>{Ye.debug("pc.onicegatheringstatechange : "+this.pc.iceGatheringState,this.emitterId)})),this.listen("signalingstatechange",(()=>{Ye.debug("pc.onsignalingstatechange: "+this.pc.signalingState,this.emitterId)})),this.listen("connectionstatechange",(()=>{Ye.debug("pc.onconnectionstatechange: "+this.pc.connectionState,this.emitterId)})),this.listen("track",(e=>{Ye.debug(`pc.ontrack: ${e.track.kind}, id: ${e.track.id}`,this.emitterId)}))}waitPcConnected(){const e="connectionState"in this.pc,t=e?"connectionstatechange":"iceconnectionstatechange",n=e?"peer connection":"peer connection ice";return new Promise(((i,r)=>{this.listen(t,(()=>{this.timer&&clearTimeout(this.timer);let t=e?this.pc.connectionState:this.pc.iceConnectionState;"connected"===t?(Ye.log(`${n} is connected.`,this.emitterId),i()):"disconnected"===t?(Ye.warning(`${n} reconnecting`,this.emitterId),this.timer=setTimeout((()=>{"disconnected"===(e?this.pc.connectionState:this.pc.iceConnectionState)&&(Ye.warning(`${n} reconnect timeout`,this.emitterId),mt(`${n} reconnect timeout`,this.emitterId),r(new lt(`${n} reconnect timeout`)))}),5e3)):"failed"===t?(Ye.warning(`${n} failed`,this.emitterId),mt(`${n} state error: `+t,this.emitterId),r(new lt(`${n} state error: `+t))):"closed"===t&&(Ye.error(`${n} closed.`,this.emitterId),r(new lt(`${n} closed.`)))}))}))}}class zn extends jn{constructor(){super(...arguments),this.protocol="WHEP",this.sessionId=void 0,this.ips=[]}static isValid(e){const t=new URL(e);t.search="",t.hash="";const n=t.toString();return/(whep\/)$/.test(n)||/(.whep)$/.test(n)}getSessionId(){return this.sessionId}getIps(){return this.ips}initPc(){const e=new RTCPeerConnection({bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",iceTransportPolicy:"all"});return e.addTransceiver("video",{direction:"recvonly"}),e.addTransceiver("audio",{direction:"recvonly"}),e}negotiate(){return n(this,void 0,void 0,(function*(){const e=yield this.pc.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});Ye.debug(`whep client offer sdp:\n${e.sdp}`,this.emitterId);try{yield this.pc.setLocalDescription(e)}catch(t){const n="set local sdp error: \n"+e.sdp+"\n"+qe(t,this.emitterId);throw ft(n,this.emitterId),new lt(n)}Ye.log("peer connection set local sdp ok.",this.emitterId);const{answer:t,location:i,sessionId:r,ips:a}=yield function(e,t,i){return n(this,void 0,void 0,(function*(){const n={method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/sdp"},body:t};let r=null;"AbortController"in window&&(r=new AbortController,n.signal=r.signal);let a=Promise.race([fetch(e,n),tt(v,"fetchSdpAnswer")]).catch((e=>{let t;throw e instanceof et?(null==r||r.abort(),t="fetchSdpAnswer timeout: 8s"):t=`fetchSdpAnswer error: ${e.message}`,ut(t,i),new lt(t)}));const o=yield a;if(201===o.status){const e=yield o.text(),t=o.headers.get("Location");return{answer:e,location:t,sessionId:new URLSearchParams(t).get("whep-session"),ips:it(e)}}const s=yield o.text();if(500===o.status){const e=s||"Stream not exist or not online";throw ht(e,i),new lt(e)}const c=`Unexpected response code: ${o.status}, msg: ${s}`;throw pt(c,i),new lt(c)}))}(this.url,e.sdp,this.emitterId);this.sessionId=null!=r?r:void 0,this.ips=a,Ye.debug(`whep client answer sdp:\n${t}`,this.emitterId),Ye.debug(`whep client answer location:\n${i}`,this.emitterId);try{yield this.pc.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:t}))}catch(e){const n="set remote sdp error: \n"+t+"\n"+qe(e,this.emitterId);throw ft(n,this.emitterId),new lt(n)}Ye.log("peer connection set remote sdp ok.",this.emitterId);const o=i||this.url;this.addDisposer((()=>{!function(e,t){n(this,void 0,void 0,(function*(){try{const n=yield fetch(e,{method:"DELETE",mode:"cors",credentials:"omit"});n.status>=200&&n.status<300?Ye.log("Disconnect stream succeed, endpoint: "+e,t):Ye.warning("Disconnect stream failed with status code "+n.status,t)}catch(e){e instanceof Error&&Ye.warning("Disconnect stream failed: "+e.message,t)}}))}(o,this.emitterId)}))}))}}const Gn=/[a-zA-Z0-9]{3,7}:\/\/([^/]+)\//;class Vn extends jn{constructor(){super(...arguments),this.protocol="PiliSRT",this.sessionId=void 0,this.ips=[]}static isValid(e){return Gn.test(e)}initPc(){return new RTCPeerConnection}getSessionId(){return this.sessionId}getIps(){return this.ips}negotiate(){return n(this,void 0,void 0,(function*(){let e;try{e=function(e){const t=Gn.exec(e);if(!t)throw new Error("streamUrl invalid");const n=t[1];let i=location.protocol;"https:"!==i&&"http:"!==i&&(i="http:");return`${i}//${n}${f}`}(this.url)}catch(e){throw Ye.error(`stream url is invalid: ${this.url}`,this.emitterId),new lt("stream url is invalid")}let t=yield this.pc.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});Ye.debug(`local offer: \n${t.sdp}`,this.emitterId),t=this.mungSDP(t);try{yield this.pc.setLocalDescription(t)}catch(e){const n="set local sdp error: \n"+t.sdp+"\n"+qe(e,this.emitterId);throw ft(n,this.emitterId),new lt(n)}Ye.log("peer connection set local sdp ok.",this.emitterId);const i=yield function(e,t,i,r){return n(this,void 0,void 0,(function*(){const n={streamurl:t,clientip:JSON.stringify(Object.assign(Object.assign({},Mn),{SDK_VERSION:g})),sdp:i},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)};let o=null;"AbortController"in window&&(o=new AbortController,a.signal=o.signal);let s=Promise.race([fetch(e,a),tt(v,"pullStreamRequest")]).catch((e=>{let t;throw e instanceof et?(null==o||o.abort(),t="pullStreamRequest timeout: 8s"):t=`pullStreamRequest error: ${e.message}`,ut(t,r),new lt(t)}));const c=yield s;if(200!==c.status){const e=`pullStreamRequest, statusCode error: statusCode: ${c.status}, statusText: ${c.statusText}`;throw ut(e,r),new lt(e)}let d;try{d=yield c.json()}catch(e){const t=`parse response as json error: ${c.text()}`;throw pt(t,r),new lt(t)}if([400,500].includes(d.code))throw pt(d.msg,r),new lt(d.msg);if(403===d.code)throw((e,t)=>{dt({code:20002,errorType:"authFailed",msg:e},t),Ye.fatal(e,t)})(d.msg,r),new lt(d.msg);if(404===d.code)throw ht(d.msg,r),new lt(d.msg);if(![0,200].includes(d.code)){const e=`unexpected code: ${d.code}, msg: ${d.msg}`;throw pt(e,r),new lt(e)}return d}))}(e,this.url,t.sdp,this.emitterId);Ye.debug(`remote answer, \n${i.sdp}`,this.emitterId);const r=new RTCSessionDescription({type:"answer",sdp:i.sdp});try{yield this.pc.setRemoteDescription(r)}catch(e){const t="set remote sdp error: \n"+r.sdp+"\n"+qe(e,this.emitterId);throw ft(t,this.emitterId),new lt(t)}Ye.log("peer connection set remote sdp ok.",this.emitterId),this.sessionId=i.sessionid,this.ips=it(i.sdp)}))}mungSDP(e){return e}}let Un=0;class Wn{constructor(e=""){this.playerEmitterId=e,this.connectTask=null,this.JitterBuffer=null}getSessionId(){return this.connectTask instanceof Vn||this.connectTask instanceof zn?this.connectTask.getSessionId():void 0}getIps(){return this.connectTask instanceof Vn||this.connectTask instanceof zn?this.connectTask.getIps():void 0}recycleClosedPC(){if(Un<100)return;Un=0;let e=document.createElement("img");e.src=window.URL.createObjectURL(new Blob([new ArrayBuffer(1e8)])),e.onerror=function(){window.URL.revokeObjectURL(this.src),e=null}}release(){var e;null===(e=this.connectTask)||void 0===e||e.dispose(),this.connectTask=null,this.recycleClosedPC()}setJitterBuffer(e){this.JitterBuffer=e}pullStream(e,t){if(this.release(),this.connectTask=function(e,t,n){return zn.isValid(e)?new zn(e,t,n):Vn.isValid(e)?new Vn(e,t,n):null}(e,this.playerEmitterId,this.JitterBuffer),!this.connectTask)throw Ye.error(`stream url is invalid: ${e}`,this.playerEmitterId),new lt("stream url invalid");return Un++,this.connectTask.connect(t)}}var Zn=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Hn=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},Xn=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},Jn=function(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"},Yn=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},$n=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},Kn=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,qn=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],Qn=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ei(e){return e?ti(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new $n:"undefined"!=typeof navigator?ti(navigator.userAgent):"undefined"!=typeof process&&process.version?new Xn(process.version.slice(1)):null}function ti(e){var t=function(e){return""!==e&&qn.reduce((function(t,n){var i=n[0],r=n[1];if(t)return t;var a=r.exec(e);return!!a&&[i,a]}),!1)}(e);if(!t)return null;var n=t[0],i=t[1];if("searchbot"===n)return new Yn;var r=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);r?r.length<3&&(r=Zn(Zn([],r,!0),function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(3-r.length),!0)):r=[];var a=r.join("."),o=function(e){for(var t=0,n=Qn.length;t<n;t++){var i=Qn[t],r=i[0];if(i[1].exec(e))return r}return null}(e),s=Kn.exec(e);return s&&s[1]?new Jn(n,a,o,s[1]):new Hn(n,a,o)}var ni=o((function(e){var t,n;t=a,n=function(){void 0===Array.isArray&&(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var e=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]},t=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]},n=function(e,t){return 32==(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])},i=function(e,t){return 0==(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]},r=function(e,t){return[e[0]^t[0],e[1]^t[1]]},a=function(e){return e=r(e,[0,e[0]>>>1]),e=t(e,[4283543511,3981806797]),e=r(e,[0,e[0]>>>1]),e=t(e,[3301882366,444984403]),e=r(e,[0,e[0]>>>1])},o=function(o,s){s=s||0;for(var c=(o=o||"").length%16,d=o.length-c,l=[0,s],u=[0,s],h=[0,0],p=[0,0],f=[2277735313,289559509],m=[1291169091,658871167],v=0;v<d;v+=16)h=[255&o.charCodeAt(v+4)|(255&o.charCodeAt(v+5))<<8|(255&o.charCodeAt(v+6))<<16|(255&o.charCodeAt(v+7))<<24,255&o.charCodeAt(v)|(255&o.charCodeAt(v+1))<<8|(255&o.charCodeAt(v+2))<<16|(255&o.charCodeAt(v+3))<<24],p=[255&o.charCodeAt(v+12)|(255&o.charCodeAt(v+13))<<8|(255&o.charCodeAt(v+14))<<16|(255&o.charCodeAt(v+15))<<24,255&o.charCodeAt(v+8)|(255&o.charCodeAt(v+9))<<8|(255&o.charCodeAt(v+10))<<16|(255&o.charCodeAt(v+11))<<24],h=t(h,f),h=n(h,31),h=t(h,m),l=r(l,h),l=n(l,27),l=e(l,u),l=e(t(l,[0,5]),[0,1390208809]),p=t(p,m),p=n(p,33),p=t(p,f),u=r(u,p),u=n(u,31),u=e(u,l),u=e(t(u,[0,5]),[0,944331445]);switch(h=[0,0],p=[0,0],c){case 15:p=r(p,i([0,o.charCodeAt(v+14)],48));case 14:p=r(p,i([0,o.charCodeAt(v+13)],40));case 13:p=r(p,i([0,o.charCodeAt(v+12)],32));case 12:p=r(p,i([0,o.charCodeAt(v+11)],24));case 11:p=r(p,i([0,o.charCodeAt(v+10)],16));case 10:p=r(p,i([0,o.charCodeAt(v+9)],8));case 9:p=r(p,[0,o.charCodeAt(v+8)]),p=t(p,m),p=n(p,33),p=t(p,f),u=r(u,p);case 8:h=r(h,i([0,o.charCodeAt(v+7)],56));case 7:h=r(h,i([0,o.charCodeAt(v+6)],48));case 6:h=r(h,i([0,o.charCodeAt(v+5)],40));case 5:h=r(h,i([0,o.charCodeAt(v+4)],32));case 4:h=r(h,i([0,o.charCodeAt(v+3)],24));case 3:h=r(h,i([0,o.charCodeAt(v+2)],16));case 2:h=r(h,i([0,o.charCodeAt(v+1)],8));case 1:h=r(h,[0,o.charCodeAt(v)]),h=t(h,f),h=n(h,31),h=t(h,m),l=r(l,h)}return l=r(l,[0,o.length]),u=r(u,[0,o.length]),l=e(l,u),u=e(u,l),l=a(l),u=a(u),l=e(l,u),u=e(u,l),("00000000"+(l[0]>>>0).toString(16)).slice(-8)+("00000000"+(l[1]>>>0).toString(16)).slice(-8)+("00000000"+(u[0]>>>0).toString(16)).slice(-8)+("00000000"+(u[1]>>>0).toString(16)).slice(-8)},s={preprocessor:null,audio:{timeout:1e3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0,adBlock:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},c=function(e,t){if(Array.prototype.forEach&&e.forEach===Array.prototype.forEach)e.forEach(t);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t(e[n],n,e);else for(var r in e)e.hasOwnProperty(r)&&t(e[r],r,e)},d=function(e,t){var n=[];return null==e?n:Array.prototype.map&&e.map===Array.prototype.map?e.map(t):(c(e,(function(e,i,r){n.push(t(e,i,r))})),n)},l=function(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices},u=function(e){var t=[window.screen.width,window.screen.height];return e.screen.detectScreenOrientation&&t.sort().reverse(),t},h=function(e){if(window.screen.availWidth&&window.screen.availHeight){var t=[window.screen.availHeight,window.screen.availWidth];return e.screen.detectScreenOrientation&&t.sort().reverse(),t}return e.NOT_AVAILABLE},p=function(e){if(null==navigator.plugins)return e.NOT_AVAILABLE;for(var t=[],n=0,i=navigator.plugins.length;n<i;n++)navigator.plugins[n]&&t.push(navigator.plugins[n]);return m(e)&&(t=t.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}))),d(t,(function(e){var t=d(e,(function(e){return[e.type,e.suffixes]}));return[e.name,e.description,t]}))},f=function(e){var t=[];return Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window?t=d(["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","MacromediaFlashPaper.MacromediaFlashPaper","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","ShockwaveFlash.ShockwaveFlash","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"],(function(t){try{return new window.ActiveXObject(t),t}catch(t){return e.ERROR}})):t.push(e.NOT_AVAILABLE),navigator.plugins&&(t=t.concat(p(e))),t},m=function(e){for(var t=!1,n=0,i=e.plugins.sortPluginsFor.length;n<i;n++){var r=e.plugins.sortPluginsFor[n];if(navigator.userAgent.match(r)){t=!0;break}}return t},v=function(e){try{return!!window.sessionStorage}catch(t){return e.ERROR}},g=function(e){try{return!!window.localStorage}catch(t){return e.ERROR}},y=function(e){if(M())return e.EXCLUDED;try{return!!window.indexedDB}catch(t){return e.ERROR}},w=function(e){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:e.NOT_AVAILABLE},b=function(e){return navigator.cpuClass||e.NOT_AVAILABLE},_=function(e){return navigator.platform?navigator.platform:e.NOT_AVAILABLE},S=function(e){return navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:e.NOT_AVAILABLE},T=function(){var e,t=0;void 0!==navigator.maxTouchPoints?t=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(t=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),e=!0}catch(t){e=!1}return[t,e,"ontouchstart"in window]},k=function(e){var t=[],n=document.createElement("canvas");n.width=2e3,n.height=200,n.style.display="inline";var i=n.getContext("2d");return i.rect(0,0,10,10),i.rect(2,2,6,6),t.push("canvas winding:"+(!1===i.isPointInPath(5,5,"evenodd")?"yes":"no")),i.textBaseline="alphabetic",i.fillStyle="#f60",i.fillRect(125,1,62,20),i.fillStyle="#069",e.dontUseFakeFontInCanvas?i.font="11pt Arial":i.font="11pt no-real-font-123",i.fillText("Cwm fjordbank glyphs vext quiz, 😃",2,15),i.fillStyle="rgba(102, 204, 0, 0.2)",i.font="18pt Arial",i.fillText("Cwm fjordbank glyphs vext quiz, 😃",4,45),i.globalCompositeOperation="multiply",i.fillStyle="rgb(255,0,255)",i.beginPath(),i.arc(50,50,50,0,2*Math.PI,!0),i.closePath(),i.fill(),i.fillStyle="rgb(0,255,255)",i.beginPath(),i.arc(100,50,50,0,2*Math.PI,!0),i.closePath(),i.fill(),i.fillStyle="rgb(255,255,0)",i.beginPath(),i.arc(75,100,50,0,2*Math.PI,!0),i.closePath(),i.fill(),i.fillStyle="rgb(255,0,255)",i.arc(75,75,75,0,2*Math.PI,!0),i.arc(75,75,25,0,2*Math.PI,!0),i.fill("evenodd"),n.toDataURL&&t.push("canvas fp:"+n.toDataURL()),t},C=function(){var e,t=function(t){return e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),"["+t[0]+", "+t[1]+"]"};if(!(e=j()))return null;var n=[],i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i);var r=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),i.itemSize=3,i.numItems=3;var a=e.createProgram(),o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}"),e.compileShader(o);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}"),e.compileShader(s),e.attachShader(a,o),e.attachShader(a,s),e.linkProgram(a),e.useProgram(a),a.vertexPosAttrib=e.getAttribLocation(a,"attrVertex"),a.offsetUniform=e.getUniformLocation(a,"uniformOffset"),e.enableVertexAttribArray(a.vertexPosArray),e.vertexAttribPointer(a.vertexPosAttrib,i.itemSize,e.FLOAT,!1,0,0),e.uniform2f(a.offsetUniform,1,1),e.drawArrays(e.TRIANGLE_STRIP,0,i.numItems);try{n.push(e.canvas.toDataURL())}catch(e){}n.push("extensions:"+(e.getSupportedExtensions()||[]).join(";")),n.push("webgl aliased line width range:"+t(e.getParameter(e.ALIASED_LINE_WIDTH_RANGE))),n.push("webgl aliased point size range:"+t(e.getParameter(e.ALIASED_POINT_SIZE_RANGE))),n.push("webgl alpha bits:"+e.getParameter(e.ALPHA_BITS)),n.push("webgl antialiasing:"+(e.getContextAttributes().antialias?"yes":"no")),n.push("webgl blue bits:"+e.getParameter(e.BLUE_BITS)),n.push("webgl depth bits:"+e.getParameter(e.DEPTH_BITS)),n.push("webgl green bits:"+e.getParameter(e.GREEN_BITS)),n.push("webgl max anisotropy:"+function(e){var t=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic");if(t){var n=e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return 0===n&&(n=2),n}return null}(e)),n.push("webgl max combined texture image units:"+e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),n.push("webgl max cube map texture size:"+e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE)),n.push("webgl max fragment uniform vectors:"+e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS)),n.push("webgl max render buffer size:"+e.getParameter(e.MAX_RENDERBUFFER_SIZE)),n.push("webgl max texture image units:"+e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),n.push("webgl max texture size:"+e.getParameter(e.MAX_TEXTURE_SIZE)),n.push("webgl max varying vectors:"+e.getParameter(e.MAX_VARYING_VECTORS)),n.push("webgl max vertex attribs:"+e.getParameter(e.MAX_VERTEX_ATTRIBS)),n.push("webgl max vertex texture image units:"+e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),n.push("webgl max vertex uniform vectors:"+e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS)),n.push("webgl max viewport dims:"+t(e.getParameter(e.MAX_VIEWPORT_DIMS))),n.push("webgl red bits:"+e.getParameter(e.RED_BITS)),n.push("webgl renderer:"+e.getParameter(e.RENDERER)),n.push("webgl shading language version:"+e.getParameter(e.SHADING_LANGUAGE_VERSION)),n.push("webgl stencil bits:"+e.getParameter(e.STENCIL_BITS)),n.push("webgl vendor:"+e.getParameter(e.VENDOR)),n.push("webgl version:"+e.getParameter(e.VERSION));try{var d=e.getExtension("WEBGL_debug_renderer_info");d&&(n.push("webgl unmasked vendor:"+e.getParameter(d.UNMASKED_VENDOR_WEBGL)),n.push("webgl unmasked renderer:"+e.getParameter(d.UNMASKED_RENDERER_WEBGL)))}catch(e){}return e.getShaderPrecisionFormat?(c(["FLOAT","INT"],(function(t){c(["VERTEX","FRAGMENT"],(function(i){c(["HIGH","MEDIUM","LOW"],(function(r){c(["precision","rangeMin","rangeMax"],(function(a){var o=e.getShaderPrecisionFormat(e[i+"_SHADER"],e[r+"_"+t])[a];"precision"!==a&&(a="precision "+a);var s=["webgl ",i.toLowerCase()," shader ",r.toLowerCase()," ",t.toLowerCase()," ",a,":",o].join("");n.push(s)}))}))}))})),z(e),n):(z(e),n)},E=function(){try{var e=j(),t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t.UNMASKED_VENDOR_WEBGL)+"~"+e.getParameter(t.UNMASKED_RENDERER_WEBGL);return z(e),n}catch(e){return null}},R=function(){var e=document.createElement("div");e.innerHTML="&nbsp;",e.className="adsbox";var t=!1;try{document.body.appendChild(e),t=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(e)}catch(e){t=!1}return t},P=function(){if(void 0!==navigator.languages)try{if(navigator.languages[0].substr(0,2)!==navigator.language.substr(0,2))return!0}catch(e){return!0}return!1},x=function(){return window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight},A=function(){var e,t=navigator.userAgent.toLowerCase(),n=navigator.oscpu,i=navigator.platform.toLowerCase();if(e=t.indexOf("windows phone")>=0?"Windows Phone":t.indexOf("windows")>=0||t.indexOf("win16")>=0||t.indexOf("win32")>=0||t.indexOf("win64")>=0||t.indexOf("win95")>=0||t.indexOf("win98")>=0||t.indexOf("winnt")>=0||t.indexOf("wow64")>=0?"Windows":t.indexOf("android")>=0?"Android":t.indexOf("linux")>=0||t.indexOf("cros")>=0||t.indexOf("x11")>=0?"Linux":t.indexOf("iphone")>=0||t.indexOf("ipad")>=0||t.indexOf("ipod")>=0||t.indexOf("crios")>=0||t.indexOf("fxios")>=0?"iOS":t.indexOf("macintosh")>=0||t.indexOf("mac_powerpc)")>=0?"Mac":"Other",("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&"Windows"!==e&&"Windows Phone"!==e&&"Android"!==e&&"iOS"!==e&&"Other"!==e&&-1===t.indexOf("cros"))return!0;if(void 0!==n){if((n=n.toLowerCase()).indexOf("win")>=0&&"Windows"!==e&&"Windows Phone"!==e)return!0;if(n.indexOf("linux")>=0&&"Linux"!==e&&"Android"!==e)return!0;if(n.indexOf("mac")>=0&&"Mac"!==e&&"iOS"!==e)return!0;if((-1===n.indexOf("win")&&-1===n.indexOf("linux")&&-1===n.indexOf("mac"))!=("Other"===e))return!0}return i.indexOf("win")>=0&&"Windows"!==e&&"Windows Phone"!==e||(i.indexOf("linux")>=0||i.indexOf("android")>=0||i.indexOf("pike")>=0)&&"Linux"!==e&&"Android"!==e||(i.indexOf("mac")>=0||i.indexOf("ipad")>=0||i.indexOf("ipod")>=0||i.indexOf("iphone")>=0)&&"Mac"!==e&&"iOS"!==e||!(i.indexOf("arm")>=0&&"Windows Phone"===e)&&!(i.indexOf("pike")>=0&&t.indexOf("opera mini")>=0)&&((i.indexOf("win")<0&&i.indexOf("linux")<0&&i.indexOf("mac")<0&&i.indexOf("iphone")<0&&i.indexOf("ipad")<0&&i.indexOf("ipod")<0)!=("Other"===e)||void 0===navigator.plugins&&"Windows"!==e&&"Windows Phone"!==e)},I=function(){var e,t=navigator.userAgent.toLowerCase(),n=navigator.productSub;if(t.indexOf("edge/")>=0||t.indexOf("iemobile/")>=0)return!1;if(t.indexOf("opera mini")>=0)return!1;if(("Chrome"==(e=t.indexOf("firefox/")>=0?"Firefox":t.indexOf("opera/")>=0||t.indexOf(" opr/")>=0?"Opera":t.indexOf("chrome/")>=0?"Chrome":t.indexOf("safari/")>=0?t.indexOf("android 1.")>=0||t.indexOf("android 2.")>=0||t.indexOf("android 3.")>=0||t.indexOf("android 4.")>=0?"AOSP":"Safari":t.indexOf("trident/")>=0?"Internet Explorer":"Other")||"Safari"===e||"Opera"===e)&&"20030107"!==n)return!0;var i,r=eval.toString().length;if(37===r&&"Safari"!==e&&"Firefox"!==e&&"Other"!==e)return!0;if(39===r&&"Internet Explorer"!==e&&"Other"!==e)return!0;if(33===r&&"Chrome"!==e&&"AOSP"!==e&&"Opera"!==e&&"Other"!==e)return!0;try{throw"a"}catch(e){try{e.toSource(),i=!0}catch(e){i=!1}}return i&&"Firefox"!==e&&"Other"!==e},D=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},L=function(){if(!D())return!1;var e=j(),t=!!window.WebGLRenderingContext&&!!e;return z(e),t},O=function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},M=function(){return("msWriteProfilerMark"in window)+("msLaunchUri"in navigator)+("msSaveBlob"in navigator)>=2},B=function(){return void 0!==window.swfobject},N=function(){return window.swfobject.hasFlashPlayerVersion("9.0.0")},F=function(e,t){var n="___fp_swf_loaded";window[n]=function(t){e(t)};var i=t.fonts.swfContainerId;!function(e){var t=document.createElement("div");t.setAttribute("id",e.fonts.swfContainerId),document.body.appendChild(t)}();var r={onReady:n};window.swfobject.embedSWF(t.fonts.swfPath,i,"1","1","9.0.0",!1,r,{allowScriptAccess:"always",menu:"false"},{})},j=function(){var e=document.createElement("canvas"),t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(e){}return t||(t=null),t},z=function(e){var t=e.getExtension("WEBGL_lose_context");null!=t&&t.loseContext()},G=[{key:"userAgent",getData:function(e){e(navigator.userAgent)}},{key:"webdriver",getData:function(e,t){e(null==navigator.webdriver?t.NOT_AVAILABLE:navigator.webdriver)}},{key:"language",getData:function(e,t){e(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||t.NOT_AVAILABLE)}},{key:"colorDepth",getData:function(e,t){e(window.screen.colorDepth||t.NOT_AVAILABLE)}},{key:"deviceMemory",getData:function(e,t){e(navigator.deviceMemory||t.NOT_AVAILABLE)}},{key:"pixelRatio",getData:function(e,t){e(window.devicePixelRatio||t.NOT_AVAILABLE)}},{key:"hardwareConcurrency",getData:function(e,t){e(w(t))}},{key:"screenResolution",getData:function(e,t){e(u(t))}},{key:"availableScreenResolution",getData:function(e,t){e(h(t))}},{key:"timezoneOffset",getData:function(e){e((new Date).getTimezoneOffset())}},{key:"timezone",getData:function(e,t){window.Intl&&window.Intl.DateTimeFormat?e((new window.Intl.DateTimeFormat).resolvedOptions().timeZone||t.NOT_AVAILABLE):e(t.NOT_AVAILABLE)}},{key:"sessionStorage",getData:function(e,t){e(v(t))}},{key:"localStorage",getData:function(e,t){e(g(t))}},{key:"indexedDb",getData:function(e,t){e(y(t))}},{key:"addBehavior",getData:function(e){e(!!window.HTMLElement.prototype.addBehavior)}},{key:"openDatabase",getData:function(e){e(!!window.openDatabase)}},{key:"cpuClass",getData:function(e,t){e(b(t))}},{key:"platform",getData:function(e,t){e(_(t))}},{key:"doNotTrack",getData:function(e,t){e(S(t))}},{key:"plugins",getData:function(e,t){O()?t.plugins.excludeIE?e(t.EXCLUDED):e(f(t)):e(p(t))}},{key:"canvas",getData:function(e,t){D()?e(k(t)):e(t.NOT_AVAILABLE)}},{key:"webgl",getData:function(e,t){L()?e(C()):e(t.NOT_AVAILABLE)}},{key:"webglVendorAndRenderer",getData:function(e){L()?e(E()):e()}},{key:"adBlock",getData:function(e){e(R())}},{key:"hasLiedLanguages",getData:function(e){e(P())}},{key:"hasLiedResolution",getData:function(e){e(x())}},{key:"hasLiedOs",getData:function(e){e(A())}},{key:"hasLiedBrowser",getData:function(e){e(I())}},{key:"touchSupport",getData:function(e){e(T())}},{key:"fonts",getData:function(e,t){var n=["monospace","sans-serif","serif"],i=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"];t.fonts.extendedJsFonts&&(i=i.concat(["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"])),i=(i=i.concat(t.fonts.userDefinedFonts)).filter((function(e,t){return i.indexOf(e)===t}));var r=document.getElementsByTagName("body")[0],a=document.createElement("div"),o=document.createElement("div"),s={},c={},d=function(){var e=document.createElement("span");return e.style.position="absolute",e.style.left="-9999px",e.style.fontSize="72px",e.style.fontStyle="normal",e.style.fontWeight="normal",e.style.letterSpacing="normal",e.style.lineBreak="auto",e.style.lineHeight="normal",e.style.textTransform="none",e.style.textAlign="left",e.style.textDecoration="none",e.style.textShadow="none",e.style.whiteSpace="normal",e.style.wordBreak="normal",e.style.wordSpacing="normal",e.innerHTML="mmmmmmmmmmlli",e},l=function(e,t){var n=d();return n.style.fontFamily="'"+e+"',"+t,n},u=function(e){for(var t=!1,i=0;i<n.length;i++)if(t=e[i].offsetWidth!==s[n[i]]||e[i].offsetHeight!==c[n[i]])return t;return t},h=function(){for(var e=[],t=0,i=n.length;t<i;t++){var r=d();r.style.fontFamily=n[t],a.appendChild(r),e.push(r)}return e}();r.appendChild(a);for(var p=0,f=n.length;p<f;p++)s[n[p]]=h[p].offsetWidth,c[n[p]]=h[p].offsetHeight;var m=function(){for(var e={},t=0,r=i.length;t<r;t++){for(var a=[],s=0,c=n.length;s<c;s++){var d=l(i[t],n[s]);o.appendChild(d),a.push(d)}e[i[t]]=a}return e}();r.appendChild(o);for(var v=[],g=0,y=i.length;g<y;g++)u(m[i[g]])&&v.push(i[g]);r.removeChild(o),r.removeChild(a),e(v)},pauseBefore:!0},{key:"fontsFlash",getData:function(e,t){return B()?N()?t.fonts.swfPath?void F((function(t){e(t)}),t):e("missing options.fonts.swfPath"):e("flash not installed"):e("swf object not loaded")},pauseBefore:!0},{key:"audio",getData:function(e,t){var n=t.audio;if(n.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return e(t.EXCLUDED);var i=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(null==i)return e(t.NOT_AVAILABLE);var r=new i(1,44100,44100),a=r.createOscillator();a.type="triangle",a.frequency.setValueAtTime(1e4,r.currentTime);var o=r.createDynamicsCompressor();c([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],(function(e){void 0!==o[e[0]]&&"function"==typeof o[e[0]].setValueAtTime&&o[e[0]].setValueAtTime(e[1],r.currentTime)})),a.connect(o),o.connect(r.destination),a.start(0),r.startRendering();var s=setTimeout((function(){return console.warn('Audio fingerprint timed out. Please report bug at https://github.com/fingerprintjs/fingerprintjs with your user agent: "'+navigator.userAgent+'".'),r.oncomplete=function(){},r=null,e("audioTimeout")}),n.timeout);r.oncomplete=function(t){var n;try{clearTimeout(s),n=t.renderedBuffer.getChannelData(0).slice(4500,5e3).reduce((function(e,t){return e+Math.abs(t)}),0).toString(),a.disconnect(),o.disconnect()}catch(t){return void e(t)}e(n)}}},{key:"enumerateDevices",getData:function(e,t){if(!l())return e(t.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then((function(t){e(t.map((function(e){return"id="+e.deviceId+";gid="+e.groupId+";"+e.kind+";"+e.label})))})).catch((function(t){e(t)}))}}],V=function(e){throw new Error("'new Fingerprint()' is deprecated, see https://github.com/fingerprintjs/fingerprintjs#upgrade-guide-from-182-to-200")};return V.get=function(e,t){t?e||(e={}):(t=e,e={}),function(e,t){if(null==t)return e;var n,i;for(i in t)null==(n=t[i])||Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n)}(e,s),e.components=e.extraComponents.concat(G);var n={data:[],addPreprocessedComponent:function(t,i){"function"==typeof e.preprocessor&&(i=e.preprocessor(t,i)),n.data.push({key:t,value:i})}},i=-1,r=function(a){if((i+=1)>=e.components.length)t(n.data);else{var o=e.components[i];if(e.excludes[o.key])r(!1);else{if(!a&&o.pauseBefore)return i-=1,void setTimeout((function(){r(!0)}),1);try{o.getData((function(e){n.addPreprocessedComponent(o.key,e),r(!1)}),e)}catch(e){n.addPreprocessedComponent(o.key,String(e)),r(!1)}}}};r(!1)},V.getPromise=function(e){return new Promise((function(t,n){V.get(e,t)}))},V.getV18=function(e,t){return null==t&&(t=e,e={}),V.get(e,(function(n){for(var i=[],r=0;r<n.length;r++){var a=n[r];if(a.value===(e.NOT_AVAILABLE||"not available"))i.push({key:a.key,value:"unknown"});else if("plugins"===a.key)i.push({key:"plugins",value:d(a.value,(function(e){var t=d(e[2],(function(e){return e.join?e.join("~"):e})).join(",");return[e[0],e[1],t].join("::")}))});else if(-1!==["canvas","webgl"].indexOf(a.key)&&Array.isArray(a.value))i.push({key:a.key,value:a.value.join("~")});else if(-1!==["sessionStorage","localStorage","indexedDb","addBehavior","openDatabase"].indexOf(a.key)){if(!a.value)continue;i.push({key:a.key,value:1})}else a.value?i.push(a.value.join?{key:a.key,value:a.value.join(";")}:a):i.push({key:a.key,value:a.value})}var s=o(d(i,(function(e){return e.value})).join("~~~"),31);t(s,i)}))},V.x64hash128=o,V.VERSION="2.1.4",V},e.exports?e.exports=n():t.exports?t.exports=n():t.Fingerprint2=n()})),ii=o((function(e){!function(t){function n(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,i,r,a,o){return n((s=n(n(t,e),n(r,o)))<<(c=a)|s>>>32-c,i);var s,c}function r(e,t,n,r,a,o,s){return i(t&n|~t&r,e,t,a,o,s)}function a(e,t,n,r,a,o,s){return i(t&r|n&~r,e,t,a,o,s)}function o(e,t,n,r,a,o,s){return i(t^n^r,e,t,a,o,s)}function s(e,t,n,r,a,o,s){return i(n^(t|~r),e,t,a,o,s)}function c(e,t){var i,c,d,l,u;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,p=-271733879,f=-1732584194,m=271733878;for(i=0;i<e.length;i+=16)c=h,d=p,l=f,u=m,h=r(h,p,f,m,e[i],7,-680876936),m=r(m,h,p,f,e[i+1],12,-389564586),f=r(f,m,h,p,e[i+2],17,606105819),p=r(p,f,m,h,e[i+3],22,-1044525330),h=r(h,p,f,m,e[i+4],7,-176418897),m=r(m,h,p,f,e[i+5],12,1200080426),f=r(f,m,h,p,e[i+6],17,-1473231341),p=r(p,f,m,h,e[i+7],22,-45705983),h=r(h,p,f,m,e[i+8],7,1770035416),m=r(m,h,p,f,e[i+9],12,-1958414417),f=r(f,m,h,p,e[i+10],17,-42063),p=r(p,f,m,h,e[i+11],22,-1990404162),h=r(h,p,f,m,e[i+12],7,1804603682),m=r(m,h,p,f,e[i+13],12,-40341101),f=r(f,m,h,p,e[i+14],17,-1502002290),h=a(h,p=r(p,f,m,h,e[i+15],22,1236535329),f,m,e[i+1],5,-165796510),m=a(m,h,p,f,e[i+6],9,-1069501632),f=a(f,m,h,p,e[i+11],14,643717713),p=a(p,f,m,h,e[i],20,-373897302),h=a(h,p,f,m,e[i+5],5,-701558691),m=a(m,h,p,f,e[i+10],9,38016083),f=a(f,m,h,p,e[i+15],14,-660478335),p=a(p,f,m,h,e[i+4],20,-405537848),h=a(h,p,f,m,e[i+9],5,568446438),m=a(m,h,p,f,e[i+14],9,-1019803690),f=a(f,m,h,p,e[i+3],14,-187363961),p=a(p,f,m,h,e[i+8],20,1163531501),h=a(h,p,f,m,e[i+13],5,-1444681467),m=a(m,h,p,f,e[i+2],9,-51403784),f=a(f,m,h,p,e[i+7],14,1735328473),h=o(h,p=a(p,f,m,h,e[i+12],20,-1926607734),f,m,e[i+5],4,-378558),m=o(m,h,p,f,e[i+8],11,-2022574463),f=o(f,m,h,p,e[i+11],16,1839030562),p=o(p,f,m,h,e[i+14],23,-35309556),h=o(h,p,f,m,e[i+1],4,-1530992060),m=o(m,h,p,f,e[i+4],11,1272893353),f=o(f,m,h,p,e[i+7],16,-155497632),p=o(p,f,m,h,e[i+10],23,-1094730640),h=o(h,p,f,m,e[i+13],4,681279174),m=o(m,h,p,f,e[i],11,-358537222),f=o(f,m,h,p,e[i+3],16,-722521979),p=o(p,f,m,h,e[i+6],23,76029189),h=o(h,p,f,m,e[i+9],4,-640364487),m=o(m,h,p,f,e[i+12],11,-421815835),f=o(f,m,h,p,e[i+15],16,530742520),h=s(h,p=o(p,f,m,h,e[i+2],23,-995338651),f,m,e[i],6,-198630844),m=s(m,h,p,f,e[i+7],10,1126891415),f=s(f,m,h,p,e[i+14],15,-1416354905),p=s(p,f,m,h,e[i+5],21,-57434055),h=s(h,p,f,m,e[i+12],6,1700485571),m=s(m,h,p,f,e[i+3],10,-1894986606),f=s(f,m,h,p,e[i+10],15,-1051523),p=s(p,f,m,h,e[i+1],21,-2054922799),h=s(h,p,f,m,e[i+8],6,1873313359),m=s(m,h,p,f,e[i+15],10,-30611744),f=s(f,m,h,p,e[i+6],15,-1560198380),p=s(p,f,m,h,e[i+13],21,1309151649),h=s(h,p,f,m,e[i+4],6,-145523070),m=s(m,h,p,f,e[i+11],10,-1120210379),f=s(f,m,h,p,e[i+2],15,718787259),p=s(p,f,m,h,e[i+9],21,-343485551),h=n(h,c),p=n(p,d),f=n(f,l),m=n(m,u);return[h,p,f,m]}function d(e){var t,n="",i=32*e.length;for(t=0;t<i;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function l(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function u(e){var t,n,i="0123456789abcdef",r="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),r+=i.charAt(t>>>4&15)+i.charAt(15&t);return r}function h(e){return unescape(encodeURIComponent(e))}function p(e){return function(e){return d(c(l(e),8*e.length))}(h(e))}function f(e,t){return function(e,t){var n,i,r=l(e),a=[],o=[];for(a[15]=o[15]=void 0,r.length>16&&(r=c(r,8*e.length)),n=0;n<16;n+=1)a[n]=909522486^r[n],o[n]=1549556828^r[n];return i=c(a.concat(l(t)),512+8*t.length),d(c(o.concat(i),640))}(h(e),h(t))}function m(e,t,n){return t?n?f(t,e):u(f(t,e)):n?p(e):u(p(e))}e.exports?e.exports=m:t.md5=m}(a)}));class ri extends s{constructor(e="TaskQueue"){super(),this.name=e,this._closed=!1,this._busy=!1,this._queue=[]}close(){this._closed=!0}push(e,t){return new Promise(((n,i)=>{this._queue.push({method:e,data:t,resolve:n,reject:i}),this._handlePendingCommands()}))}_handlePendingCommands(){if(this._busy)return;const e=this._queue,t=e[0];t&&(this._busy=!0,this._handleCommand(t).then((()=>{this._busy=!1,e.shift(),this._handlePendingCommands()})))}_handleCommand(e){if(this._closed)return e.reject(new lt(`${this.name} taskQueue closed`)),Promise.resolve();const t={promise:null};return this.emit("exec",e,t),Promise.resolve().then((()=>t.promise)).then((t=>{this._closed?e.reject(new lt(`${this.name} taskQueue closed`)):e.resolve(t)})).catch((t=>{e.reject(t)}))}}
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function ai(e){let t=e.length;for(;--t>=0;)e[t]=0}const oi=256,si=286,ci=30,di=15,li=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ui=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),hi=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),pi=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),fi=new Array(576);ai(fi);const mi=new Array(60);ai(mi);const vi=new Array(512);ai(vi);const gi=new Array(256);ai(gi);const yi=new Array(29);ai(yi);const wi=new Array(ci);function bi(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}let _i,Si,Ti;function ki(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}ai(wi);const Ci=e=>e<256?vi[e]:vi[256+(e>>>7)],Ei=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Ri=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Ei(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Pi=(e,t,n)=>{Ri(e,n[2*t],n[2*t+1])},xi=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Ai=(e,t,n)=>{const i=new Array(16);let r,a,o=0;for(r=1;r<=di;r++)o=o+n[r-1]<<1,i[r]=o;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=xi(i[t]++,t))}},Ii=e=>{let t;for(t=0;t<si;t++)e.dyn_ltree[2*t]=0;for(t=0;t<ci;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Di=e=>{e.bi_valid>8?Ei(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Li=(e,t,n,i)=>{const r=2*t,a=2*n;return e[r]<e[a]||e[r]===e[a]&&i[t]<=i[n]},Oi=(e,t,n)=>{const i=e.heap[n];let r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&Li(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Li(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},Mi=(e,t,n)=>{let i,r,a,o,s=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+s++],i+=(255&e.pending_buf[e.sym_buf+s++])<<8,r=e.pending_buf[e.sym_buf+s++],0===i?Pi(e,r,t):(a=gi[r],Pi(e,a+oi+1,t),o=li[a],0!==o&&(r-=yi[a],Ri(e,r,o)),i--,a=Ci(i),Pi(e,a,n),o=ui[a],0!==o&&(i-=wi[a],Ri(e,i,o)))}while(s<e.sym_next);Pi(e,256,t)},Bi=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,a=t.stat_desc.elems;let o,s,c,d=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<a;o++)0!==n[2*o]?(e.heap[++e.heap_len]=d=o,e.depth[o]=0):n[2*o+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=d<2?++d:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,r&&(e.static_len-=i[2*c+1]);for(t.max_code=d,o=e.heap_len>>1;o>=1;o--)Oi(e,n,o);c=a;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Oi(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=s,n[2*c]=n[2*o]+n[2*s],e.depth[c]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1,n[2*o+1]=n[2*s+1]=c,e.heap[1]=c++,Oi(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,c=t.stat_desc.max_length;let d,l,u,h,p,f,m=0;for(h=0;h<=di;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,d=e.heap_max+1;d<573;d++)l=e.heap[d],h=n[2*n[2*l+1]+1]+1,h>c&&(h=c,m++),n[2*l+1]=h,l>i||(e.bl_count[h]++,p=0,l>=s&&(p=o[l-s]),f=n[2*l],e.opt_len+=f*(h+p),a&&(e.static_len+=f*(r[2*l+1]+p)));if(0!==m){do{for(h=c-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,m-=2}while(m>0);for(h=c;0!==h;h--)for(l=e.bl_count[h];0!==l;)u=e.heap[--d],u>i||(n[2*u+1]!==h&&(e.opt_len+=(h-n[2*u+1])*n[2*u],n[2*u+1]=h),l--)}})(e,t),Ai(n,d,e.bl_count)},Ni=(e,t,n)=>{let i,r,a=-1,o=t[1],s=0,c=7,d=4;for(0===o&&(c=138,d=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++s<c&&r===o||(s<d?e.bl_tree[2*r]+=s:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,a=r,0===o?(c=138,d=3):r===o?(c=6,d=3):(c=7,d=4))},Fi=(e,t,n)=>{let i,r,a=-1,o=t[1],s=0,c=7,d=4;for(0===o&&(c=138,d=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++s<c&&r===o)){if(s<d)do{Pi(e,r,e.bl_tree)}while(0!=--s);else 0!==r?(r!==a&&(Pi(e,r,e.bl_tree),s--),Pi(e,16,e.bl_tree),Ri(e,s-3,2)):s<=10?(Pi(e,17,e.bl_tree),Ri(e,s-3,3)):(Pi(e,18,e.bl_tree),Ri(e,s-11,7));s=0,a=r,0===o?(c=138,d=3):r===o?(c=6,d=3):(c=7,d=4)}};let ji=!1;const zi=(e,t,n,i)=>{Ri(e,0+(i?1:0),3),Di(e),Ei(e,n),Ei(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var Gi=(e,t,n,i)=>{let r,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<oi;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Bi(e,e.l_desc),Bi(e,e.d_desc),o=(e=>{let t;for(Ni(e,e.dyn_ltree,e.l_desc.max_code),Ni(e,e.dyn_dtree,e.d_desc.max_code),Bi(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*pi[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),r=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=r&&(r=a)):r=a=n+5,n+4<=r&&-1!==t?zi(e,t,n,i):4===e.strategy||a===r?(Ri(e,2+(i?1:0),3),Mi(e,fi,mi)):(Ri(e,4+(i?1:0),3),((e,t,n,i)=>{let r;for(Ri(e,t-257,5),Ri(e,n-1,5),Ri(e,i-4,4),r=0;r<i;r++)Ri(e,e.bl_tree[2*pi[r]+1],3);Fi(e,e.dyn_ltree,t-1),Fi(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Mi(e,e.dyn_ltree,e.dyn_dtree)),Ii(e),i&&Di(e)},Vi={_tr_init:e=>{ji||((()=>{let e,t,n,i,r;const a=new Array(16);for(n=0,i=0;i<28;i++)for(yi[i]=n,e=0;e<1<<li[i];e++)gi[n++]=i;for(gi[n-1]=i,r=0,i=0;i<16;i++)for(wi[i]=r,e=0;e<1<<ui[i];e++)vi[r++]=i;for(r>>=7;i<ci;i++)for(wi[i]=r<<7,e=0;e<1<<ui[i]-7;e++)vi[256+r++]=i;for(t=0;t<=di;t++)a[t]=0;for(e=0;e<=143;)fi[2*e+1]=8,e++,a[8]++;for(;e<=255;)fi[2*e+1]=9,e++,a[9]++;for(;e<=279;)fi[2*e+1]=7,e++,a[7]++;for(;e<=287;)fi[2*e+1]=8,e++,a[8]++;for(Ai(fi,287,a),e=0;e<ci;e++)mi[2*e+1]=5,mi[2*e]=xi(e,5);_i=new bi(fi,li,257,si,di),Si=new bi(mi,ui,0,ci,di),Ti=new bi(new Array(0),hi,0,19,7)})(),ji=!0),e.l_desc=new ki(e.dyn_ltree,_i),e.d_desc=new ki(e.dyn_dtree,Si),e.bl_desc=new ki(e.bl_tree,Ti),e.bi_buf=0,e.bi_valid=0,Ii(e)},_tr_stored_block:zi,_tr_flush_block:Gi,_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(gi[n]+oi+1)]++,e.dyn_dtree[2*Ci(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{Ri(e,2,3),Pi(e,256,fi),(e=>{16===e.bi_valid?(Ei(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var Ui=(e,t,n,i)=>{let r=65535&e,a=e>>>16&65535,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{r=r+t[i++]|0,a=a+r|0}while(--o);r%=65521,a%=65521}return r|a<<16};const Wi=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var Zi=(e,t,n,i)=>{const r=Wi,a=i+n;e^=-1;for(let n=i;n<a;n++)e=e>>>8^r[255&(e^t[n])];return~e},Hi={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Xi={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ji,_tr_stored_block:Yi,_tr_flush_block:$i,_tr_tally:Ki,_tr_align:qi}=Vi,{Z_NO_FLUSH:Qi,Z_PARTIAL_FLUSH:er,Z_FULL_FLUSH:tr,Z_FINISH:nr,Z_BLOCK:ir,Z_OK:rr,Z_STREAM_END:ar,Z_STREAM_ERROR:or,Z_DATA_ERROR:sr,Z_BUF_ERROR:cr,Z_DEFAULT_COMPRESSION:dr,Z_FILTERED:lr,Z_HUFFMAN_ONLY:ur,Z_RLE:hr,Z_FIXED:pr,Z_DEFAULT_STRATEGY:fr,Z_UNKNOWN:mr,Z_DEFLATED:vr}=Xi,gr=258,yr=262,wr=42,br=113,_r=666,Sr=(e,t)=>(e.msg=Hi[t],t),Tr=e=>2*e-(e>4?9:0),kr=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Cr=e=>{let t,n,i,r=e.w_size;t=e.hash_size,i=t;do{n=e.head[--i],e.head[i]=n>=r?n-r:0}while(--t);t=r,i=t;do{n=e.prev[--i],e.prev[i]=n>=r?n-r:0}while(--t)};let Er=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Rr=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Pr=(e,t)=>{$i(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Rr(e.strm)},xr=(e,t)=>{e.pending_buf[e.pending++]=t},Ar=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Ir=(e,t,n,i)=>{let r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),n),1===e.state.wrap?e.adler=Ui(e.adler,t,r,n):2===e.state.wrap&&(e.adler=Zi(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)},Dr=(e,t)=>{let n,i,r=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match;const c=e.strstart>e.w_size-yr?e.strstart-(e.w_size-yr):0,d=e.window,l=e.w_mask,u=e.prev,h=e.strstart+gr;let p=d[a+o-1],f=d[a+o];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,d[n+o]===f&&d[n+o-1]===p&&d[n]===d[a]&&d[++n]===d[a+1]){a+=2,n++;do{}while(d[++a]===d[++n]&&d[++a]===d[++n]&&d[++a]===d[++n]&&d[++a]===d[++n]&&d[++a]===d[++n]&&d[++a]===d[++n]&&d[++a]===d[++n]&&d[++a]===d[++n]&&a<h);if(i=gr-(h-a),a=h-gr,i>o){if(e.match_start=t,o=i,i>=s)break;p=d[a+o-1],f=d[a+o]}}}while((t=u[t&l])>c&&0!=--r);return o<=e.lookahead?o:e.lookahead},Lr=e=>{const t=e.w_size;let n,i,r;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-yr)&&(e.window.set(e.window.subarray(t,t+t-i),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Cr(e),i+=t),0===e.strm.avail_in)break;if(n=Ir(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=n,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=Er(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=Er(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<yr&&0!==e.strm.avail_in)},Or=(e,t)=>{let n,i,r,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,s=e.strm.avail_in;do{if(n=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r)break;if(r=e.strm.avail_out-r,i=e.strstart-e.block_start,n>i+e.strm.avail_in&&(n=i+e.strm.avail_in),n>r&&(n=r),n<a&&(0===n&&t!==nr||t===Qi||n!==i+e.strm.avail_in))break;o=t===nr&&n===i+e.strm.avail_in?1:0,Yi(e,0,0,o),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Rr(e.strm),i&&(i>n&&(i=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,n-=i),n&&(Ir(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===o);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?4:t!==Qi&&t!==nr&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(Ir(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,a=r>e.w_size?e.w_size:r,i=e.strstart-e.block_start,(i>=a||(i||t===nr)&&t!==Qi&&0===e.strm.avail_in&&i<=r)&&(n=i>r?r:i,o=t===nr&&0===e.strm.avail_in&&n===i?1:0,Yi(e,e.block_start,n,o),e.block_start+=n,Rr(e.strm)),o?3:1)},Mr=(e,t)=>{let n,i;for(;;){if(e.lookahead<yr){if(Lr(e),e.lookahead<yr&&t===Qi)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Er(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-yr&&(e.match_length=Dr(e,n)),e.match_length>=3)if(i=Ki(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Er(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Er(e,e.ins_h,e.window[e.strstart+1]);else i=Ki(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Pr(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===nr?(Pr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Pr(e,!1),0===e.strm.avail_out)?1:2},Br=(e,t)=>{let n,i,r;for(;;){if(e.lookahead<yr){if(Lr(e),e.lookahead<yr&&t===Qi)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Er(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-yr&&(e.match_length=Dr(e,n),e.match_length<=5&&(e.strategy===lr||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=Ki(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=Er(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(Pr(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=Ki(e,0,e.window[e.strstart-1]),i&&Pr(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Ki(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===nr?(Pr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Pr(e,!1),0===e.strm.avail_out)?1:2};function Nr(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}const Fr=[new Nr(0,0,0,0,Or),new Nr(4,4,8,4,Mr),new Nr(4,5,16,8,Mr),new Nr(4,6,32,32,Mr),new Nr(4,4,16,16,Br),new Nr(8,16,32,32,Br),new Nr(8,16,128,128,Br),new Nr(8,32,128,256,Br),new Nr(32,128,258,1024,Br),new Nr(32,258,258,4096,Br)];function jr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=vr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),kr(this.dyn_ltree),kr(this.dyn_dtree),kr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),kr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),kr(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const zr=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==wr&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==br&&t.status!==_r?1:0},Gr=e=>{if(zr(e))return Sr(e,or);e.total_in=e.total_out=0,e.data_type=mr;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?wr:br,e.adler=2===t.wrap?0:1,t.last_flush=-2,Ji(t),rr},Vr=e=>{const t=Gr(e);var n;return t===rr&&((n=e.state).window_size=2*n.w_size,kr(n.head),n.max_lazy_match=Fr[n.level].max_lazy,n.good_match=Fr[n.level].good_length,n.nice_match=Fr[n.level].nice_length,n.max_chain_length=Fr[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Ur=(e,t,n,i,r,a)=>{if(!e)return or;let o=1;if(t===dr&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||n!==vr||i<8||i>15||t<0||t>9||a<0||a>pr||8===i&&1!==o)return Sr(e,or);8===i&&(i=9);const s=new jr;return e.state=s,s.strm=e,s.status=wr,s.wrap=o,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=a,s.method=n,Vr(e)};var Wr={deflateInit:(e,t)=>Ur(e,t,vr,15,8,fr),deflateInit2:Ur,deflateReset:Vr,deflateResetKeep:Gr,deflateSetHeader:(e,t)=>zr(e)||2!==e.state.wrap?or:(e.state.gzhead=t,rr),deflate:(e,t)=>{if(zr(e)||t>ir||t<0)return e?Sr(e,or):or;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===_r&&t!==nr)return Sr(e,0===e.avail_out?cr:or);const i=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Rr(e),0===e.avail_out)return n.last_flush=-1,rr}else if(0===e.avail_in&&Tr(t)<=Tr(i)&&t!==nr)return Sr(e,cr);if(n.status===_r&&0!==e.avail_in)return Sr(e,cr);if(n.status===wr&&0===n.wrap&&(n.status=br),n.status===wr){let t=vr+(n.w_bits-8<<4)<<8,i=-1;if(i=n.strategy>=ur||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=i<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Ar(n,t),0!==n.strstart&&(Ar(n,e.adler>>>16),Ar(n,65535&e.adler)),e.adler=1,n.status=br,Rr(e),0!==n.pending)return n.last_flush=-1,rr}if(57===n.status)if(e.adler=0,xr(n,31),xr(n,139),xr(n,8),n.gzhead)xr(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),xr(n,255&n.gzhead.time),xr(n,n.gzhead.time>>8&255),xr(n,n.gzhead.time>>16&255),xr(n,n.gzhead.time>>24&255),xr(n,9===n.level?2:n.strategy>=ur||n.level<2?4:0),xr(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(xr(n,255&n.gzhead.extra.length),xr(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Zi(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(xr(n,0),xr(n,0),xr(n,0),xr(n,0),xr(n,0),xr(n,9===n.level?2:n.strategy>=ur||n.level<2?4:0),xr(n,3),n.status=br,Rr(e),0!==n.pending)return n.last_flush=-1,rr;if(69===n.status){if(n.gzhead.extra){let t=n.pending,i=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+i>n.pending_buf_size;){let r=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=r,Rr(e),0!==n.pending)return n.last_flush=-1,rr;t=0,i-=r}let r=new Uint8Array(n.gzhead.extra);n.pending_buf.set(r.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending+=i,n.gzhead.hcrc&&n.pending>t&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-i,i)),Rr(e),0!==n.pending)return n.last_flush=-1,rr;i=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,xr(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>i&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-i,i)),Rr(e),0!==n.pending)return n.last_flush=-1,rr;i=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,xr(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>i&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-i,i))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Rr(e),0!==n.pending))return n.last_flush=-1,rr;xr(n,255&e.adler),xr(n,e.adler>>8&255),e.adler=0}if(n.status=br,Rr(e),0!==n.pending)return n.last_flush=-1,rr}if(0!==e.avail_in||0!==n.lookahead||t!==Qi&&n.status!==_r){let i=0===n.level?Or(n,t):n.strategy===ur?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(Lr(e),0===e.lookahead)){if(t===Qi)return 1;break}if(e.match_length=0,n=Ki(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Pr(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===nr?(Pr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Pr(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===hr?((e,t)=>{let n,i,r,a;const o=e.window;for(;;){if(e.lookahead<=gr){if(Lr(e),e.lookahead<=gr&&t===Qi)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=e.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){a=e.strstart+gr;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<a);e.match_length=gr-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Ki(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Ki(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Pr(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===nr?(Pr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Pr(e,!1),0===e.strm.avail_out)?1:2})(n,t):Fr[n.level].func(n,t);if(3!==i&&4!==i||(n.status=_r),1===i||3===i)return 0===e.avail_out&&(n.last_flush=-1),rr;if(2===i&&(t===er?qi(n):t!==ir&&(Yi(n,0,0,!1),t===tr&&(kr(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Rr(e),0===e.avail_out))return n.last_flush=-1,rr}return t!==nr?rr:n.wrap<=0?ar:(2===n.wrap?(xr(n,255&e.adler),xr(n,e.adler>>8&255),xr(n,e.adler>>16&255),xr(n,e.adler>>24&255),xr(n,255&e.total_in),xr(n,e.total_in>>8&255),xr(n,e.total_in>>16&255),xr(n,e.total_in>>24&255)):(Ar(n,e.adler>>>16),Ar(n,65535&e.adler)),Rr(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?rr:ar)},deflateEnd:e=>{if(zr(e))return or;const t=e.state.status;return e.state=null,t===br?Sr(e,sr):rr},deflateSetDictionary:(e,t)=>{let n=t.length;if(zr(e))return or;const i=e.state,r=i.wrap;if(2===r||1===r&&i.status!==wr||i.lookahead)return or;if(1===r&&(e.adler=Ui(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===r&&(kr(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(n-i.w_size,n),0),t=e,n=i.w_size}const a=e.avail_in,o=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Lr(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=Er(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,Lr(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=o,e.input=s,e.avail_in=a,i.wrap=r,rr},deflateInfo:"pako deflate (from Nodeca project)"};const Zr=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Hr=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)Zr(n,t)&&(e[t]=n[t])}}return e},Xr=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,i=0,r=e.length;t<r;t++){let r=e[t];n.set(r,i),i+=r.length}return n};let Jr=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Jr=!1}const Yr=new Uint8Array(256);for(let e=0;e<256;e++)Yr[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Yr[254]=Yr[254]=1;var $r=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,i,r,a,o=e.length,s=0;for(r=0;r<o;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<o&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),a=0,r=0;a<s;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<o&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},Kr=(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let i,r;const a=new Array(2*n);for(r=0,i=0;i<n;){let t=e[i++];if(t<128){a[r++]=t;continue}let o=Yr[t];if(o>4)a[r++]=65533,i+=o-1;else{for(t&=2===o?31:3===o?15:7;o>1&&i<n;)t=t<<6|63&e[i++],o--;o>1?a[r++]=65533:t<65536?a[r++]=t:(t-=65536,a[r++]=55296|t>>10&1023,a[r++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Jr)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n})(a,r)},qr=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Yr[e[n]]>t?n:t};var Qr=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const ea=Object.prototype.toString,{Z_NO_FLUSH:ta,Z_SYNC_FLUSH:na,Z_FULL_FLUSH:ia,Z_FINISH:ra,Z_OK:aa,Z_STREAM_END:oa,Z_DEFAULT_COMPRESSION:sa,Z_DEFAULT_STRATEGY:ca,Z_DEFLATED:da}=Xi;function la(e){this.options=Hr({level:sa,method:da,chunkSize:16384,windowBits:15,memLevel:8,strategy:ca},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qr,this.strm.avail_out=0;let n=Wr.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==aa)throw new Error(Hi[n]);if(t.header&&Wr.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?$r(t.dictionary):"[object ArrayBuffer]"===ea.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=Wr.deflateSetDictionary(this.strm,e),n!==aa)throw new Error(Hi[n]);this._dict_set=!0}}function ua(e,t){const n=new la(t);if(n.push(e,!0),n.err)throw n.msg||Hi[n.err];return n.result}la.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let r,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?ra:ta,"string"==typeof e?n.input=$r(e):"[object ArrayBuffer]"===ea.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(a===na||a===ia)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(r=Wr.deflate(n,a),r===oa)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=Wr.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===aa;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},la.prototype.onData=function(e){this.chunks.push(e)},la.prototype.onEnd=function(e){e===aa&&(this.result=Xr(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ha={Deflate:la,deflate:ua,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ua(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ua(e,t)},constants:Xi};const pa=16209;var fa=function(e,t){let n,i,r,a,o,s,c,d,l,u,h,p,f,m,v,g,y,w,b,_,S,T,k,C;const E=e.state;n=e.next_in,k=e.input,i=n+(e.avail_in-5),r=e.next_out,C=e.output,a=r-(t-e.avail_out),o=r+(e.avail_out-257),s=E.dmax,c=E.wsize,d=E.whave,l=E.wnext,u=E.window,h=E.hold,p=E.bits,f=E.lencode,m=E.distcode,v=(1<<E.lenbits)-1,g=(1<<E.distbits)-1;e:do{p<15&&(h+=k[n++]<<p,p+=8,h+=k[n++]<<p,p+=8),y=f[h&v];t:for(;;){if(w=y>>>24,h>>>=w,p-=w,w=y>>>16&255,0===w)C[r++]=65535&y;else{if(!(16&w)){if(64&w){if(32&w){E.mode=16191;break e}e.msg="invalid literal/length code",E.mode=pa;break e}y=f[(65535&y)+(h&(1<<w)-1)];continue t}for(b=65535&y,w&=15,w&&(p<w&&(h+=k[n++]<<p,p+=8),b+=h&(1<<w)-1,h>>>=w,p-=w),p<15&&(h+=k[n++]<<p,p+=8,h+=k[n++]<<p,p+=8),y=m[h&g];;){if(w=y>>>24,h>>>=w,p-=w,w=y>>>16&255,16&w){if(_=65535&y,w&=15,p<w&&(h+=k[n++]<<p,p+=8,p<w&&(h+=k[n++]<<p,p+=8)),_+=h&(1<<w)-1,_>s){e.msg="invalid distance too far back",E.mode=pa;break e}if(h>>>=w,p-=w,w=r-a,_>w){if(w=_-w,w>d&&E.sane){e.msg="invalid distance too far back",E.mode=pa;break e}if(S=0,T=u,0===l){if(S+=c-w,w<b){b-=w;do{C[r++]=u[S++]}while(--w);S=r-_,T=C}}else if(l<w){if(S+=c+l-w,w-=l,w<b){b-=w;do{C[r++]=u[S++]}while(--w);if(S=0,l<b){w=l,b-=w;do{C[r++]=u[S++]}while(--w);S=r-_,T=C}}}else if(S+=l-w,w<b){b-=w;do{C[r++]=u[S++]}while(--w);S=r-_,T=C}for(;b>2;)C[r++]=T[S++],C[r++]=T[S++],C[r++]=T[S++],b-=3;b&&(C[r++]=T[S++],b>1&&(C[r++]=T[S++]))}else{S=r-_;do{C[r++]=C[S++],C[r++]=C[S++],C[r++]=C[S++],b-=3}while(b>2);b&&(C[r++]=C[S++],b>1&&(C[r++]=C[S++]))}break}if(64&w){e.msg="invalid distance code",E.mode=pa;break e}y=m[(65535&y)+(h&(1<<w)-1)]}}break}}while(n<i&&r<o);b=p>>3,n-=b,p-=b<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=r,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=r<o?o-r+257:257-(r-o),E.hold=h,E.bits=p};const ma=15,va=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ga=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ya=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),wa=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ba=(e,t,n,i,r,a,o,s)=>{const c=s.bits;let d,l,u,h,p,f,m=0,v=0,g=0,y=0,w=0,b=0,_=0,S=0,T=0,k=0,C=null;const E=new Uint16Array(16),R=new Uint16Array(16);let P,x,A,I=null;for(m=0;m<=ma;m++)E[m]=0;for(v=0;v<i;v++)E[t[n+v]]++;for(w=c,y=ma;y>=1&&0===E[y];y--);if(w>y&&(w=y),0===y)return r[a++]=20971520,r[a++]=20971520,s.bits=1,0;for(g=1;g<y&&0===E[g];g++);for(w<g&&(w=g),S=1,m=1;m<=ma;m++)if(S<<=1,S-=E[m],S<0)return-1;if(S>0&&(0===e||1!==y))return-1;for(R[1]=0,m=1;m<ma;m++)R[m+1]=R[m]+E[m];for(v=0;v<i;v++)0!==t[n+v]&&(o[R[t[n+v]]++]=v);if(0===e?(C=I=o,f=20):1===e?(C=va,I=ga,f=257):(C=ya,I=wa,f=0),k=0,v=0,m=g,p=a,b=w,_=0,u=-1,T=1<<w,h=T-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){P=m-_,o[v]+1<f?(x=0,A=o[v]):o[v]>=f?(x=I[o[v]-f],A=C[o[v]-f]):(x=96,A=0),d=1<<m-_,l=1<<b,g=l;do{l-=d,r[p+(k>>_)+l]=P<<24|x<<16|A}while(0!==l);for(d=1<<m-1;k&d;)d>>=1;if(0!==d?(k&=d-1,k+=d):k=0,v++,0==--E[m]){if(m===y)break;m=t[n+o[v]]}if(m>w&&(k&h)!==u){for(0===_&&(_=w),p+=g,b=m-_,S=1<<b;b+_<y&&(S-=E[b+_],!(S<=0));)b++,S<<=1;if(T+=1<<b,1===e&&T>852||2===e&&T>592)return 1;u=k&h,r[u]=w<<24|b<<16|p-a}}return 0!==k&&(r[p+k]=m-_<<24|64<<16),s.bits=w,0};const{Z_FINISH:_a,Z_BLOCK:Sa,Z_TREES:Ta,Z_OK:ka,Z_STREAM_END:Ca,Z_NEED_DICT:Ea,Z_STREAM_ERROR:Ra,Z_DATA_ERROR:Pa,Z_MEM_ERROR:xa,Z_BUF_ERROR:Aa,Z_DEFLATED:Ia}=Xi,Da=16180,La=16190,Oa=16191,Ma=16192,Ba=16194,Na=16199,Fa=16200,ja=16206,za=16209,Ga=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Va(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ua=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Da||t.mode>16211?1:0},Wa=e=>{if(Ua(e))return Ra;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Da,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,ka},Za=e=>{if(Ua(e))return Ra;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Wa(e)},Ha=(e,t)=>{let n;if(Ua(e))return Ra;const i=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Ra:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,Za(e))},Xa=(e,t)=>{if(!e)return Ra;const n=new Va;e.state=n,n.strm=e,n.window=null,n.mode=Da;const i=Ha(e,t);return i!==ka&&(e.state=null),i};let Ja,Ya,$a=!0;const Ka=e=>{if($a){Ja=new Int32Array(512),Ya=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ba(1,e.lens,0,288,Ja,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ba(2,e.lens,0,32,Ya,0,e.work,{bits:5}),$a=!1}e.lencode=Ja,e.lenbits=9,e.distcode=Ya,e.distbits=5},qa=(e,t,n,i)=>{let r;const a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),i>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>i&&(r=i),a.window.set(t.subarray(n-i,n-i+r),a.wnext),(i-=r)?(a.window.set(t.subarray(n-i,n),0),a.wnext=i,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0};var Qa={inflateReset:Za,inflateReset2:Ha,inflateResetKeep:Wa,inflateInit:e=>Xa(e,15),inflateInit2:Xa,inflate:(e,t)=>{let n,i,r,a,o,s,c,d,l,u,h,p,f,m,v,g,y,w,b,_,S,T,k=0;const C=new Uint8Array(4);let E,R;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ua(e)||!e.output||!e.input&&0!==e.avail_in)return Ra;n=e.state,n.mode===Oa&&(n.mode=Ma),o=e.next_out,r=e.output,c=e.avail_out,a=e.next_in,i=e.input,s=e.avail_in,d=n.hold,l=n.bits,u=s,h=c,T=ka;e:for(;;)switch(n.mode){case Da:if(0===n.wrap){n.mode=Ma;break}for(;l<16;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(2&n.wrap&&35615===d){0===n.wbits&&(n.wbits=15),n.check=0,C[0]=255&d,C[1]=d>>>8&255,n.check=Zi(n.check,C,2,0),d=0,l=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=za;break}if((15&d)!==Ia){e.msg="unknown compression method",n.mode=za;break}if(d>>>=4,l-=4,S=8+(15&d),0===n.wbits&&(n.wbits=S),S>15||S>n.wbits){e.msg="invalid window size",n.mode=za;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&d?16189:Oa,d=0,l=0;break;case 16181:for(;l<16;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(n.flags=d,(255&n.flags)!==Ia){e.msg="unknown compression method",n.mode=za;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=za;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&4&n.wrap&&(C[0]=255&d,C[1]=d>>>8&255,n.check=Zi(n.check,C,2,0)),d=0,l=0,n.mode=16182;case 16182:for(;l<32;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}n.head&&(n.head.time=d),512&n.flags&&4&n.wrap&&(C[0]=255&d,C[1]=d>>>8&255,C[2]=d>>>16&255,C[3]=d>>>24&255,n.check=Zi(n.check,C,4,0)),d=0,l=0,n.mode=16183;case 16183:for(;l<16;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&4&n.wrap&&(C[0]=255&d,C[1]=d>>>8&255,n.check=Zi(n.check,C,2,0)),d=0,l=0,n.mode=16184;case 16184:if(1024&n.flags){for(;l<16;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&4&n.wrap&&(C[0]=255&d,C[1]=d>>>8&255,n.check=Zi(n.check,C,2,0)),d=0,l=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(p=n.length,p>s&&(p=s),p&&(n.head&&(S=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(a,a+p),S)),512&n.flags&&4&n.wrap&&(n.check=Zi(n.check,i,p,a)),s-=p,a+=p,n.length-=p),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===s)break e;p=0;do{S=i[a+p++],n.head&&S&&n.length<65536&&(n.head.name+=String.fromCharCode(S))}while(S&&p<s);if(512&n.flags&&4&n.wrap&&(n.check=Zi(n.check,i,p,a)),s-=p,a+=p,S)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===s)break e;p=0;do{S=i[a+p++],n.head&&S&&n.length<65536&&(n.head.comment+=String.fromCharCode(S))}while(S&&p<s);if(512&n.flags&&4&n.wrap&&(n.check=Zi(n.check,i,p,a)),s-=p,a+=p,S)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;l<16;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(4&n.wrap&&d!==(65535&n.check)){e.msg="header crc mismatch",n.mode=za;break}d=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Oa;break;case 16189:for(;l<32;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}e.adler=n.check=Ga(d),d=0,l=0,n.mode=La;case La:if(0===n.havedict)return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=d,n.bits=l,Ea;e.adler=n.check=1,n.mode=Oa;case Oa:if(t===Sa||t===Ta)break e;case Ma:if(n.last){d>>>=7&l,l-=7&l,n.mode=ja;break}for(;l<3;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}switch(n.last=1&d,d>>>=1,l-=1,3&d){case 0:n.mode=16193;break;case 1:if(Ka(n),n.mode=Na,t===Ta){d>>>=2,l-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=za}d>>>=2,l-=2;break;case 16193:for(d>>>=7&l,l-=7&l;l<32;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=za;break}if(n.length=65535&d,d=0,l=0,n.mode=Ba,t===Ta)break e;case Ba:n.mode=16195;case 16195:if(p=n.length,p){if(p>s&&(p=s),p>c&&(p=c),0===p)break e;r.set(i.subarray(a,a+p),o),s-=p,a+=p,c-=p,o+=p,n.length-=p;break}n.mode=Oa;break;case 16196:for(;l<14;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(n.nlen=257+(31&d),d>>>=5,l-=5,n.ndist=1+(31&d),d>>>=5,l-=5,n.ncode=4+(15&d),d>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=za;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;l<3;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}n.lens[P[n.have++]]=7&d,d>>>=3,l-=3}for(;n.have<19;)n.lens[P[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,E={bits:n.lenbits},T=ba(0,n.lens,0,19,n.lencode,0,n.work,E),n.lenbits=E.bits,T){e.msg="invalid code lengths set",n.mode=za;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;k=n.lencode[d&(1<<n.lenbits)-1],v=k>>>24,g=k>>>16&255,y=65535&k,!(v<=l);){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(y<16)d>>>=v,l-=v,n.lens[n.have++]=y;else{if(16===y){for(R=v+2;l<R;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(d>>>=v,l-=v,0===n.have){e.msg="invalid bit length repeat",n.mode=za;break}S=n.lens[n.have-1],p=3+(3&d),d>>>=2,l-=2}else if(17===y){for(R=v+3;l<R;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}d>>>=v,l-=v,S=0,p=3+(7&d),d>>>=3,l-=3}else{for(R=v+7;l<R;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}d>>>=v,l-=v,S=0,p=11+(127&d),d>>>=7,l-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=za;break}for(;p--;)n.lens[n.have++]=S}}if(n.mode===za)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=za;break}if(n.lenbits=9,E={bits:n.lenbits},T=ba(1,n.lens,0,n.nlen,n.lencode,0,n.work,E),n.lenbits=E.bits,T){e.msg="invalid literal/lengths set",n.mode=za;break}if(n.distbits=6,n.distcode=n.distdyn,E={bits:n.distbits},T=ba(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,E),n.distbits=E.bits,T){e.msg="invalid distances set",n.mode=za;break}if(n.mode=Na,t===Ta)break e;case Na:n.mode=Fa;case Fa:if(s>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=d,n.bits=l,fa(e,h),o=e.next_out,r=e.output,c=e.avail_out,a=e.next_in,i=e.input,s=e.avail_in,d=n.hold,l=n.bits,n.mode===Oa&&(n.back=-1);break}for(n.back=0;k=n.lencode[d&(1<<n.lenbits)-1],v=k>>>24,g=k>>>16&255,y=65535&k,!(v<=l);){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(g&&!(240&g)){for(w=v,b=g,_=y;k=n.lencode[_+((d&(1<<w+b)-1)>>w)],v=k>>>24,g=k>>>16&255,y=65535&k,!(w+v<=l);){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}d>>>=w,l-=w,n.back+=w}if(d>>>=v,l-=v,n.back+=v,n.length=y,0===g){n.mode=16205;break}if(32&g){n.back=-1,n.mode=Oa;break}if(64&g){e.msg="invalid literal/length code",n.mode=za;break}n.extra=15&g,n.mode=16201;case 16201:if(n.extra){for(R=n.extra;l<R;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;k=n.distcode[d&(1<<n.distbits)-1],v=k>>>24,g=k>>>16&255,y=65535&k,!(v<=l);){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(!(240&g)){for(w=v,b=g,_=y;k=n.distcode[_+((d&(1<<w+b)-1)>>w)],v=k>>>24,g=k>>>16&255,y=65535&k,!(w+v<=l);){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}d>>>=w,l-=w,n.back+=w}if(d>>>=v,l-=v,n.back+=v,64&g){e.msg="invalid distance code",n.mode=za;break}n.offset=y,n.extra=15&g,n.mode=16203;case 16203:if(n.extra){for(R=n.extra;l<R;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=za;break}n.mode=16204;case 16204:if(0===c)break e;if(p=h-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=za;break}p>n.wnext?(p-=n.wnext,f=n.wsize-p):f=n.wnext-p,p>n.length&&(p=n.length),m=n.window}else m=r,f=o-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do{r[o++]=m[f++]}while(--p);0===n.length&&(n.mode=Fa);break;case 16205:if(0===c)break e;r[o++]=n.length,c--,n.mode=Fa;break;case ja:if(n.wrap){for(;l<32;){if(0===s)break e;s--,d|=i[a++]<<l,l+=8}if(h-=c,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?Zi(n.check,r,h,o-h):Ui(n.check,r,h,o-h)),h=c,4&n.wrap&&(n.flags?d:Ga(d))!==n.check){e.msg="incorrect data check",n.mode=za;break}d=0,l=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;l<32;){if(0===s)break e;s--,d+=i[a++]<<l,l+=8}if(4&n.wrap&&d!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=za;break}d=0,l=0}n.mode=16208;case 16208:T=Ca;break e;case za:T=Pa;break e;case 16210:return xa;default:return Ra}return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=d,n.bits=l,(n.wsize||h!==e.avail_out&&n.mode<za&&(n.mode<ja||t!==_a))&&qa(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?Zi(n.check,r,h,e.next_out-h):Ui(n.check,r,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Oa?128:0)+(n.mode===Na||n.mode===Ba?256:0),(0===u&&0===h||t===_a)&&T===ka&&(T=Aa),T},inflateEnd:e=>{if(Ua(e))return Ra;let t=e.state;return t.window&&(t.window=null),e.state=null,ka},inflateGetHeader:(e,t)=>{if(Ua(e))return Ra;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,ka):Ra},inflateSetDictionary:(e,t)=>{const n=t.length;let i,r,a;return Ua(e)?Ra:(i=e.state,0!==i.wrap&&i.mode!==La?Ra:i.mode===La&&(r=1,r=Ui(r,t,n,0),r!==i.check)?Pa:(a=qa(e,t,n,n),a?(i.mode=16210,xa):(i.havedict=1,ka)))},inflateInfo:"pako inflate (from Nodeca project)"};var eo=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const to=Object.prototype.toString,{Z_NO_FLUSH:no,Z_FINISH:io,Z_OK:ro,Z_STREAM_END:ao,Z_NEED_DICT:oo,Z_STREAM_ERROR:so,Z_DATA_ERROR:co,Z_MEM_ERROR:lo}=Xi;function uo(e){this.options=Hr({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qr,this.strm.avail_out=0;let n=Qa.inflateInit2(this.strm,t.windowBits);if(n!==ro)throw new Error(Hi[n]);if(this.header=new eo,Qa.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=$r(t.dictionary):"[object ArrayBuffer]"===to.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Qa.inflateSetDictionary(this.strm,t.dictionary),n!==ro)))throw new Error(Hi[n])}function ho(e,t){const n=new uo(t);if(n.push(e),n.err)throw n.msg||Hi[n.err];return n.result}uo.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let a,o,s;if(this.ended)return!1;for(o=t===~~t?t:!0===t?io:no,"[object ArrayBuffer]"===to.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),a=Qa.inflate(n,o),a===oo&&r&&(a=Qa.inflateSetDictionary(n,r),a===ro?a=Qa.inflate(n,o):a===co&&(a=oo));n.avail_in>0&&a===ao&&n.state.wrap>0&&0!==e[n.next_in];)Qa.inflateReset(n),a=Qa.inflate(n,o);switch(a){case so:case co:case oo:case lo:return this.onEnd(a),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||a===ao))if("string"===this.options.to){let e=qr(n.output,n.next_out),t=n.next_out-e,r=Kr(n.output,e);n.next_out=t,n.avail_out=i-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==ro||0!==s){if(a===ao)return a=Qa.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},uo.prototype.onData=function(e){this.chunks.push(e)},uo.prototype.onEnd=function(e){e===ro&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Xr(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var po={Inflate:uo,inflate:ho,inflateRaw:function(e,t){return(t=t||{}).raw=!0,ho(e,t)},ungzip:ho,constants:Xi};const{Deflate:fo,deflate:mo,deflateRaw:vo,gzip:go}=ha,{Inflate:yo,inflate:wo,inflateRaw:bo,ungzip:_o}=po;var So={Deflate:fo,deflate:mo,deflateRaw:vo,gzip:go,Inflate:yo,inflate:wo,inflateRaw:bo,ungzip:_o,constants:Xi},To="1.2.1";const ko="qnrtcqosevents";const Co=new class{constructor(){this.base={version:To,device_id:"",browser_version:"",url:"",uid:"",type:"sdk-player",session_id:"",jitter_buffer_support:!1,timestamp:Date.now(),request_id:"",userAgent:navigator.userAgent,userIp:""},this.events=[],this.lastSubmitTime=Date.now(),this.submitQueue=new ri("qos_submit"),this.emitterId=""}init(e,t){return n(this,void 0,void 0,(function*(){this.emitterId=e,this.base.uid=t,this.submitQueue.off("exec"),this.initSubmitQueue(),this.submitQueue.push("resume").catch(nt);try{const e=yield new Promise((e=>{e()})).then((()=>new Promise(((e,t)=>{try{ni.get((t=>{const n=t.sort(((e,t)=>e.key.localeCompare(t.key)));e(n)}))}catch(e){t(e)}})))).then((e=>{try{return ii(JSON.stringify(e))}catch(e){return Promise.reject(new Error("Failed to generate device ID"))}}));this.base.device_id=e}catch(e){e instanceof Error&&Ye.error(e.message,this.emitterId),this.base.device_id="unknown"}const n=ei();n&&(this.base.browser_version=`${n.name}${n.version}`)}))}addUrl(e){this.base.url=e}addSessionId(e){this.base.session_id=e}addRequestId(e){this.base.request_id=e}addJitterBufferTarget(e){this.base.jitter_buffer_support=e}addEvent(e,t,n){this.submitQueue.push("add",Object.assign(Object.assign({},t),this.base)).catch(nt)}submit(e=!1){this.submitQueue.push("submit",e).catch(nt)}initSubmitQueue(){this.submitQueue.on("exec",((e,t)=>{switch(e.method){case"submit":return void(t.promise=this._submit(e.data));case"add":return void(t.promise=this._addEvent(e.data));case"resume":return void(t.promise=this._recoverStoredEvents())}}))}_recoverStoredEvents(){return n(this,void 0,void 0,(function*(){const e=localStorage.getItem(ko);localStorage.removeItem(ko),e&&(this.events=JSON.parse(window.atob(decodeURIComponent(e))))}))}_addEvent(e){return n(this,void 0,void 0,(function*(){return this.events.push(Object.assign(Object.assign({},e),{timestamp:Date.now()})),this.submit(),Promise.resolve()}))}loggather(e,t=1){return n(this,void 0,void 0,(function*(){if(!(yield fetch("https://pili-sdk-transport.qnsdk.com/v1/loggather/",{method:"POST",headers:{"Content-Type":"application/json"},body:e})).ok)throw new lt("rtcevent error");this.lastSubmitTime=Date.now()}))}_submit(e=!1){return n(this,void 0,void 0,(function*(){if(!(!!e||this.submitCheck()))return void this.saveEvents();const t=this.encodeQosSubmitData();try{yield this.loggather(t)}catch(e){e instanceof Error&&(Ye.error(e.message,this.emitterId),yield this.loggather(t))}finally{this.events=[],localStorage.removeItem(ko)}}))}saveEvents(){const e=encodeURIComponent(window.btoa(JSON.stringify(this.events)));localStorage.setItem(ko,e)}submitCheck(){return!(!this.base.device_id||!this.base.uid)&&this.events.length>=60}encodeQosSubmitData(){let e="",t=[];for(let n of this.events)n.session_id?(t.forEach(((t,i,r)=>{n.request_id===r[i].request_id&&(r[i].session_id=n.session_id),e+=JSON.stringify(r[i])+"\n"})),t=[],e+=JSON.stringify(n)+"\n"):t.push(n);return e}encodeQosSubmitData2(){let e="";for(let t of this.events)e+=JSON.stringify(t)+"\n";return new Uint8Array(So.gzip(function(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=65536+((1023&i)<<10|1023&e.charCodeAt(n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return new Uint8Array(t)}(e)))}};var Eo,Ro;!function(e){e.Config="Config",e.PlayerStateChanged="PlayerStateChanged",e.Error="Error",e.VideoStatistics="VideoStatistics",e.AudioStatistics="AudioStatistics"}(Eo||(Eo={})),function(e){e.idle="idle",e.init="init",e.ready="ready",e.playing="playing",e.stop="stop",e.error="error"}(Ro||(Ro={}));const Po={[e.PlayerState.STATE_IDLE]:"Idle",[e.PlayerState.STATE_INIT]:"Initialized",[e.PlayerState.STATE_READY]:"Ready",[e.PlayerState.STATE_PLAYING]:"Playing",[e.PlayerState.STATE_STOP]:"Stopped",[e.PlayerState.STATE_ERROR]:"Error"},xo="qn_media_element_reset";function Ao(e,t){e.addEventListener(xo,t,{once:!0})}function Io(e){e.dispatchEvent(new Event(xo))}e.QNRTPlayer=class extends s{constructor(){super(),this.playerEmitterId="",this.uid="";const{emitterId:t,emitter:n}=(()=>{const e=new s,t=ot();return at[t]=e,{emitterId:t,emitter:e}})();this.qnPC=new Wn(t),this.playerEmitterId=t,this.handleEvent(n),this.setState(e.PlayerState.STATE_IDLE),this.getPlayerSupportPm=new Promise(((e,n)=>{Dn().then((n=>{this.playerSupport=n,n.peerConnection||vt("RTC not supported!",t),n.H264||vt("H264 not supported!",t),e()}))}))}static setLogLevel(e){Ye.setLevel(e)}get version(){return g}init(e){this.uid=e.uid?e.uid:`qn_${Math.floor(100*Math.random()).toString()}_${Date.now()}`,Co.init(this.playerEmitterId,this.uid),this.config=Object.assign(Object.assign({},c),e),this.qnPC.setJitterBuffer(this.config.jitterBuffer)}getUID(){return this.uid}getConfig(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");return this.config}setConfig(e){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initilized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");void 0!==e.className&&(this.config.className=e.className,this.mediaElement.className=this.config.className),void 0!==e.controls&&(this.config.controls=e.controls,this.mediaElement.controls=this.config.controls),void 0!==e.width&&(this.config.width=e.width,this.mediaElement.style.width=this.config.width),void 0!==e.height&&(this.config.height=e.height,this.mediaElement.style.height=this.config.height),void 0!==e.objectFit&&(this.config.objectFit=e.objectFit,this.mediaElement.style.objectFit=this.config.objectFit),void 0!==e.playsinline&&(this.config.playsinline=e.playsinline,this.mediaElement.playsInline=this.config.playsinline,this.mediaElement.setAttribute("webkit-playsinline",String(e.playsinline))),void 0!==e.volumn&&(this.config.volumn=e.volumn,this.mediaElement.volume=this.config.volumn);const{muted:t=!1}=e;this.config.muted=t,this.mediaElement.muted=t}play(t,i){var r;return n(this,void 0,void 0,(function*(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(yield this.getPlayerSupportPm,this.playerSupport&&Co.addJitterBufferTarget(this.playerSupport.jitterBufferTarget),Co.addSessionId(""),Co.addRequestId((Date.now()+Math.floor(100*Math.random())).toString()),Co.addUrl(t),this.setState(e.PlayerState.STATE_INIT),Co.addEvent(Eo.Config,{event_name:Eo.Config,width:this.config.width,height:this.config.height,object_fit:this.config.objectFit,volumn:this.config.volumn,audio_only:this.config.audioOnly,muted:this.config.muted,jitter_buffer:null!==(r=this.config.jitterBuffer)&&void 0!==r?r:0}),this.mediaElement)Io(this.mediaElement);else{this.mediaElement=document.createElement("video");let e=0;const t=t=>{0===e||t.timeStamp-e>=450&&this.emit("wait",e,t.timeStamp-e-250),e=t.timeStamp};this.mediaElement.addEventListener("timeupdate",t),Ao(this.mediaElement,(()=>{this.mediaElement&&this.mediaElement.removeEventListener("timeupdate",t)})),this.mediaElement.setAttribute("x5-video-player-type","h5"),this.setConfig(this.config)}this.url=yield Ye.initUpload(t),this.mediaStream=yield this.qnPC.pullStream(this.url,this.config.audioOnly),Co.addSessionId(this.qnPC.getSessionId()),this.setState(e.PlayerState.STATE_READY),this.mediaElement.srcObject=this.mediaStream,this.mediaElement&&this.container&&this.mediaElement.parentElement&&this.mediaElement.parentElement!==this.container&&this.mediaElement.parentElement.removeChild(this.mediaElement),this.container&&this.container===i||(this.container=i,this.container.appendChild(this.mediaElement)),Bn&&function(e=5e3){return n(this,void 0,void 0,(function*(){const t=new Promise((e=>{"WeixinJSBridge"in window?window.WeixinJSBridge.invoke("getNetworkType",{},(()=>{e()}),!1):document.addEventListener("WeixinJSBridgeReady",(()=>{window.WeixinJSBridge.invoke("getNetworkType",{},(()=>{e()}),!1)}),{once:!0})}));return Promise.race([t,tt(e,"WeChatAutoplayReady")]).catch((e=>{console.debug(e.message)}))}))}().then((()=>{this.playerState!=e.PlayerState.STATE_IDLE&&(Ye.debug("Try autoplay in WeChat browser.",this.playerEmitterId),this.resume())}));const a=new Promise((e=>{const t=this.mediaElement,n=()=>{Ye.log("media element loadedmetadata.",this.playerEmitterId),e()};t.addEventListener("loadedmetadata",n),Ao(t,(()=>{t.removeEventListener("loadedmetadata",n)}))}));if(yield Promise.race([tt(v,"loadedmetadata"),a]).catch((()=>{Ye.debug("media element loadedmetadata timeout: 8s.",this.playerEmitterId)})),this.playerState!=e.PlayerState.STATE_IDLE)return this.resume()}))}pause(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");this.mediaElement.pause()}resume(){return new Promise(((t,n)=>{if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");this.isPlaying()&&t();try{const i=this.mediaElement.play();i?i.then((()=>{this.playerState!==e.PlayerState.STATE_STOP&&this.setState(e.PlayerState.STATE_PLAYING),t()})).catch((e=>{if("NotAllowedError"===e.name){const t=`play fail, ${e.name}, ${e.message}`;Ye.error(t,this.playerEmitterId),n(new lt(t))}else t()})):(this.playerState!==e.PlayerState.STATE_STOP&&this.setState(e.PlayerState.STATE_PLAYING),t())}catch(e){const t=e instanceof Error?`play error, ${e.name}, ${e.message}`:String(e);Ye.error(t,this.playerEmitterId),n(new lt(t))}}))}hasAudio(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");return!!this.mediaStream&&this.mediaStream.getAudioTracks().length>0}hasVideo(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");return!!this.mediaStream&&this.mediaStream.getVideoTracks().length>0}setAudioVolume(e){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");this.mediaElement.volume=e}getAudioVolume(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");return this.mediaElement.volume}muteAudio(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");this.mediaElement.muted=!0}unmuteAudio(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");this.mediaElement.muted=!1}muteVideo(){var e;if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");const t=null===(e=this.mediaStream)||void 0===e?void 0:e.getAudioTracks();t&&t.length>0?this.mediaElement.srcObject=new MediaStream(t):this.mediaElement.srcObject=null,this.resume()}unmuteVideo(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");if(!this.mediaStream)throw Ye.error("mediaStream is empty",this.playerEmitterId),new lt("mediaStream is empty");this.mediaElement.srcObject=this.mediaStream,this.resume()}isPlaying(){return!!this.mediaElement&&!this.mediaElement.paused}stop(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");if(!this.mediaElement)throw Ye.error("media is not initialized, try play() first.",this.playerEmitterId),new lt("media is not initialized");this._stop()}release(){if(!this.config)throw Ye.error("config is not initialized, try init() first.",this.playerEmitterId),new lt("config is not initialized");this.setState(e.PlayerState.STATE_IDLE),this.config=void 0,this.mediaElement&&Io(this.mediaElement),this.mediaElement&&this.mediaElement.parentElement&&this.mediaElement.parentElement.removeChild(this.mediaElement),this.qnPC.release(),this.url=void 0,this.mediaElement=void 0,this.container=void 0,this.mediaStream=void 0}getPlayerSupport(){return n(this,void 0,void 0,(function*(){return yield this.getPlayerSupportPm,this.playerSupport}))}getBrowserReport(){return Mn}setState(e){this.playerState!==e&&(this.playerState=e,Ye.log(`player state changed: ${e} ${Po[e]}`,this.playerEmitterId),((e,t)=>{st("playerStateChanged",e,t)})(e,this.playerEmitterId))}handleEvent(t){t.on("log",(e=>{this.emit("log",e)})),t.on("stats",(e=>{let t="";if(e.ip)t=e.ip;else{const e=this.qnPC.getIps();e&&(n=e).every((e=>e===n[0]))&&(t=e[0])}var n;Co.addEvent(Eo.VideoStatistics,{ip:t,trans_protocol:e.protocol,event_name:Eo.VideoStatistics,decoder_name:e.videoDecoderName,rtt:rt(e.rtt),bps:rt(e.videoBitrate),width:rt(e.videoFrameWidth),fps:rt(e.videoFps),height:rt(e.videoFrameHeight),avg_packet_processing_delay:rt(e.videoAvgPacketProcessingDelay),avg_jitter_buffer_delay:rt(e.videoAvgJitterBufferDelay),avg_jitter_buffer_Target_delay:rt(e.videoAvgJitterBufferTargetDelay),packet_lost_rate:rt(e.videoPacketLostRate),nack_count:rt(e.videoNackCount),pli_count:rt(e.videoPliCount),fir_count:rt(e.videoFirCount),frame_decoded:rt(e.videoFrameDecoded),frame_received:rt(e.videoFrameReceived),decode_cost_ms:rt(e.videoDecodeCostMs),key_frames_decoded:rt(e.videoKeyFramesDecoded),dropped_frames:rt(e.videoFrameDecoded),packets_received:rt(e.videoPacketReceived),bytes_received:rt(e.videoBytesReceived),total_freezes_duration:rt(e.videoTotalFreezesDuration),fec_pkts_received:rt(e.videoFecPacketReceived),avg_interframe_delay:rt(e.videoAvgInterframeDelay),estimatedPlayoutTimestamp:rt(e.videoEstimatedPlayoutTimestamp),lastPacketReceivedTimestamp:rt(e.videoLastPacketReceivedTimestamp)}),Co.addEvent(Eo.AudioStatistics,{ip:t,trans_protocol:e.protocol,event_name:Eo.AudioStatistics,decoder_name:e.audioDecoderName,bps:rt(e.audioBitrate),rtt:rt(e.rtt),avg_packet_processing_delay:rt(e.audioAvgPacketProcessingDelay),avg_jitter_buffer_delay:rt(e.audioAvgJitterBufferDelay),avg_jitter_buffer_Target_delay:rt(e.audioAvgJitterBufferTargetDelay),packet_lost_rate:rt(e.audioPacketLostRate),total_samples_received:rt(e.audioTotalSamplesReceived),packets_discarded:rt(e.audioPacketDiscarded),packets_lost:rt(e.audioPacketLost),packets_received:rt(e.audioPacketReceived),bytes_received:rt(e.audioBytesReceived),avg_interframe_delay:rt(e.audioAvgInterframeDelay),fps:rt(e.audioFps),estimatedPlayoutTimestamp:rt(e.audioEstimatedPlayoutTimestamp),lastPacketReceivedTimestamp:rt(e.audioLastPacketReceivedTimestamp)}),this.emit("stats",{audioBitrate:e.audioBitrate,videoBitrate:e.videoBitrate,frameWidth:e.videoFrameWidth,frameHeight:e.videoFrameHeight,frameRate:e.videoFps})})),t.on("error",(t=>{Co.addEvent(Eo.Error,{event_name:Eo.Error,error_code:t.code,error_info:t.errorType,error_detail:t.msg}),this.setState(e.PlayerState.STATE_ERROR),this._stop(),this.emit("error",t)})),t.on("playerStateChanged",(t=>{let n=Ro.init;switch(t){case e.PlayerState.STATE_IDLE:n=Ro.idle;break;case e.PlayerState.STATE_INIT:n=Ro.init;break;case e.PlayerState.STATE_READY:n=Ro.ready;break;case e.PlayerState.STATE_PLAYING:n=Ro.playing;break;case e.PlayerState.STATE_STOP:n=Ro.stop;break;case e.PlayerState.STATE_ERROR:n=Ro.error}Co.addEvent(Eo.PlayerStateChanged,{event_name:Eo.PlayerStateChanged,state:n}),this.emit("playerStateChanged",t)}))}_stop(){this.mediaElement&&Io(this.mediaElement),this.qnPC.release(),this.url=void 0,this.setState(e.PlayerState.STATE_STOP)}},Object.defineProperty(e,"__esModule",{value:!0})}));
